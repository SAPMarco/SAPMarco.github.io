/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/m/Text","sap/m/Title","sap/m/FormattedText","sap/f/Illustration","sap/ui/core/Control","sap/ui/core/Core","sap/ui/core/ResizeHandler","./IllustratedMessageRenderer"],function(t,e,i,s,a,r,l,n,o){"use strict";var u=t.IllustratedMessageSize;var p=t.IllustratedMessageType;var d=r.extend("sap.f.IllustratedMessage",{metadata:{library:"sap.f",properties:{description:{type:"string",group:"Misc",defaultValue:""},enableFormattedText:{type:"boolean",group:"Appearance",defaultValue:false},illustrationSize:{type:"sap.f.IllustratedMessageSize",group:"Appearance",defaultValue:u.Auto},illustrationType:{type:"string",group:"Appearance",defaultValue:p.NoSearchResults},title:{type:"string",group:"Misc",defaultValue:""}},aggregations:{additionalContent:{type:"sap.m.Button",multiple:true},_formattedText:{type:"sap.m.FormattedText",multiple:false,visibility:"hidden"},_illustration:{type:"sap.f.Illustration",visibility:"hidden",multiple:false},_text:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_title:{type:"sap.m.Title",multiple:false,visibility:"hidden"}},dnd:{draggable:false,droppable:true}}});d.PREPENDS={DESCRIPTION:"IllustratedMessage_DESCRIPTION_",TITLE:"IllustratedMessage_TITLE_"};d.BREAK_POINTS={DIALOG:679,SPOT:319,BASE:259};d.MEDIA={BASE:"sapFIllustratedMessage-Base",SPOT:"sapFIllustratedMessage-Spot",DIALOG:"sapFIllustratedMessage-Dialog",SCENE:"sapFIllustratedMessage-Scene"};d.RESIZE_HANDLER_ID={CONTENT:"_sContentResizeHandlerId"};d.prototype.init=function(){this._updateInternalIllustrationSetAndType(this.getIllustrationType())};d.prototype.onBeforeRendering=function(){this._detachResizeHandlers()};d.prototype.onAfterRendering=function(){this._updateDomSize();this._attachResizeHandlers()};d.prototype.exit=function(){this._detachResizeHandlers()};d.prototype.setIllustrationType=function(t){if(this.getIllustrationType()===t){return this}this._updateInternalIllustrationSetAndType(t);return this.setProperty("illustrationType",t)};d.prototype._getDefaultDescription=function(){return this._getResourceBundle().getText(d.PREPENDS.DESCRIPTION+this._sIllustrationType,null,true)};d.prototype._getDescription=function(){return this.getEnableFormattedText()?this._getFormattedText():this._getText()};d.prototype._getFormattedText=function(){var t=this.getDescription(),e=this.getAggregation("_formattedText");if(!e){e=new s;this.setAggregation("_formattedText",e)}if(t){e.setHtmlText(t)}else{e.setHtmlText(this._getDefaultDescription())}return e};d.prototype._getIllustration=function(){var t=this.getAggregation("_illustration");if(!t){t=new a;this.setAggregation("_illustration",t)}return t};d.prototype._getResourceBundle=function(){return l.getLibraryResourceBundle("sap.f")};d.prototype._getText=function(){var t=this.getDescription(),i=this.getAggregation("_text");if(!i){i=new e;this.setAggregation("_text",i)}if(t){i.setText(t)}else{i.setText(this._getDefaultDescription())}return i};d.prototype._getTitle=function(){var t=this.getTitle(),e=this.getAggregation("_title");if(!e){e=new i;this.setAggregation("_title",e)}if(t){e.setText(t)}else{e.setText(this._getResourceBundle().getText(d.PREPENDS.TITLE+this._sIllustrationType,null,true))}return e};d.prototype._updateDomSize=function(){var t=this.getDomRef(),e;if(t){e=this.getIllustrationSize();if(e===u.Auto){this._updateMedia(t.getBoundingClientRect().width)}else{this._updateMediaStyle(d.MEDIA[e.toUpperCase()])}}};d.prototype._updateInternalIllustrationSetAndType=function(t){var e=t.split("-");this._sIllustrationSet=e[0];this._sIllustrationType=e[1]};d.prototype._onResize=function(t){var e=t.size.width;this._updateMedia(e)};d.prototype._updateMedia=function(t){if(!t){return}if(t<=d.BREAK_POINTS.BASE){this._updateMediaStyle(d.MEDIA.BASE)}else if(t<=d.BREAK_POINTS.SPOT){this._updateMediaStyle(d.MEDIA.SPOT)}else if(t<=d.BREAK_POINTS.DIALOG){this._updateMediaStyle(d.MEDIA.DIALOG)}else{this._updateMediaStyle(d.MEDIA.SCENE)}};d.prototype._updateMediaStyle=function(t){Object.keys(d.MEDIA).forEach(function(e){var i=t===d.MEDIA[e],s=e.charAt(0)+e.slice(1).toLowerCase();this.toggleStyleClass(d.MEDIA[e],i);if(i&&t!==d.MEDIA.BASE){this._getIllustration().setSet(this._sIllustrationSet,true).setMedia(s,true).setType(this._sIllustrationType)}},this)};d.prototype._attachResizeHandlers=function(){var t=this.getIllustrationSize();if(this.getDomRef()&&t===u.Auto){this._registerResizeHandler(d.RESIZE_HANDLER_ID.CONTENT,this,this._onResize.bind(this))}};d.prototype._detachResizeHandlers=function(){this._deRegisterResizeHandler(d.RESIZE_HANDLER_ID.CONTENT)};d.prototype._registerResizeHandler=function(t,e,i){if(!this[t]){this[t]=n.register(e,i)}};d.prototype._deRegisterResizeHandler=function(t){if(this[t]){n.deregister(this[t]);this[t]=null}};return d});