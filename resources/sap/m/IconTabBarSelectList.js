/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Control","sap/ui/core/Core","sap/ui/core/delegate/ItemNavigation","./IconTabBarDragAndDropUtil","./IconTabBarSelectListRenderer","sap/ui/thirdparty/jquery"],function(e,t,o,i,r,a,n){"use strict";var s=t.extend("sap.m.IconTabBarSelectList",{metadata:{library:"sap.m",aggregations:{items:{type:"sap.m.IconTabFilter",multiple:true,singularName:"item",dnd:true}},events:{selectionChange:{parameters:{selectedItem:{type:"sap.m.IconTabFilter"}}}}}});s.prototype.init=function(){this._oItemNavigation=new i;this._oItemNavigation.setCycling(false);this.addEventDelegate(this._oItemNavigation);this._oItemNavigation.setPageSize(10);this._oIconTabHeader=null;this._oTabFilter=null};s.prototype.exit=function(){this._oItemNavigation.destroy();this._oItemNavigation=null;this._oIconTabHeader=null;this._oTabFilter=null};s.prototype.onBeforeRendering=function(){if(!this._oIconTabHeader){return}this._setsDragAndConfiguration()};s.prototype.onAfterRendering=function(){this._initItemNavigation()};s.prototype._setsDragAndConfiguration=function(){if(!this._oIconTabHeader.getEnableTabReordering()&&this.getDragDropConfig().length){this.destroyDragDropConfig()}else if(this._oIconTabHeader.getEnableTabReordering()&&!this.getDragDropConfig().length){r.setDragDropAggregations(this,"Vertical")}};s.prototype._initItemNavigation=function(){var e=this.getItems(),t=[],o=this._oIconTabHeader.oSelectedItem,i=-1,r,a;for(a=0;a<e.length;a++){r=e[a];if(r.isA("sap.m.IconTabFilter")){var n=r._getAllSubFiltersDomRefs();t=t.concat(r.getDomRef(),n)}if(o&&this.getSelectedItem()&&this.getSelectedItem()._getRealTab()===o){i=a}}if(o&&t.indexOf(o.getDomRef())!==-1){i=t.indexOf(o.getDomRef())}this._oItemNavigation.setRootDomRef(this.getDomRef()).setItemDomRefs(t).setSelectedIndex(i)};s.prototype.getVisibleItems=function(){return this.getItems().filter(function(e){return e.getVisible()})};s.prototype.setSelectedItem=function(e){this._selectedItem=e};s.prototype.getSelectedItem=function(){return this._selectedItem};s.prototype.ontap=function(e){var t=n(e.target);if(!t.hasClass("sapMITBSelectItem")){t=t.parent(".sapMITBSelectItem")}var i=o.byId(t[0].id);if(!i||this._oIconTabHeader._isUnselectable(i)){return}e.preventDefault();if(i!=this.getSelectedItem()){this.fireSelectionChange({selectedItem:i})}};s.prototype.onsapenter=s.prototype.ontap;s.prototype.onsapspace=s.prototype.ontap;s.prototype.checkIconOnly=function(){var e=this.getVisibleItems();this._bIconOnly=e.every(function(e){return!e.getText()&&!e.getCount()});return this._bIconOnly};s.prototype._handleDragAndDrop=function(e){var t=e.getParameter("dropPosition"),o=e.getParameter("draggedControl"),i=e.getParameter("droppedControl");r.handleDrop(this._oIconTabHeader,t,o._getRealTab(),i._getRealTab(),true);this._oIconTabHeader._setItemsForStrip();this._oIconTabHeader._initItemNavigation();this._oTabFilter._setSelectListItems();this._initItemNavigation();o.$().focus()};s.prototype.ondragrearranging=function(e){if(!this._oIconTabHeader.getEnableTabReordering()){return}var t=e.srcControl,o=e.keyCode;r.moveItem.call(this,t,o);this._initItemNavigation();t.$().focus();this._oIconTabHeader._moveTab(t._getRealTab(),o)};s.prototype.onsaphomemodifiers=s.prototype.ondragrearranging;s.prototype.onsapendmodifiers=s.prototype.ondragrearranging;s.prototype.onsapincreasemodifiers=s.prototype.ondragrearranging;s.prototype.onsapdecreasemodifiers=s.prototype.ondragrearranging;return s});