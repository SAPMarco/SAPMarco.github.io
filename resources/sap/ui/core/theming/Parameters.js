/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/URI","../Element","sap/base/util/UriParameters","sap/base/Log","sap/base/util/extend","sap/ui/core/ThemeCheck","sap/ui/thirdparty/jquery"],function(e,r,a,t,n,i,s){"use strict";var o=window["sap-ui-config"]||{};var u=0;if(o["xx-nosync"]==="warn"||/(?:\?|&)sap-ui-xx-nosync=(?:warn)/.exec(window.location.search)){u=1}if(o["xx-nosync"]===true||o["xx-nosync"]==="true"||/(?:\?|&)sap-ui-xx-nosync=(?:x|X|true)/.exec(window.location.search)){u=2}var f={};var c=null;var l=null;var p=[];var m=/url[\s]*\('?"?([^\'")]*)'?"?\)/;var g=a.fromQuery(window.location.search).get("sap-ui-xx-no-inline-theming-parameters")!=="true";function d(){c=null}function h(r,a){var t=m.exec(r);if(t){var n=new e(t[1]);if(n.is("relative")){var i=n.absoluteTo(a).normalize().toString();r="url('"+i+"')"}}return r}function v(e,r,a){for(var t in r){if(typeof e[t]==="undefined"){e[t]=h(r[t],a)}}return e}function y(e,r){if(typeof e["default"]!=="object"){e={default:e,scopes:{}}}c=c||{};c["default"]=c["default"]||{};c["scopes"]=c["scopes"]||{};v(c["default"],e["default"],r);if(typeof e["scopes"]==="object"){for(var a in e["scopes"]){c["scopes"][a]=c["scopes"][a]||{};v(c["scopes"][a],e["scopes"][a],r)}}}function b(e){s("link[id^=sap-ui-theme-]").each(function(){e(this.getAttribute("id"))})}function x(r){var a=document.getElementById(r);if(!a){t.warning("Could not find stylesheet element with ID",r,"sap.ui.core.theming.Parameters");return}var n=a.href;var o=new e(n).filename("").query("").toString();var f=i.checkStyle(r);if(!f){t.warning("Parameters have been requested but theme is not applied, yet.","sap.ui.core.theming.Parameters")}if(f&&g){var c=s(a);var l=c.css("background-image");var p=/\(["']?data:text\/plain;utf-8,(.*?)['"]?\)$/i.exec(l);if(p&&p.length>=2){var m=p[1];if(m.charAt(0)!=="{"&&m.charAt(m.length-1)!=="}"){try{m=decodeURIComponent(m)}catch(e){t.warning("Could not decode theme parameters URI from "+n)}}try{var d=JSON.parse(m);y(d,o);return}catch(e){t.warning("Could not parse theme parameters from "+n+". Loading library-parameters.json as fallback solution.")}}}var h=n.replace(/\/(?:css_variables|library)([^\/.]*)\.(?:css|less)($|[?#])/,function(e,r,a){return"/library-parameters.json"+(a?a:"")});if(u===2){t.error("[nosync] Loading library-parameters.json ignored",h,"sap.ui.core.theming.Parameters");return}else if(u===1){t.error("[nosync] Loading library-parameters.json with sync XHR",h,"sap.ui.core.theming.Parameters")}s.ajax({url:h,dataType:"json",async:false,success:function(e,r,a){if(Array.isArray(e)){for(var t=0;t<e.length;t++){var n=e[t];y(n,o)}}else{y(e,o)}},error:function(e,r,a){t.error("Could not load theme parameters from: "+h,a)}})}function w(){if(!c){y({},"");l=sap.ui.getCore().getConfiguration().getTheme();b(x)}return c}function N(){p.forEach(x);p=[]}f._addLibraryTheme=function(e){if(c){p.push("sap-ui-theme-"+e)}};function C(e){var r=w();if(e.scopeName){r=r["scopes"][e.scopeName]}else{r=r["default"]}var a=r[e.parameterName];if(typeof a==="undefined"&&typeof e.parameterName==="string"){var t=e.parameterName.indexOf(":");if(t!==-1){e.parameterName=e.parameterName.substr(t+1)}a=r[e.parameterName]}if(e.loadPendingParameters&&typeof a==="undefined"){N();a=C({parameterName:e.parameterName,scopeName:e.scopeName,loadPendingParameters:false})}return a}function P(e,r){for(var a=0;a<r.length;a++){var t=r[a];for(var n=0;n<t.length;n++){var i=t[n];var s=C({parameterName:e,scopeName:i});if(s){return s}}}return C({parameterName:e})}f._getScopes=function(e){if(e&&!c){return}var r=w();var a=Object.keys(r["scopes"]);return a};f.getActiveScopesFor=function(e){var a=[];if(e instanceof r){var t=e.getDomRef();N();var n=this._getScopes();if(t){var i=function(e){var r=t.classList;return r&&r.contains(e)};while(t){var s=n.filter(i);if(s.length>0){a.push(s)}t=t.parentNode}}else{var o=function(r){return typeof e.hasStyleClass==="function"&&e.hasStyleClass(r)};while(e){var s=n.filter(o);if(s.length>0){a.push(s)}e=typeof e.getParent==="function"&&e.getParent()}}}return a};f.get=function(e,a){var n;if(!sap.ui.getCore().isInitialized()){t.warning("Called sap.ui.core.theming.Parameters.get() before core has been initialized. "+"This could lead to bad performance and sync XHR as inline parameters might not be available, yet. "+"Consider using the API only when required, e.g. onBeforeRendering.")}if(arguments.length===0){N();var i=w();return Object.assign({},i["default"])}if(!e){return undefined}if(a instanceof r){N();var s=this.getActiveScopesFor(a);if(typeof e==="string"){return P(e,s)}else if(Array.isArray(e)){var o={};for(var u=0;u<e.length;u++){var c=e[u];o[c]=P(c,s)}return o}}else{if(typeof e==="string"){n=C({parameterName:e,loadPendingParameters:true});return n}else if(Array.isArray(e)){var o={};for(var l=0;l<e.length;l++){var c=e[l];o[c]=f.get(c)}return o}}};f._setOrLoadParameters=function(e){c={default:{},scopes:{}};l=sap.ui.getCore().getConfiguration().getTheme();b(function(r){var a=r.substr(13);if(e[a]){n(c["default"],e[a])}else{x(r)}})};f.reset=function(){var e=arguments[0]===true;if(!e||sap.ui.getCore().getConfiguration().getTheme()!==l){d()}};f._getThemeImage=function(e,r){e=e||"sapUiGlobalLogo";var a=f.get(e);if(a){var t=m.exec(a);if(t){a=t[1]}else if(a==="''"||a==="none"){a=null}}if(!!r&&!a){return sap.ui.resource("sap.ui.core","themes/base/img/1x1.gif")}return a};return f},true);