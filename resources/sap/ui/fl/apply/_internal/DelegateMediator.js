/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/ui/fl/Utils","sap/ui/core/util/reflection/JsControlTreeModifier"],function(e,r,t){"use strict";var i={};i._mDefaultDelegateItems={};function n(e,r){if(!r&&e.getModel){var t=e.getModel();if(!t){return undefined}r=t.getMetadata().getName()}var n=i._mDefaultDelegateItems[r];if(n){return{name:n.name,payload:{},modelType:r,requiredLibraries:n.requiredLibraries}}}function a(t,i,n){if(!n){return Promise.resolve()}return r.requireAsync(n.name).then(function(e){n.instance=e;return n}).catch(function(r){e.error("Failed to load the delegate for the control "+t.getId(i)+"\n"+r.message)})}function o(e,r){return new Promise(function(i,n){if(!e){n(new Error("The control parameter is missing"))}if(!r){n(new Error("The modifier parameter is missing"))}if(!e){n(new Error("The input control should be available"))}if(r===t&&(!e.isA||!e.isA("sap.ui.base.ManagedObject"))){n(new Error("The input control should be a managed object"))}return i()})}i.getKnownDefaultDelegateLibraries=function(){return["sap.ui.comp"]};i.isDelegateRegistered=function(e){return!!i._mDefaultDelegateItems[e]};i.registerDefaultDelegate=function(e){if(!(e.modelType&&e.delegate)){throw new Error("'modelType' and 'delegate' properties are required for registration!")}if(i.isDelegateRegistered(e.modelType)){throw new Error("modelType "+e.modelType+"is already defined!")}i._mDefaultDelegateItems[e.modelType]={name:e.delegate,requiredLibraries:e.requiredLibraries}};i.getDelegateForControl=function(e,r,t,i){return o(e,r).then(function(){return r.getFlexDelegate(e)}).then(function(r){if(r){return r}return i&&n(e,t)}).then(a.bind(this,r,e))};i.clear=function(){i._mDefaultDelegateItems={}};return i},false);