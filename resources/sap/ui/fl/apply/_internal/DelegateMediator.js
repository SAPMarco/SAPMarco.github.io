/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/ui/fl/Utils","sap/ui/core/util/reflection/JsControlTreeModifier"],function(e,t,r){"use strict";var n={};n._mDefaultDelegateItems={};function i(e,t){if(!t&&e.getModel){var r=e.getModel();if(!r){return undefined}t=r.getMetadata().getName()}var i=n._mDefaultDelegateItems[t];if(i){return{name:i,payload:{},modelType:t}}}function a(r,n,i){if(!i){return Promise.resolve()}return t.requireAsync(i.name).then(function(e){i.instance=e;return i}).catch(function(t){e.error("Failed to load the delegate for the control "+r.getId(n)+"\n"+t.message)})}function o(e,t){return new Promise(function(n,i){if(!e){i(new Error("The control parameter is missing"))}if(!t){i(new Error("The modifier parameter is missing"))}if(!e){i(new Error("The input control should be available"))}if(t===r&&(!e.isA||!e.isA("sap.ui.base.ManagedObject"))){i(new Error("The input control should be a managed object"))}return n()})}n.isDelegateRegistered=function(e){return!!n._mDefaultDelegateItems[e]};n.registerDefaultDelegate=function(e){if(!(e.modelType&&e.delegate)){throw new Error("'modelType' and 'delegate' properties are required for registration!")}if(n.isDelegateRegistered(e.modelType)){throw new Error("modelType "+e.modelType+"is already defined!")}n._mDefaultDelegateItems[e.modelType]=e.delegate};n.getDelegateForControl=function(e,t,r,n){return o(e,t).then(function(){return t.getFlexDelegate(e)}).then(function(t){if(t){return t}return n&&i(e,r)}).then(a.bind(this,t,e))};n.clear=function(){n._mDefaultDelegateItems={}};return n},false);