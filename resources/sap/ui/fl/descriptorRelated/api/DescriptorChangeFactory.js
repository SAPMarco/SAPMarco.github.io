/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/Change","sap/ui/fl/Utils","sap/base/util/merge"],function(e,t,n,i){"use strict";var r=function(e,t){this._mChangeFile=e;this._mChangeFile.packageName="";this._oInlineChange=t};r.prototype.submit=function(){this.store();var e=this._getChangePersistence(this._mChangeFile.reference);return e.saveDirtyChanges()};r.prototype.store=function(){var e=this._mChangeFile.reference;var t=this._mChangeFile.validAppVersions.creation;var n=this._getChangePersistence(e,t);var i=this._getChangeToSubmit();n.addChange(i);return i};r.prototype._getChangePersistence=function(t,n){return e.getChangePersistenceForComponent(t,n)};r.prototype._getChangeToSubmit=function(){var e=new t(this._getMap());return e};r.prototype._getMap=function(){var e=this._oInlineChange.getMap();this._mChangeFile.content=e.content;this._mChangeFile.texts=e.texts;return this._mChangeFile};r.prototype.getJson=function(){return i({},this._getMap())};var a=function(){};a.prototype.createNew=function(e,i,a,s,o){var g=function(e,t){if(e["setHostingIdForTextKey"]){e.setHostingIdForTextKey(t)}};g(i,e);var h;if(s){h=s.appVersion;if(!s.appId&&!h){var p=s.getManifest();h=n.getAppVersionFromManifest(p)}}var c={};c.changeType=i._getChangeType();c.componentName=e;c.reference=e;c.validAppVersions=h?{creation:h,from:h}:{};c.generator=o;c.layer=a||"CUSTOMER";var u=t.createInitialFileContent(c);return Promise.resolve(new r(u,i))};return a},true);