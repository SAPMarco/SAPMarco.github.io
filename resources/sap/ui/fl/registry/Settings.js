/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/write/_internal/Storage","sap/ui/fl/Utils","sap/base/util/UriParameters","sap/base/Log"],function(e,t,n,i){"use strict";var r=function(e){if(!e){throw new Error("no flex settings provided")}if(!e.defaultLayerPermissions){e.defaultLayerPermissions={VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:true,USER:false}}if(!e.developerModeLayerPermissions){e.developerModeLayerPermissions={VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:false,USER:false}}if(!(r._IS_VARIANT_SHARING_ENABLED in e)){e.isVariantSharingEnabled=true}this._oSettings=e};r._IS_VARIANT_SHARING_ENABLED="isVariantSharingEnabled";r.attachEvent=function(e,t){r._oEventProvider.attachEvent(e,t)};r.detachEvent=function(e,t){r._oEventProvider.detachEvent(e,t)};r.getInstance=function(){if(r._instance){return Promise.resolve(r._instance)}if(r._oLoadSettingsPromise){return r._oLoadSettingsPromise}return r._loadSettings()};r._loadSettings=function(){var t=e.loadFeatures().then(function(e){if(!e){i.error("The request for flexibility settings failed; A default response is generated and returned to consuming APIs");e={isKeyUser:false,isVariantSharingEnabled:false,isAtoAvailable:false,isAtoEnabled:false,isProductiveSystem:true,versioning:{},_bFlexChangeMode:false,_bFlexibilityAdaptationButtonAllowed:false}}return r._storeInstance(e)});r._oLoadSettingsPromise=t;return t};r._storeInstance=function(e){if(!r._instance){r._instance=new r(e)}return r._instance};r.getInstanceOrUndef=function(){var e;if(r._instance){e=r._instance}return e};r.prototype._getBooleanProperty=function(e){var t=false;if(this._oSettings[e]){t=this._oSettings[e]}return t};r.prototype.isKeyUser=function(){return this._getBooleanProperty("isKeyUser")};r.prototype.isVersioningEnabled=function(e){return!!(this._oSettings.versioning[e]||this._oSettings.versioning["ALL"])};r.prototype.isModelS=function(){return this._getBooleanProperty("isAtoAvailable")};r.prototype.isAtoEnabled=function(){return this._getBooleanProperty("isAtoEnabled")};r.prototype.isAtoAvailable=function(){return this._getBooleanProperty("isAtoAvailable")};r.prototype.isProductiveSystem=function(){return this._getBooleanProperty("isProductiveSystem")};r.prototype.isVariantSharingEnabled=function(){return this._oSettings.isVariantSharingEnabled===true};r.prototype.getSystem=function(){return this._oSettings.system};r.prototype.getClient=function(){return this._oSettings.client};r.prototype.getDefaultLayerPermissions=function(){return this._oSettings.defaultLayerPermissions};r.prototype.getDeveloperModeLayerPermissions=function(){return this._oSettings.developerModeLayerPermissions};return r},true);