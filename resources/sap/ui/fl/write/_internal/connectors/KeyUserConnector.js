/*
 * ! OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/merge","sap/ui/fl/write/_internal/connectors/BackendConnector","sap/ui/fl/initial/_internal/connectors/KeyUserConnector","sap/ui/fl/initial/_internal/connectors/Utils"],function(n,e,t,r){"use strict";var i="/flex/keyuser";var a="/v1";function s(n){n.initialConnector=t;n.xsrfToken=t.xsrfToken;n.tokenUrl=c.ROUTES.TOKEN}function o(n){var e={title:n.title};n.payload=JSON.stringify(e);n.dataType="json";n.contentType="application/json; charset=utf-8"}function u(n){n.version=n.versionNumber;delete n.versionNumber;return n}var c=n({},e,{layers:t.layers,ROUTES:{CHANGES:i+a+"/changes/",SETTINGS:i+a+"/settings",TOKEN:i+a+"/settings",VERSIONS:{GET:i+a+"/versions/",ACTIVATE:i+a+"/versions/activate/",DISCARD:i+a+"/versions/draft/"}},isLanguageInfoRequired:true});c.versions={load:function(n){s(n);var e={};r.addLanguageInfo(e);e.limit=n.limit;var t=r.getUrl(c.ROUTES.VERSIONS.GET,n,e);return r.sendRequest(t,"GET",n).then(function(n){return n.response.map(function(n){return u(n)})})},activate:function(n){s(n);o(n);var e={version:0};r.addLanguageInfo(e);var t=r.getUrl(c.ROUTES.VERSIONS.ACTIVATE,n,e);return r.sendRequest(t,"POST",n).then(function(n){var e=n.response;return u(e)})},discardDraft:function(n){s(n);var e=r.getUrl(c.ROUTES.VERSIONS.DISCARD,n);return r.sendRequest(e,"DELETE",n)}};c.initialConnector=t;return c},true);