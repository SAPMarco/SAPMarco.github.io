/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./AnalyticalContentRenderer","./BaseContent","sap/ui/integration/library","sap/ui/integration/util/BindingResolver","sap/base/Log","sap/ui/core/Core"],function(e,t,i,a,n,r){"use strict";var o=i.CardActionArea;var s,l,u;var p={Top:"top",Bottom:"bottom",Left:"left",Right:"right"};var v={TopLeft:"topLeft",Center:"center"};var c={Left:"left",Center:"center",Right:"right"};var d={Line:"line",StackedColumn:"stacked_column",StackedBar:"stacked_bar",Donut:"donut"};var g=t.extend("sap.ui.integration.cards.AnalyticalContent",{metadata:{library:"sap.ui.integration"},renderer:e});g.prototype.loadDependencies=function(e){return new Promise(function(e,t){r.loadLibrary("sap.viz",{async:true}).then(function(){sap.ui.require(["sap/viz/ui5/controls/VizFrame","sap/viz/ui5/controls/common/feeds/FeedItem","sap/viz/ui5/data/FlattenedDataset"],function(t,i,a){s=t;l=i;u=a;e()},function(e){t(e)})}).catch(function(){t("Analytical content type is not available with this distribution.")})})};g.prototype._getVizPropertiesObject=function(e){var t=e.title,i=e.legend,a=e.plotArea;if(!e){return this}var n={title:{style:{fontWeight:"normal"},layout:{respectPlotPosition:false}},legend:{},legendGroup:{layout:{}},plotArea:{window:{start:"firstDataPoint",end:"lastDataPoint"}},categoryAxis:{title:{}},valueAxis:{title:{}},interaction:{noninteractiveMode:true}};if(t){n.title.text=t.text;n.title.visible=t.visible;n.title.alignment=c[t.alignment]}if(i){n.legend.visible=i.visible;n.legendGroup.layout.position=p[i.position];n.legendGroup.layout.alignment=v[i.alignment]}if(a){if(a.dataLabel){n.plotArea.dataLabel=a.dataLabel}if(a.categoryAxisText){n.categoryAxis.title.visible=a.categoryAxisText.visible}if(a.valueAxisText){n.valueAxis.title.visible=a.valueAxisText.visible}}return n};g.prototype.onDataChanged=function(){this._createChart()};g.prototype._createChart=function(){var e=this.getConfiguration();if(!e.chartType){n.error("ChartType is a mandatory property");return}var t=a.resolveValue(e,this,"/");var i=[];if(e.dimensions){var r=[];for(var p=0;p<e.dimensions.length;p++){var v=e.dimensions[p];var c=t.dimensions[p].label;i.push(c);var g={name:c,value:v.value};r.push(g)}}var f=[];if(e.measures){var h=[];for(var p=0;p<e.measures.length;p++){var m=e.measures[p];var c=t.measures[p].label;f.push(c);var y={name:c,value:m.value};h.push(y)}}var b=new u({measures:h,dimensions:r,data:{path:this.getBindingContext().getPath()}});var A=new s({uiConfig:{applicationSet:"fiori"},height:"100%",width:"100%",vizType:d[e.chartType],dataset:b,legendVisible:e.legend,feeds:[new l({uid:e.measureAxis,type:"Measure",values:f}),new l({uid:e.dimensionAxis,type:"Dimension",values:i})]});var x=this._getVizPropertiesObject(t);A.setVizProperties(x);this._oActions.attach({area:o.Content,actions:e.actions,control:this});this.setAggregation("_content",A)};return g});