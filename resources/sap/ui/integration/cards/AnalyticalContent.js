/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./AnalyticalContentRenderer","./BaseContent","sap/ui/integration/library","sap/ui/integration/util/BindingResolver","sap/base/Log","sap/ui/core/Core","sap/ui/thirdparty/jquery"],function(e,t,i,a,n,r,o){"use strict";var s,l,u;var p={Top:"top",Bottom:"bottom",Left:"left",Right:"right"};var v={TopLeft:"topLeft",Center:"center"};var d={Left:"left",Center:"center",Right:"right"};var c={Line:"line",StackedColumn:"stacked_column",StackedBar:"stacked_bar",Donut:"donut"};var g=i.AreaType;var h=t.extend("sap.ui.integration.cards.AnalyticalContent",{metadata:{library:"sap.ui.integration"},renderer:e});h.prototype.loadDependencies=function(e){return new Promise(function(e,t){r.loadLibrary("sap.viz",{async:true}).then(function(){sap.ui.require(["sap/viz/ui5/controls/VizFrame","sap/viz/ui5/controls/common/feeds/FeedItem","sap/viz/ui5/data/FlattenedDataset"],function(t,i,a){s=t;l=i;u=a;e()},function(e){t(e)})}).catch(function(){t("Analytical content type is not available with this distribution.")})})};h.prototype._getVizPropertiesObject=function(e){var t=e.title,i=e.legend,a=e.plotArea;if(!e){return this}var n={title:{style:{fontWeight:"normal"},layout:{respectPlotPosition:false}},legend:{},legendGroup:{layout:{}},plotArea:{window:{start:"firstDataPoint",end:"lastDataPoint"}},categoryAxis:{title:{}},valueAxis:{title:{}},interaction:{noninteractiveMode:true}};if(t){n.title.text=t.text;n.title.visible=t.visible;n.title.alignment=d[t.alignment]}if(i){n.legend.visible=i.visible;n.legendGroup.layout.position=p[i.position];n.legendGroup.layout.alignment=v[i.alignment]}if(a){if(a.dataLabel){n.plotArea.dataLabel=a.dataLabel}if(a.categoryAxisText){n.categoryAxis.title.visible=a.categoryAxisText.visible}if(a.valueAxisText){n.valueAxis.title.visible=a.valueAxisText.visible}}return n};h.prototype.onDataChanged=function(){this._createChart()};h.prototype._createChart=function(){var e=this.getConfiguration();if(!e.chartType){n.error("ChartType is a mandatory property");return}var t=a.resolveValue(e,this,"/");var i=[];if(e.dimensions){var r=[];for(var o=0;o<e.dimensions.length;o++){var p=e.dimensions[o];var v=t.dimensions[o].label;i.push(v);var d={name:v,value:p.value};r.push(d)}}var h=[];if(e.measures){var f=[];for(var o=0;o<e.measures.length;o++){var y=e.measures[o];var v=t.measures[o].label;h.push(v);var m={name:v,value:y.value};f.push(m)}}var b=new u({measures:f,dimensions:r,data:{path:this.getBindingContext().getPath()}});var A=new s({uiConfig:{applicationSet:"fiori"},height:"100%",width:"100%",vizType:c[e.chartType],dataset:b,legendVisible:e.legend,feeds:[new l({uid:e.measureAxis,type:"Measure",values:h}),new l({uid:e.dimensionAxis,type:"Dimension",values:i})]});var x=this._getVizPropertiesObject(t);A.setVizProperties(x);this._oActions.setAreaType(g.Content);this._oActions.attach(e,this);this.setAggregation("_content",A)};return h});