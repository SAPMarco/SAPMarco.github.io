/*!
* OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["sap/ui/integration/library","sap/ui/integration/cards/BaseContent","sap/m/library","sap/m/HBox","sap/m/VBox","sap/m/Text","sap/m/Title","sap/m/Avatar","sap/m/Link","sap/m/Label","sap/ui/core/ResizeHandler","sap/ui/layout/AlignedFlowLayout","sap/ui/dom/units/Rem","sap/ui/integration/util/BindingHelper"],function(e,t,i,a,s,r,n,o,l,d,p,u,c,f){"use strict";var b=e.AreaType;var h=i.AvatarSize;var m=i.AvatarColor;var v=t.extend("sap.ui.integration.cards.ObjectContent",{metadata:{library:"sap.ui.integration"},renderer:{apiVersion:2}});v.prototype._getRootContainer=function(){if(this._bIsBeingDestroyed){return null}var e=this.getAggregation("_content");if(!e){e=new u;this.setAggregation("_content",e)}this._sResizeListenerId=p.register(e,this.onAlignedFlowLayoutResize.bind(this));e.addEventDelegate({onAfterRendering:function(){this.getContent().forEach(function(e){if(!e.getVisible()){document.getElementById("sap-ui-invisible-"+e.getId()).parentElement.classList.add("sapFCardInvisibleContent")}})}},e);return e};v.prototype.onAlignedFlowLayoutResize=function(e){if(e&&e.size.width===e.oldSize.width&&!e.control){return}var t=e.control,i=t.getMinItemWidth(),a=t.getContent().length,s;if(i.lastIndexOf("rem")!==-1){s=c.toPx(i)}else if(i.lastIndexOf("px")!==-1){s=parseFloat(i)}var r=Math.floor(e.size.width/s);if(r>a){r=a}if(this._iColsOld===r){return}this._iColsOld=r;var n=r-1,o=Math.ceil(a/r);t.getContent().forEach(function(e,t){e.addStyleClass("sapFCardObjectSpaceBetweenGroup");if(n===t&&n<a){e.removeStyleClass("sapFCardObjectSpaceBetweenGroup");n+=r}if(t+1>(o-1)*r){e.addStyleClass("sapFCardObjectGroupLastInColumn")}else{e.removeStyleClass("sapFCardObjectGroupLastInColumn")}})};v.prototype.exit=function(){t.prototype.exit.apply(this,arguments);if(this._sResizeListenerId){p.deregister(this._sResizeListenerId);this._sResizeListenerId=""}};v.prototype.setConfiguration=function(e){t.prototype.setConfiguration.apply(this,arguments);if(!e){return this}if(e.groups){this._addGroups(e)}return this};v.prototype._addGroups=function(e){var t=this._getRootContainer();var i=e.groups||[];i.forEach(function(e){var i=new s({visible:e.visible}).addStyleClass("sapFCardObjectGroup");var p=new n({text:e.title}).addStyleClass("sapFCardObjectItemTitle");i.addItem(p);e.items.forEach(function(e){var t,n=e.label,p=e.value,u,c,b=[];if(n){n=f.formattedProperty(n,function(e){return e&&e[e.length-1]===":"?e:e+=":"});u=new d({text:n,visible:e.visible}).addStyleClass("sapFCardObjectItemLabel")}if(p){switch(e.type){case"link":t=new l({href:e.url||p,text:p,target:e.target||"_blank",visible:f.reuse(e.visible)});break;case"email":if(e.value){b.push(e.value)}if(e.emailSubject){b.push(e.emailSubject)}c=f.formattedProperty(b,function(e,t){if(t){return"mailto:"+e+"?subject="+t}else{return"mailto:"+e}});t=new l({href:c,text:p,visible:f.reuse(e.visible)});break;case"phone":c=f.formattedProperty(p,function(e){return"tel:"+e});t=new l({href:c,text:p,visible:f.reuse(e.visible)});break;default:t=new r({text:p,visible:f.reuse(e.visible)});break}}if(t){t.addStyleClass("sapFCardObjectItemText")}if(e.icon){var v=f.formattedProperty(e.icon.src,function(e){return this._oIconFormatter.formatSrc(e,this._sAppId)}.bind(this));var g=new o({displaySize:e.icon.size||h.XS,src:v,initials:e.icon.text,displayShape:e.icon.shape,tooltip:e.icon.alt,backgroundColor:e.icon.backgroundColor||(e.icon.text?undefined:m.Transparent)}).addStyleClass("sapFCardObjectItemAvatar sapFCardObjectItemLabel sapFCardIcon");var C=new s({items:[u,t]});var y=new a({visible:e.visible,items:[g,C]});i.addItem(y)}else{i.addItem(u);i.addItem(t)}},this);t.addContent(i)},this);this._oActions.setAreaType(b.Content);this._oActions.attach(e,this)};return v});