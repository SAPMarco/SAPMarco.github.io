/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseListContent","./TableContentRenderer","sap/ui/integration/library","sap/m/Table","sap/m/Column","sap/m/ColumnListItem","sap/m/Text","sap/m/Link","sap/m/ProgressIndicator","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/Avatar","sap/ui/core/library","sap/m/library","sap/ui/integration/util/BindingResolver","sap/ui/integration/util/BindingHelper"],function(t,e,i,r,n,a,o,s,l,u,p,c,d,f,h,g){"use strict";var m=f.AvatarSize;var v=f.AvatarColor;var y=d.VerticalAlign;var _=f.ListSeparators;var w=f.ListType;var C=i.AreaType;var b=t.extend("sap.ui.integration.cards.TableContent",{metadata:{library:"sap.ui.integration"},renderer:e});b.prototype.exit=function(){t.prototype.exit.apply(this,arguments);if(this._oItemTemplate){this._oItemTemplate.destroy();this._oItemTemplate=null}};b.prototype._getTable=function(){if(this._bIsBeingDestroyed){return null}var t=this.getAggregation("_content");if(!t){t=new r({id:this.getId()+"-Table",showSeparators:_.None});this.setAggregation("_content",t)}return t};b.prototype.setConfiguration=function(e){t.prototype.setConfiguration.apply(this,arguments);if(!e){return this}if(e.rows&&e.columns){this._setStaticColumns(e.rows,e.columns);return this}if(e.row&&e.row.columns){this._setColumns(e.row)}return this};b.prototype.onDataChanged=function(){this._checkHiddenNavigationItems(this.getConfiguration().row)};b.prototype._setColumns=function(t){var e=[],i=this._getTable(),r=t.columns;r.forEach(function(t){i.addColumn(new n({header:new o({text:t.title}),width:t.width,hAlign:t.hAlign,visible:t.visible}));e.push(this._createCell(t))}.bind(this));this._oItemTemplate=new a({cells:e,vAlign:y.Middle});this._oActions.setAreaType(C.ContentItem);this._oActions.attach(t,this);var s={template:this._oItemTemplate};this._filterHiddenNavigationItems(t,s);this._bindAggregationToControl("items",i,s)};b.prototype._setStaticColumns=function(t,e){var i=this._getTable();e.forEach(function(t){i.addColumn(new n({header:new o({text:t.title}),width:t.width,hAlign:t.hAlign}))});t.forEach(function(t){var e=new a({vAlign:y.Middle});if(t.cells&&Array.isArray(t.cells)){for(var r=0;r<t.cells.length;r++){e.addCell(this._createCell(t.cells[r]))}}if(t.actions&&Array.isArray(t.actions)){var n=t.actions[0];if(n.type===w.Navigation){e.setType(w.Navigation)}if(n.url){e.attachPress(function(){window.open(n.url,n.target||"_blank")})}}i.addItem(e)}.bind(this));this.fireEvent("_actionContentReady")};b.prototype._createCell=function(t){if(t.url){return new s({text:t.value,href:t.url,target:t.target||"_blank"})}if(t.identifier){var e;if(t.identifier.url){e=g.formattedProperty(t.identifier.url,function(t){if(typeof t==="string"){return true}return false})}var i=new u({title:t.value,titleActive:e});if(t.identifier.url){i.attachTitlePress(function(e){var i=e.getSource(),r=i.getBindingContext(),n,a,o;if(r){n=r.getPath()}a=h.resolveValue(t.identifier.url,i,n);o=h.resolveValue(t.identifier.target,i,n);if(a){window.open(a,o||"_blank")}})}return i}if(t.state){return new p({text:t.value,state:t.state})}if(t.value){return new o({text:t.value})}if(t.icon){var r=g.formattedProperty(t.icon.src,function(t){return this._oIconFormatter.formatSrc(t,this._sAppId)}.bind(this));return new c({src:r,displayShape:t.icon.shape,displaySize:t.icon.size||m.XS,tooltip:t.icon.alt,initials:t.icon.text,backgroundColor:t.icon.backgroundColor||(t.icon.text?undefined:v.Transparent)}).addStyleClass("sapFCardIcon")}if(t.progressIndicator){return new l({percentValue:t.progressIndicator.percent,displayValue:t.progressIndicator.text,state:t.progressIndicator.state})}};b.prototype.getInnerList=function(){return this._getTable()};return b});