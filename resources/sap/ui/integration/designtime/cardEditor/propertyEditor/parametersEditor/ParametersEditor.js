/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/designtime/baseEditor/propertyEditor/BasePropertyEditor","sap/ui/integration/designtime/baseEditor/propertyEditor/mapEditor/MapEditor","sap/base/util/includes","sap/base/util/restricted/_merge","sap/base/util/deepEqual"],function(e,t,a,i,r){"use strict";var l=t.extend("sap.ui.integration.designtime.cardEditor.propertyEditor.parametersEditor.ParametersEditor",{metadata:{library:"sap.ui.integration"},renderer:e.getMetadata().getRenderer().render});l.configMetadata=Object.assign({},t.configMetadata,{allowLabelChange:{defaultValue:true,mergeStrategy:"mostRestrictiveWins"}});l.prototype.getBoolenValue=function(e,t,a){if(typeof e==="boolean"){return e}if(typeof t==="boolean"){return t}return a};l.prototype.formatItemConfig=function(e){var a=t.prototype.formatItemConfig.apply(this,arguments);var i=e.key;var r=e.value.type;var l=this.getNestedDesigntimeMetadataValue(i);var n=this.getBoolenValue(e.value.visible,l.visible,true);var o=this.getBoolenValue(e.value.editable,l.editable,true);var s=this.getBoolenValue(e.value.required,l.required,false);var u=this.getBoolenValue(e.value.expanded,l.expanded,true);var p=e.value.manifestpath||l.manifestpath||"";var g=e.value.description||l.description||"";var d=this.getBoolenValue(e.value.translatable,l.translatable,false);var E=this.getBoolenValue(e.value.allowSettings,l.allowSettings,true);var y=this.getBoolenValue(e.value.allowDynamicValues,l.allowDynamicValues,false);var A=e.value.visualization||l.visualization;var v=e.value.values||l.values;var R=e.value.label||l.label;var b=e.value.placeholder||l.placeholder||"";var h=e.value.validations||l.validations;var I=e.value.hint||l.hint||"";var m=e.value.formatter||l.formatter;a[2].visible=!(r==="group"||r==="array");a.push({label:this.getI18nProperty("CARD_EDITOR.LABEL"),path:"label",value:R,placeholder:R?undefined:i,type:"string",enabled:this.getConfig().allowLabelChange,itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.DESCRIPTION"),path:"description",value:g,allowBindings:true,visible:r!=="group",type:"string",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.HINT"),path:"hint",value:I,allowBindings:true,enabled:true,type:"string",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.FORMATTER"),path:"formatter",value:m,allowBindings:true,enabled:true,visible:r==="date"||r==="datetime"||r==="number"||r==="integer",type:"textArea",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.PLACEHOLDER"),path:"placeholder",value:b,allowBindings:true,visible:r==="string",type:"string",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.MANIFESTPATH"),path:"manifestpath",value:p,allowBindings:true,visible:r!=="group",type:"string",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISIBLE"),path:"visible",value:n,allowBindings:true,type:"boolean",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.EDITABLE"),path:"editable",allowBindings:true,value:o,enabled:true,visible:r!=="group",type:"boolean",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.REQUIRED"),path:"required",allowBindings:true,value:s,visible:r==="string"||r==="number"||r==="integer",enabled:true,type:"boolean",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.EXPANDED"),path:"expanded",allowBindings:true,value:u,enabled:true,visible:r==="group",type:"boolean",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.TRANSLATABLE"),path:"translatable",value:d,enabled:true,type:"boolean",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.ALLOWDYNAMICVALUES"),path:"allowDynamicValues",allowBindings:true,enabled:true,value:y,visible:r!=="group",type:"boolean",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.ALLOWSETTINGS"),path:"allowSettings",allowBindings:true,value:E,visible:r!=="group",type:"boolean",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISUALIZATION"),path:"visualization",allowBindings:true,value:A,visible:r!=="group",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISUALIZATION.PLACEHOLDER"),type:"textArea",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALIDATIONS"),path:"validations",allowBindings:true,value:h,visible:r==="string"||r==="number"||r==="integer",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALIDATIONS.PLACEHOLDER"),type:"textArea",itemKey:i},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALUES"),path:"values",allowBindings:true,value:v,visible:r==="string"||r==="array",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALUES.PLACEHOLDER"),type:"textArea",itemKey:i});return a};l.prototype.processInputValue=function(e){return e};l.prototype.processOutputValue=function(e){return e};l.prototype._configItemsFormatter=function(e){return Array.isArray(e)?e.map(function(e){var t=this.getNestedDesigntimeMetadataValue(e.key);var a=i({},e.value,t);if(!a.label){a.label=e.key}a.itemKey=e.key;a.path="value";a.designtime=this.getNestedDesigntimeMetadata(e.key);return a}.bind(this)):[]};l.prototype.getItemChangeHandlers=function(){return Object.assign({},t.prototype.getItemChangeHandlers.apply(this,arguments),{label:this._onDesigntimeChange})};l.prototype.onBeforeConfigChange=function(e){if(!e.allowTypeChange&&!e.allowKeyChange){this.setFragment("sap.ui.integration.designtime.cardEditor.propertyEditor.parametersEditor.ParametersConfigurationEditor",function(){return 1})}return e};l.prototype._isValidItem=function(e,t){var i=t.type;var r=t.value;var l=this._getAllowedTypes();return i&&a(l,i)||typeof r==="string"&&a(l,"string")};return l});