/**
 * MIT License
 *
 * Copyright (c) 2017 Microsoft
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
(function t(e,i){if(typeof exports==="object"&&typeof module==="object")module.exports=i();else if(typeof sap.ui.define==="function")sap.ui.define([],i);else if(typeof exports==="object")exports["AdaptiveCards"]=i();else e["AdaptiveCards"]=i()})(window,function(){return function(t){var e={};function i(n){if(e[n]){return e[n].exports}var r=e[n]={i:n,l:false,exports:{}};t[n].call(r.exports,r,r.exports,i);r.l=true;return r.exports}i.m=t;i.c=e;i.d=function(t,e,n){if(!i.o(t,e)){Object.defineProperty(t,e,{enumerable:true,get:n})}};i.r=function(t){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(t,"__esModule",{value:true})};i.t=function(t,e){if(e&1)t=i(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var n=Object.create(null);i.r(n);Object.defineProperty(n,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n};i.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};i.d(e,"a",e);return e};i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};i.p="";return i(i.s="./src/adaptivecards.ts")}({"./src/adaptivecards.ts":function(t,e,i){"use strict";function n(t){for(var i in t)if(!e.hasOwnProperty(i))e[i]=t[i]}Object.defineProperty(e,"__esModule",{value:true});
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
n(i("./src/card-elements.ts"));n(i("./src/enums.ts"));n(i("./src/host-config.ts"));n(i("./src/shared.ts"));n(i("./src/utils.ts"))},"./src/card-elements.ts":function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:true});
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var r=i("./src/enums.ts");var o=i("./src/shared.ts");var s=i("./src/utils.ts");var a=i("./src/host-config.ts");var l=i("./src/text-formatters.ts");function u(t,e){if(t){t["setCollection"](e)}}function p(t,e){if(e){for(var i=0;i<e.length;i++){if(t.getJsonTypeName()===e[i]){return false}}}return true}var c;(function(t){t[t["UnknownType"]=0]="UnknownType";t[t["ForbiddenType"]=1]="ForbiddenType"})(c||(c={}));function h(t,e,i,n,r,o,a){var l=null;if(e&&typeof e==="object"){var u=false;var p=s.getStringValue(e["type"]);if(i&&i.indexOf(p)>=0){ct(o(p,c.ForbiddenType),a)}else{l=r(p);if(!l){u=n;ct(o(p,c.UnknownType),a)}else{l.setParent(t);l.parse(e,a);u=l.shouldFallback()&&n}if(u){var f=e["fallback"];if(!f){t.setShouldFallback(true)}if(typeof f==="string"&&f.toLowerCase()==="drop"){l=null}else if(typeof f==="object"){l=h(t,f,i,true,r,o,a)}}}}return l}function f(t,e,i,n,o){return h(t,e,i,n,function(t){return yt.actionTypeRegistry.createInstance(t)},function(t,e){if(e==c.UnknownType){return{error:r.ValidationError.UnknownActionType,message:"Unknown action type: "+t+". Fallback will be used if present."}}else{return{error:r.ValidationError.ActionTypeNotAllowed,message:"Action type "+t+" is not allowed in this context."}}},o)}e.createActionInstance=f;function d(t,e,i,n){return h(t,e,[],i,function(t){return yt.elementTypeRegistry.createInstance(t)},function(t,e){if(e==c.UnknownType){return{error:r.ValidationError.UnknownElementType,message:"Unknown element type: "+t+". Fallback will be used if present."}}else{return{error:r.ValidationError.ElementTypeNotAllowed,message:"Element type "+t+" is not allowed in this context."}}},n)}e.createElementInstance=d;var g=function(){function t(){this._rawProperties={}}t.prototype.parse=function(t,e){this._rawProperties=yt.enableFullJsonRoundTrip?t:{}};t.prototype.toJSON=function(){var t;if(yt.enableFullJsonRoundTrip&&this._rawProperties&&typeof this._rawProperties==="object"){t=this._rawProperties}else{t={}}return t};t.prototype.setCustomProperty=function(t,e){var i=typeof e==="string"&&s.isNullOrEmpty(e)||e===undefined||e===null;if(i){delete this._rawProperties[t]}else{this._rawProperties[t]=e}};t.prototype.getCustomProperty=function(t){return this._rawProperties[t]};return t}();e.SerializableObject=g;var y=function(){function t(t){this.cardObject=t;this.errors=[]}return t}();e.ValidationFailure=y;var m=function(){function t(){this.allIds={};this.failures=[]}t.prototype.getFailureIndex=function(t){for(var e=0;e<this.failures.length;e++){if(this.failures[e].cardObject===t){return e}}return-1};t.prototype.addFailure=function(t,e){var i=this.getFailureIndex(t);var n;if(i<0){n=new y(t);this.failures.push(n)}else{n=this.failures[i]}n.errors.push(e)};return t}();e.ValidationResults=m;var v=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.internalValidateProperties=function(t){if(!s.isNullOrEmpty(this.id)){if(t.allIds.hasOwnProperty(this.id)){if(t.allIds[this.id]==1){t.addFailure(this,{error:r.ValidationError.DuplicateId,message:"Duplicate Id: "+this.id})}t.allIds[this.id]+=1}else{t.allIds[this.id]=1}}};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.id=s.getStringValue(e["id"])};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"type",this.getJsonTypeName());s.setProperty(e,"id",this.id);return e};e.prototype.validateProperties=function(){var t=new m;this.internalValidateProperties(t);return t};return e}(g);e.CardObject=v;var b=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._shouldFallback=false;e._lang=undefined;e._hostConfig=null;e._parent=null;e._renderedElement=null;e._separatorElement=null;e._isVisible=true;e._truncatedDueToOverflow=false;e._defaultRenderedElementDisplayMode=null;e._padding=null;e.requires=new a.HostCapabilities;e.horizontalAlignment=null;e.spacing=r.Spacing.Default;e.separator=false;e.customCssSelector=null;e.height="auto";e.minPixelHeight=null;return e}e.prototype.internalRenderSeparator=function(){var t=s.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:null,lineColor:this.separator?this.hostConfig.separator.lineColor:null},this.separatorOrientation);if(yt.alwaysBleedSeparators&&t&&this.separatorOrientation==r.Orientation.Horizontal){var e=this.getParentContainer();if(e&&e.getEffectivePadding()){var i=this.hostConfig.paddingDefinitionToSpacingDefinition(e.getEffectivePadding());t.style.marginLeft="-"+i.left+"px";t.style.marginRight="-"+i.right+"px"}}return t};e.prototype.updateRenderedElementVisibility=function(){var t=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";if(this._renderedElement){this._renderedElement.style.display=t}if(this._separatorElement){if(this.parent&&this.parent.isFirstElement(this)){this._separatorElement.style.display="none"}else{this._separatorElement.style.display=t}}};e.prototype.hideElementDueToOverflow=function(){if(this._renderedElement&&this.isVisible){this._renderedElement.style.visibility="hidden";this.isVisible=false;lt(this,false)}};e.prototype.showElementHiddenDueToOverflow=function(){if(this._renderedElement&&!this.isVisible){this._renderedElement.style.visibility=null;this.isVisible=true;lt(this,false)}};e.prototype.handleOverflow=function(t){if(this.isVisible||this.isHiddenDueToOverflow()){var e=this.truncateOverflow(t);this._truncatedDueToOverflow=e||this._truncatedDueToOverflow;if(!e){this.hideElementDueToOverflow()}else if(e&&!this.isVisible){this.showElementHiddenDueToOverflow()}}};e.prototype.resetOverflow=function(){var t=false;if(this._truncatedDueToOverflow){this.undoOverflowTruncation();this._truncatedDueToOverflow=false;t=true}if(this.isHiddenDueToOverflow){this.showElementHiddenDueToOverflow()}return t};e.prototype.createPlaceholderElement=function(){var t=document.createElement("div");t.style.border="1px dashed #DDDDDD";t.style.padding="4px";t.style.minHeight="32px";t.style.fontSize="10px";t.innerText="Empty "+this.getJsonTypeName();return t};e.prototype.adjustRenderedElementSize=function(t){if(this.height==="auto"){t.style.flex="0 0 auto"}else{t.style.flex="1 1 auto"}if(this.minPixelHeight){t.style.minHeight=this.minPixelHeight+"px"}};e.prototype.overrideInternalRender=function(){return this.internalRender()};e.prototype.applyPadding=function(){if(this.separatorElement){if(yt.alwaysBleedSeparators&&this.separatorOrientation==r.Orientation.Horizontal&&!this.isBleeding()){var t=new o.PaddingDefinition;this.getImmediateSurroundingPadding(t);var e=this.hostConfig.paddingDefinitionToSpacingDefinition(t);this.separatorElement.style.marginLeft="-"+e.left+"px";this.separatorElement.style.marginRight="-"+e.right+"px"}else{this.separatorElement.style.marginRight="0";this.separatorElement.style.marginLeft="0"}}};e.prototype.truncateOverflow=function(t){return false};e.prototype.undoOverflowTruncation=function(){};e.prototype.getDefaultPadding=function(){return new o.PaddingDefinition};e.prototype.getHasBackground=function(){return false};e.prototype.getPadding=function(){return this._padding};e.prototype.setPadding=function(t){this._padding=t};Object.defineProperty(e.prototype,"supportsMinHeight",{get:function(){return false},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"useDefaultSizing",{get:function(){return true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"allowCustomPadding",{get:function(){return true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"separatorOrientation",{get:function(){return r.Orientation.Horizontal},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"defaultStyle",{get:function(){return r.ContainerStyle.Default},enumerable:true,configurable:true});e.prototype.asString=function(){return""};e.prototype.isBleeding=function(){return false};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"isVisible",this.isVisible,true);if(this.horizontalAlignment!==null){s.setEnumProperty(r.HorizontalAlignment,e,"horizontalAlignment",this.horizontalAlignment)}s.setEnumProperty(r.Spacing,e,"spacing",this.spacing,r.Spacing.Default);s.setProperty(e,"separator",this.separator,false);s.setProperty(e,"height",this.height,"auto");if(this.supportsMinHeight){s.setProperty(e,"minHeight",typeof this.minPixelHeight==="number"&&!isNaN(this.minPixelHeight)?this.minPixelHeight+"px":undefined)}return e};e.prototype.setParent=function(t){this._parent=t};e.prototype.getEffectiveStyle=function(){if(this.parent){return this.parent.getEffectiveStyle()}return this.defaultStyle};e.prototype.getForbiddenElementTypes=function(){return null};e.prototype.getForbiddenActionTypes=function(){return null};e.prototype.getImmediateSurroundingPadding=function(t,e,i,n,o){if(e===void 0){e=true}if(i===void 0){i=true}if(n===void 0){n=true}if(o===void 0){o=true}if(this.parent){var s=e&&this.parent.isTopElement(this);var a=i&&this.parent.isRightMostElement(this);var l=n&&this.parent.isBottomElement(this);var u=o&&this.parent.isLeftMostElement(this);var p=this.parent.getEffectivePadding();if(p){if(s&&p.top!=r.Spacing.None){t.top=p.top;s=false}if(a&&p.right!=r.Spacing.None){t.right=p.right;a=false}if(l&&p.bottom!=r.Spacing.None){t.bottom=p.bottom;l=false}if(u&&p.left!=r.Spacing.None){t.left=p.left;u=false}}if(s||a||l||u){this.parent.getImmediateSurroundingPadding(t,s,a,l,u)}}};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);ut(this,e,i);this.requires.parse(e["requires"],i);this.isVisible=s.getBoolValue(e["isVisible"],this.isVisible);this.horizontalAlignment=s.getEnumValue(r.HorizontalAlignment,e["horizontalAlignment"],this.horizontalAlignment);this.spacing=s.getEnumValue(r.Spacing,e["spacing"],r.Spacing.Default);this.separator=s.getBoolValue(e["separator"],this.separator);var n=e["separation"];if(n!==undefined){if(n==="none"){this.spacing=r.Spacing.None;this.separator=false}else if(n==="strong"){this.spacing=r.Spacing.Large;this.separator=true}else if(n==="default"){this.spacing=r.Spacing.Default;this.separator=false}ct({error:r.ValidationError.Deprecated,message:'The "separation" property is deprecated and will be removed. Use the "spacing" and "separator" properties instead.'},i)}var a=e["height"];if(a==="auto"||a==="stretch"){this.height=a}if(this.supportsMinHeight){var l=e["minHeight"];if(l&&typeof l==="string"){var u=false;try{var p=o.SizeAndUnit.parse(l,true);if(p.unit==r.SizeUnit.Pixel){this.minPixelHeight=p.physicalSize;u=true}}catch(t){}if(!u){ct({error:r.ValidationError.InvalidPropertyValue,message:'Invalid "minHeight" value: '+l},i)}}}else{this.minPixelHeight=null}};e.prototype.getActionCount=function(){return 0};e.prototype.getActionAt=function(t){throw new Error("Index out of range.")};e.prototype.remove=function(){if(this.parent&&this.parent instanceof T){return this.parent.removeItem(this)}return false};e.prototype.render=function(){this._renderedElement=this.overrideInternalRender();this._separatorElement=this.internalRenderSeparator();if(this._renderedElement){if(this.customCssSelector){this._renderedElement.classList.add(this.customCssSelector)}this._renderedElement.style.boxSizing="border-box";this._defaultRenderedElementDisplayMode=this._renderedElement.style.display;this.adjustRenderedElementSize(this._renderedElement);this.updateLayout(false)}else if(this.isDesignMode()){this._renderedElement=this.createPlaceholderElement()}return this._renderedElement};e.prototype.updateLayout=function(t){if(t===void 0){t=true}this.updateRenderedElementVisibility();this.applyPadding()};e.prototype.indexOf=function(t){return-1};e.prototype.isDesignMode=function(){var t=this.getRootElement();return t instanceof yt&&t.designMode};e.prototype.isRendered=function(){return this._renderedElement&&this._renderedElement.offsetHeight>0};e.prototype.isFirstElement=function(t){return true};e.prototype.isLastElement=function(t){return true};e.prototype.isAtTheVeryLeft=function(){return this.parent?this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft():true};e.prototype.isAtTheVeryRight=function(){return this.parent?this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight():true};e.prototype.isAtTheVeryTop=function(){return this.parent?this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop():true};e.prototype.isAtTheVeryBottom=function(){return this.parent?this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom():true};e.prototype.isBleedingAtTop=function(){return false};e.prototype.isBleedingAtBottom=function(){return false};e.prototype.isLeftMostElement=function(t){return true};e.prototype.isRightMostElement=function(t){return true};e.prototype.isTopElement=function(t){return this.isFirstElement(t)};e.prototype.isBottomElement=function(t){return this.isLastElement(t)};e.prototype.isHiddenDueToOverflow=function(){return this._renderedElement&&this._renderedElement.style.visibility=="hidden"};e.prototype.getRootElement=function(){var t=this;while(t.parent){t=t.parent}return t};e.prototype.getParentContainer=function(){var t=this.parent;while(t){if(t instanceof tt){return t}t=t.parent}return null};e.prototype.getAllInputs=function(){return[]};e.prototype.getResourceInformation=function(){return[]};e.prototype.getElementById=function(t){return this.id===t?this:null};e.prototype.getActionById=function(t){return null};e.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)};e.prototype.setShouldFallback=function(t){this._shouldFallback=t};e.prototype.getEffectivePadding=function(){var t=this.getPadding();return t&&this.allowCustomPadding?t:this.getDefaultPadding()};Object.defineProperty(e.prototype,"lang",{get:function(){if(this._lang){return this._lang}else{if(this.parent){return this.parent.lang}else{return undefined}}},set:function(t){if(t&&t!=""){var e=/^[a-z]{2,3}$/gi;var i=e.exec(t);if(!i){throw new Error("Invalid language identifier: "+t)}}this._lang=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"hostConfig",{get:function(){if(this._hostConfig){return this._hostConfig}else{if(this.parent){return this.parent.hostConfig}else{return vt}}},set:function(t){this._hostConfig=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"index",{get:function(){if(this.parent){return this.parent.indexOf(this)}else{return 0}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isInteractive",{get:function(){return false},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isStandalone",{get:function(){return true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isInline",{get:function(){return false},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._isVisible},set:function(t){if(yt.useAdvancedCardBottomTruncation&&!t){this.undoOverflowTruncation()}if(this._isVisible!=t){this._isVisible=t;this.updateRenderedElementVisibility();if(this._renderedElement){lt(this)}}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"hasVisibleSeparator",{get:function(){if(this.parent&&this.separatorElement){return!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode())}else{return false}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:true,configurable:true});return e}(v);e.CardElement=b;var C=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._selectAction=null;e.size=r.TextSize.Default;e.weight=r.TextWeight.Default;e.color=r.TextColor.Default;e.isSubtle=false;e.fontType=null;return e}e.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())};e.prototype.getFontSize=function(t){switch(this.size){case r.TextSize.Small:return t.fontSizes.small;case r.TextSize.Medium:return t.fontSizes.medium;case r.TextSize.Large:return t.fontSizes.large;case r.TextSize.ExtraLarge:return t.fontSizes.extraLarge;default:return t.fontSizes.default}};e.prototype.getColorDefinition=function(t,e){switch(e){case r.TextColor.Accent:return t.accent;case r.TextColor.Dark:return t.dark;case r.TextColor.Light:return t.light;case r.TextColor.Good:return t.good;case r.TextColor.Warning:return t.warning;case r.TextColor.Attention:return t.attention;default:return t.default}};e.prototype.setText=function(t){this._text=t};e.prototype.asString=function(){return this.text};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setEnumProperty(r.TextSize,e,"size",this.size,r.TextSize.Default);s.setEnumProperty(r.TextWeight,e,"weight",this.weight,r.TextWeight.Default);s.setEnumProperty(r.TextColor,e,"color",this.color,r.TextColor.Default);s.setProperty(e,"text",this.text);s.setProperty(e,"isSubtle",this.isSubtle,false);s.setEnumProperty(r.FontType,e,"fontType",this.fontType,r.FontType.Default);return e};e.prototype.applyStylesTo=function(t){var e=this.hostConfig.getFontTypeDefinition(this.fontType);if(e.fontFamily){t.style.fontFamily=e.fontFamily}var i;switch(this.size){case r.TextSize.Small:i=e.fontSizes.small;break;case r.TextSize.Medium:i=e.fontSizes.medium;break;case r.TextSize.Large:i=e.fontSizes.large;break;case r.TextSize.ExtraLarge:i=e.fontSizes.extraLarge;break;default:i=e.fontSizes.default;break}t.style.fontSize=i+"px";var n=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);t.style.color=s.stringToCssColor(this.isSubtle?n.subtle:n.default);var o;switch(this.weight){case r.TextWeight.Lighter:o=e.fontWeights.lighter;break;case r.TextWeight.Bolder:o=e.fontWeights.bolder;break;default:o=e.fontWeights.default;break}t.style.fontWeight=o.toString()};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.text=s.getStringValue(e["text"]);var n=s.getStringValue(e["size"]);if(n&&n.toLowerCase()==="normal"){this.size=r.TextSize.Default;ct({error:r.ValidationError.Deprecated,message:'The TextBlock.size value "normal" is deprecated and will be removed. Use "default" instead.'},i)}else{this.size=s.getEnumValue(r.TextSize,n,this.size)}var o=s.getStringValue(e["weight"]);if(o&&o.toLowerCase()==="normal"){this.weight=r.TextWeight.Default;ct({error:r.ValidationError.Deprecated,message:'The TextBlock.weight value "normal" is deprecated and will be removed. Use "default" instead.'},i)}else{this.weight=s.getEnumValue(r.TextWeight,o,this.weight)}this.color=s.getEnumValue(r.TextColor,e["color"],this.color);this.isSubtle=s.getBoolValue(e["isSubtle"],this.isSubtle);this.fontType=s.getEnumValue(r.FontType,e["fontType"],this.fontType)};Object.defineProperty(e.prototype,"effectiveColor",{get:function(){return this.color?this.color:r.TextColor.Default},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){this.setText(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectAction",{get:function(){return this._selectAction},set:function(t){this._selectAction=t;if(this._selectAction){this._selectAction.setParent(this)}},enumerable:true,configurable:true});return e}(b);e.BaseTextBlock=C;var S=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._processedText=null;e._treatAsPlainText=true;e.wrap=false;e.useMarkdown=true;return e}e.prototype.restoreOriginalContent=function(){var t=this.maxLines?this._computedLineHeight*this.maxLines+"px":null;this.renderedElement.style.maxHeight=t;this.renderedElement.innerHTML=this._originalInnerHtml};e.prototype.truncateIfSupported=function(t){var e=this.renderedElement.children;var i=!e.length;var n=i||e.length==1&&e[0].tagName.toLowerCase()=="p";if(n){var r=i?this.renderedElement:e[0];s.truncate(r,t,this._computedLineHeight);return true}return false};e.prototype.setText=function(e){t.prototype.setText.call(this,e);this._processedText=null};e.prototype.getRenderedDomElementType=function(){return"div"};e.prototype.internalRender=function(){var t=this;this._processedText=null;if(!s.isNullOrEmpty(this.text)){var e=this.hostConfig;var i=document.createElement(this.getRenderedDomElementType());i.classList.add(e.makeCssClassName("ac-textBlock"));i.style.overflow="hidden";this.applyStylesTo(i);if(this.selectAction){i.onclick=function(e){e.preventDefault();e.cancelBubble=true;t.selectAction.execute()};if(e.supportsInteractivity){i.tabIndex=0;i.setAttribute("role","button");i.setAttribute("aria-label",this.selectAction.title);i.classList.add(e.makeCssClassName("ac-selectable"))}}if(!this._processedText){this._treatAsPlainText=true;var n=l.formatText(this.lang,this.text);if(this.useMarkdown){if(yt.allowMarkForTextHighlighting){n=n.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==")}var r=yt.applyMarkdown(n);if(r.didProcess&&r.outputHtml){this._processedText=r.outputHtml;this._treatAsPlainText=false;if(yt.allowMarkForTextHighlighting){var o="";var a=this.getEffectiveStyleDefinition();if(a.highlightBackgroundColor){o+="background-color: "+a.highlightBackgroundColor+";"}if(a.highlightForegroundColor){o+="color: "+a.highlightForegroundColor+";"}if(!s.isNullOrEmpty(o)){o='style="'+o+'"'}this._processedText=this._processedText.replace(/===/g,"<mark "+o+">").replace(/\/==/g,"</mark>")}}else{this._processedText=n;this._treatAsPlainText=true}}else{this._processedText=n;this._treatAsPlainText=true}}if(this._treatAsPlainText){i.innerText=this._processedText}else{i.innerHTML=this._processedText}if(i.firstElementChild instanceof HTMLElement){var u=i.firstElementChild;u.style.marginTop="0px";u.style.width="100%";if(!this.wrap){u.style.overflow="hidden";u.style.textOverflow="ellipsis"}}if(i.lastElementChild instanceof HTMLElement){i.lastElementChild.style.marginBottom="0px"}var p=i.getElementsByTagName("a");for(var c=0;c<p.length;c++){var h=p[c];h.classList.add(e.makeCssClassName("ac-anchor"));h.target="_blank";h.onclick=function(e){if(rt(t,e.target)){e.preventDefault();e.cancelBubble=true}}}if(this.wrap){i.style.wordWrap="break-word";if(this.maxLines>0){i.style.maxHeight=this._computedLineHeight*this.maxLines+"px";i.style.overflow="hidden"}}else{i.style.whiteSpace="nowrap";i.style.textOverflow="ellipsis"}if(yt.useAdvancedTextBlockTruncation||yt.useAdvancedCardBottomTruncation){this._originalInnerHtml=i.innerHTML}return i}else{return null}};e.prototype.truncateOverflow=function(t){if(t>=this._computedLineHeight){return this.truncateIfSupported(t)}return false};e.prototype.undoOverflowTruncation=function(){this.restoreOriginalContent();if(yt.useAdvancedTextBlockTruncation&&this.maxLines){var t=this._computedLineHeight*this.maxLines;this.truncateIfSupported(t)}};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"wrap",this.wrap,false);s.setNumberProperty(e,"maxLines",this.maxLines);return e};e.prototype.applyStylesTo=function(e){t.prototype.applyStylesTo.call(this,e);var i=this.getParentContainer();var n=i?i.isRtl():false;switch(this.horizontalAlignment){case r.HorizontalAlignment.Center:e.style.textAlign="center";break;case r.HorizontalAlignment.Right:e.style.textAlign=n?"left":"right";break;default:e.style.textAlign=n?"right":"left";break}var o=this.hostConfig.lineHeights;if(o){switch(this.size){case r.TextSize.Small:this._computedLineHeight=o.small;break;case r.TextSize.Medium:this._computedLineHeight=o.medium;break;case r.TextSize.Large:this._computedLineHeight=o.large;break;case r.TextSize.ExtraLarge:this._computedLineHeight=o.extraLarge;break;default:this._computedLineHeight=o.default;break}}else{this._computedLineHeight=this.getFontSize(this.hostConfig.getFontTypeDefinition(this.fontType))*1.33}e.style.lineHeight=this._computedLineHeight+"px"};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.wrap=s.getBoolValue(e["wrap"],this.wrap);this.maxLines=s.getNumberValue(e["maxLines"])};e.prototype.getJsonTypeName=function(){return"TextBlock"};e.prototype.updateLayout=function(e){if(e===void 0){e=false}t.prototype.updateLayout.call(this,e);if(yt.useAdvancedTextBlockTruncation&&this.maxLines&&this.isRendered()){this.restoreOriginalContent();this.truncateIfSupported(this._computedLineHeight*this.maxLines)}};return e}(C);e.TextBlock=S;var _=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.getRenderedDomElementType=function(){return"label"};e.prototype.internalRender=function(){var e=t.prototype.internalRender.call(this);if(!s.isNullOrEmpty(this.forElementId)){e.htmlFor=this.forElementId}return e};return e}(S);var E=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.italic=false;e.strikethrough=false;e.highlight=false;return e}e.prototype.internalRender=function(){var t=this;if(!s.isNullOrEmpty(this.text)){var e=this.hostConfig;var i=l.formatText(this.lang,this.text);var n=document.createElement("span");n.classList.add(e.makeCssClassName("ac-textRun"));this.applyStylesTo(n);if(this.selectAction&&e.supportsInteractivity){var r=document.createElement("a");r.classList.add(e.makeCssClassName("ac-anchor"));r.href=this.selectAction.getHref();r.target="_blank";r.onclick=function(e){e.preventDefault();e.cancelBubble=true;t.selectAction.execute()};r.innerText=i;n.appendChild(r)}else{n.innerText=i}return n}else{return null}};e.prototype.applyStylesTo=function(e){t.prototype.applyStylesTo.call(this,e);if(this.italic){e.style.fontStyle="italic"}if(this.strikethrough){e.style.textDecoration="line-through"}if(this.highlight){var i=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);e.style.backgroundColor=s.stringToCssColor(this.isSubtle?i.highlightColors.subtle:i.highlightColors.default)}};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"italic",this.italic,false);s.setProperty(e,"strikethrough",this.strikethrough,false);s.setProperty(e,"highlight",this.highlight,false);if(this.selectAction){s.setProperty(e,"selectAction",this.selectAction.toJSON())}return e};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.italic=s.getBoolValue(e["italic"],this.italic);this.strikethrough=s.getBoolValue(e["strikethrough"],this.strikethrough);this.highlight=s.getBoolValue(e["highlight"],this.highlight);this.selectAction=f(this,e["selectAction"],[$.JsonTypeName],!this.isDesignMode(),i)};e.prototype.getJsonTypeName=function(){return"TextRun"};Object.defineProperty(e.prototype,"isStandalone",{get:function(){return false},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isInline",{get:function(){return true},enumerable:true,configurable:true});return e}(C);e.TextRun=E;var x=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._inlines=[];return e}e.prototype.internalAddInline=function(t,e){if(e===void 0){e=false}if(!t.isInline){throw new Error("RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline.")}var i=t.parent==null||e;if(!i&&t.parent!=this){throw new Error("RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock.")}else{t.setParent(this);this._inlines.push(t)}};e.prototype.internalRender=function(){if(this._inlines.length>0){var t=document.createElement("div");t.className=this.hostConfig.makeCssClassName("ac-richTextBlock");var e=this.getParentContainer();var i=e?e.isRtl():false;switch(this.horizontalAlignment){case r.HorizontalAlignment.Center:t.style.textAlign="center";break;case r.HorizontalAlignment.Right:t.style.textAlign=i?"left":"right";break;default:t.style.textAlign=i?"right":"left";break}for(var n=0,o=this._inlines;n<o.length;n++){var s=o[n];t.appendChild(s.render())}return t}else{return null}};e.prototype.asString=function(){var t="";for(var e=0,i=this._inlines;e<i.length;e++){var n=i[e];t+=n.asString()}return t};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this._inlines=[];if(Array.isArray(e["inlines"])){for(var n=0,r=e["inlines"];n<r.length;n++){var o=r[n];var s=void 0;if(typeof o==="string"){var a=new E;a.text=o;s=a}else{s=d(this,o,false,i)}if(s){this.internalAddInline(s,true)}}}};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(this._inlines.length>0){var i=[];for(var n=0,r=this._inlines;n<r.length;n++){var o=r[n];i.push(o.toJSON())}s.setProperty(e,"inlines",i)}return e};e.prototype.getJsonTypeName=function(){return"RichTextBlock"};e.prototype.getInlineCount=function(){return this._inlines.length};e.prototype.getInlineAt=function(t){if(t>=0&&t<this._inlines.length){return this._inlines[t]}else{throw new Error("RichTextBlock.getInlineAt: Index out of range ("+t+")")}};e.prototype.addInline=function(t){this.internalAddInline(t)};e.prototype.removeInline=function(t){var e=this._inlines.indexOf(t);if(e>=0){this._inlines[e].setParent(null);this._inlines.splice(e,1);return true}return false};return e}(b);e.RichTextBlock=x;var A=function(t){n(e,t);function e(e,i){if(e===void 0){e=undefined}if(i===void 0){i=undefined}var n=t.call(this)||this;n.name=e;n.value=i;return n}e.prototype.parse=function(e){t.prototype.parse.call(this,e);this.name=s.getStringValue(e["title"]);this.value=s.getStringValue(e["value"])};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"title",this.name);s.setProperty(e,"value",this.value);return e};return e}(g);e.Fact=A;var w=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.facts=[];return e}Object.defineProperty(e.prototype,"useDefaultSizing",{get:function(){return false},enumerable:true,configurable:true});e.prototype.internalRender=function(){var t=null;var e=this.hostConfig;if(this.facts.length>0){t=document.createElement("table");t.style.borderWidth="0px";t.style.borderSpacing="0px";t.style.borderStyle="none";t.style.borderCollapse="collapse";t.style.display="block";t.style.overflow="hidden";t.classList.add(e.makeCssClassName("ac-factset"));for(var i=0;i<this.facts.length;i++){var n=document.createElement("tr");if(i>0){n.style.marginTop=e.factSet.spacing+"px"}var o=document.createElement("td");o.style.padding="0";o.classList.add(e.makeCssClassName("ac-fact-title"));if(e.factSet.title.maxWidth){o.style.maxWidth=e.factSet.title.maxWidth+"px"}o.style.verticalAlign="top";var a=new S;a.setParent(this);a.text=s.isNullOrEmpty(this.facts[i].name)?"Title":this.facts[i].name;a.size=e.factSet.title.size;a.color=e.factSet.title.color;a.isSubtle=e.factSet.title.isSubtle;a.weight=e.factSet.title.weight;a.wrap=e.factSet.title.wrap;a.spacing=r.Spacing.None;s.appendChild(o,a.render());s.appendChild(n,o);o=document.createElement("td");o.style.width="10px";s.appendChild(n,o);o=document.createElement("td");o.style.padding="0";o.style.verticalAlign="top";o.classList.add(e.makeCssClassName("ac-fact-value"));a=new S;a.setParent(this);a.text=this.facts[i].value;a.size=e.factSet.value.size;a.color=e.factSet.value.color;a.isSubtle=e.factSet.value.isSubtle;a.weight=e.factSet.value.weight;a.wrap=e.factSet.value.wrap;a.spacing=r.Spacing.None;s.appendChild(o,a.render());s.appendChild(n,o);s.appendChild(t,n)}}return t};e.prototype.getJsonTypeName=function(){return"FactSet"};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setArrayProperty(e,"facts",this.facts);return e};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.facts=[];var n=e["facts"];if(Array.isArray(n)){for(var r=0,o=n;r<o.length;r++){var s=o[r];var a=new A;a.parse(s);this.facts.push(a)}}};return e}(b);e.FactSet=w;var I=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.style=r.ImageStyle.Default;e.size=r.Size.Auto;e.pixelWidth=null;e.pixelHeight=null;e.altText="";return e}e.prototype.parseDimension=function(t,e,i){if(e){if(typeof e==="string"){try{var n=o.SizeAndUnit.parse(e);if(n.unit==r.SizeUnit.Pixel){return n.physicalSize}}catch(t){}}ct({error:r.ValidationError.InvalidPropertyValue,message:"Invalid image "+t+": "+e},i)}return 0};e.prototype.applySize=function(t){if(this.pixelWidth||this.pixelHeight){if(this.pixelWidth){t.style.width=this.pixelWidth+"px"}if(this.pixelHeight){t.style.height=this.pixelHeight+"px"}}else{switch(this.size){case r.Size.Stretch:t.style.width="100%";break;case r.Size.Auto:t.style.maxWidth="100%";break;case r.Size.Small:t.style.width=this.hostConfig.imageSizes.small+"px";break;case r.Size.Large:t.style.width=this.hostConfig.imageSizes.large+"px";break;case r.Size.Medium:t.style.width=this.hostConfig.imageSizes.medium+"px";break}}};Object.defineProperty(e.prototype,"useDefaultSizing",{get:function(){return false},enumerable:true,configurable:true});e.prototype.internalRender=function(){var t=this;var e=null;if(!s.isNullOrEmpty(this.url)){e=document.createElement("div");e.style.display="flex";e.style.alignItems="flex-start";e.onkeypress=function(e){if(t.selectAction&&(e.keyCode==13||e.keyCode==32)){e.preventDefault();e.cancelBubble=true;t.selectAction.execute()}};e.onclick=function(e){if(t.selectAction){e.preventDefault();e.cancelBubble=true;t.selectAction.execute()}};switch(this.horizontalAlignment){case r.HorizontalAlignment.Center:e.style.justifyContent="center";break;case r.HorizontalAlignment.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start";break}var i=this.hostConfig;var n=document.createElement("img");n.onload=function(e){nt(t)};n.onerror=function(e){var i=t.getRootElement();t.renderedElement.innerHTML="";if(i&&i.designMode){var n=document.createElement("div");n.style.display="flex";n.style.alignItems="center";n.style.justifyContent="center";n.style.backgroundColor="#EEEEEE";n.style.color="black";n.innerText=":-(";n.style.padding="10px";t.applySize(n);t.renderedElement.appendChild(n)}nt(t)};n.style.maxHeight="100%";n.style.minWidth="0";n.classList.add(i.makeCssClassName("ac-image"));if(this.selectAction!=null&&i.supportsInteractivity){n.tabIndex=0;n.setAttribute("role","button");n.setAttribute("aria-label",this.selectAction.title);n.classList.add(i.makeCssClassName("ac-selectable"))}this.applySize(n);if(this.style===r.ImageStyle.Person){n.style.borderRadius="50%";n.style.backgroundPosition="50% 50%";n.style.backgroundRepeat="no-repeat"}if(!s.isNullOrEmpty(this.backgroundColor)){n.style.backgroundColor=s.stringToCssColor(this.backgroundColor)}n.src=this.url;n.alt=this.altText;e.appendChild(n)}return e};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(this._selectAction){s.setProperty(e,"selectAction",this._selectAction.toJSON())}s.setEnumProperty(r.ImageStyle,e,"style",this.style,r.ImageStyle.Default);s.setProperty(e,"backgroundColor",this.backgroundColor);s.setProperty(e,"url",this.url);s.setEnumProperty(r.Size,e,"size",this.size,r.Size.Auto);if(this.pixelWidth){s.setProperty(e,"width",this.pixelWidth+"px")}if(this.pixelHeight){s.setProperty(e,"height",this.pixelHeight+"px")}s.setProperty(e,"altText",this.altText);return e};e.prototype.getJsonTypeName=function(){return"Image"};e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);if(!i&&this.selectAction){i=this.selectAction.getActionById(e)}return i};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.url=s.getStringValue(e["url"]);this.backgroundColor=s.getStringValue(e["backgroundColor"]);var n=s.getStringValue(e["style"]);if(n&&n.toLowerCase()==="normal"){this.style=r.ImageStyle.Default;ct({error:r.ValidationError.Deprecated,message:'The Image.style value "normal" is deprecated and will be removed. Use "default" instead.'},i)}else{this.style=s.getEnumValue(r.ImageStyle,n,this.style)}this.size=s.getEnumValue(r.Size,e["size"],this.size);this.altText=s.getStringValue(e["altText"]);if(e["pixelWidth"]&&typeof e["pixelWidth"]==="number"){this.pixelWidth=e["pixelWidth"];ct({error:r.ValidationError.Deprecated,message:"The pixelWidth property is deprecated and will be removed. Use the width property instead."},i)}if(e["pixelHeight"]&&typeof e["pixelHeight"]==="number"){this.pixelHeight=e["pixelHeight"];ct({error:r.ValidationError.Deprecated,message:"The pixelHeight property is deprecated and will be removed. Use the height property instead."},i)}var o=this.parseDimension("width",e["width"],i);if(o>0){this.pixelWidth=o}o=this.parseDimension("height",e["height"],i);if(o>0){this.pixelHeight=o}this.selectAction=f(this,e["selectAction"],[$.JsonTypeName],!this.isDesignMode(),i)};e.prototype.getResourceInformation=function(){if(!s.isNullOrEmpty(this.url)){return[{url:this.url,mimeType:"image"}]}else{return[]}};Object.defineProperty(e.prototype,"selectAction",{get:function(){return this._selectAction},set:function(t){this._selectAction=t;if(this._selectAction){this._selectAction.setParent(this)}},enumerable:true,configurable:true});return e}(b);e.Image=I;var T=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._selectAction=null;e.allowVerticalOverflow=false;return e}e.prototype.isElementAllowed=function(t,e){if(!this.hostConfig.supportsInteractivity&&t.isInteractive){return false}if(e){for(var i=0,n=e;i<n.length;i++){var r=n[i];if(t.getJsonTypeName()===r){return false}}}return true};e.prototype.applyPadding=function(){t.prototype.applyPadding.call(this);if(!this.renderedElement){return}var e=new o.SpacingDefinition;if(this.getEffectivePadding()){e=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())}this.renderedElement.style.paddingTop=e.top+"px";this.renderedElement.style.paddingRight=e.right+"px";this.renderedElement.style.paddingBottom=e.bottom+"px";this.renderedElement.style.paddingLeft=e.left+"px";this.renderedElement.style.marginRight="0";this.renderedElement.style.marginLeft="0"};e.prototype.getSelectAction=function(){return this._selectAction};e.prototype.setSelectAction=function(t){this._selectAction=t;if(this._selectAction){this._selectAction.setParent(this)}};Object.defineProperty(e.prototype,"isSelectable",{get:function(){return false},enumerable:true,configurable:true});e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);if(this.isSelectable){this._selectAction=f(this,e["selectAction"],[$.JsonTypeName],!this.isDesignMode(),i)}};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(this._selectAction&&this.isSelectable){s.setProperty(e,"selectAction",this._selectAction.toJSON())}return e};e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);for(var i=0;i<this.getItemCount();i++){var n=this.getItemAt(i);if(!this.hostConfig.supportsInteractivity&&n.isInteractive){e.addFailure(this,{error:r.ValidationError.InteractivityNotAllowed,message:"Interactivity is not allowed."})}if(!this.isElementAllowed(n,this.getForbiddenElementTypes())){e.addFailure(this,{error:r.ValidationError.InteractivityNotAllowed,message:"Elements of type "+n.getJsonTypeName()+" are not allowed in this container."})}n.internalValidateProperties(e)}if(this._selectAction){this._selectAction.internalValidateProperties(e)}};e.prototype.render=function(){var e=this;var i=t.prototype.render.call(this);var n=this.hostConfig;if(this.allowVerticalOverflow){i.style.overflowX="hidden";i.style.overflowY="auto"}if(i&&this.isSelectable&&this._selectAction&&n.supportsInteractivity){i.classList.add(n.makeCssClassName("ac-selectable"));i.tabIndex=0;i.setAttribute("role","button");i.setAttribute("aria-label",this._selectAction.title);i.onclick=function(t){if(e._selectAction!=null){t.preventDefault();t.cancelBubble=true;e._selectAction.execute()}};i.onkeypress=function(t){if(e._selectAction!=null&&(t.keyCode==13||t.keyCode==32)){t.preventDefault();t.cancelBubble=true;e._selectAction.execute()}}}return i};e.prototype.updateLayout=function(e){if(e===void 0){e=true}t.prototype.updateLayout.call(this,e);if(e){for(var i=0;i<this.getItemCount();i++){this.getItemAt(i).updateLayout()}}};e.prototype.getAllInputs=function(){var t=[];for(var e=0;e<this.getItemCount();e++){t=t.concat(this.getItemAt(e).getAllInputs())}return t};e.prototype.getResourceInformation=function(){var t=[];for(var e=0;e<this.getItemCount();e++){t=t.concat(this.getItemAt(e).getResourceInformation())}return t};e.prototype.getElementById=function(e){var i=t.prototype.getElementById.call(this,e);if(!i){for(var n=0;n<this.getItemCount();n++){i=this.getItemAt(n).getElementById(e);if(i){break}}}return i};return e}(b);e.CardElementContainer=T;var P=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._images=[];e.imageSize=r.Size.Medium;return e}e.prototype.internalRender=function(){var t=null;if(this._images.length>0){t=document.createElement("div");t.style.display="flex";t.style.flexWrap="wrap";for(var e=0;e<this._images.length;e++){this._images[e].size=this.imageSize;var i=this._images[e].render();i.style.display="inline-flex";i.style.margin="0px";i.style.marginRight="10px";i.style.maxHeight=this.hostConfig.imageSet.maxImageHeight+"px";s.appendChild(t,i)}}return t};e.prototype.getItemCount=function(){return this._images.length};e.prototype.getItemAt=function(t){return this._images[t]};e.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:null};e.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:null};e.prototype.removeItem=function(t){if(t instanceof I){var e=this._images.indexOf(t);if(e>=0){this._images.splice(e,1);t.setParent(null);this.updateLayout();return true}}return false};e.prototype.getJsonTypeName=function(){return"ImageSet"};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setEnumProperty(r.Size,e,"imageSize",this.imageSize,r.Size.Medium);if(this._images.length>0){var i=[];for(var n=0,o=this._images;n<o.length;n++){var a=o[n];i.push(a.toJSON())}s.setProperty(e,"images",i)}return e};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.imageSize=s.getEnumValue(r.Size,e["imageSize"],r.Size.Medium);if(e["images"]!=null){var n=e["images"];this._images=[];for(var o=0;o<n.length;o++){var a=new I;a.parse(n[o],i);this.addImage(a)}}};e.prototype.addImage=function(t){if(!t.parent){this._images.push(t);t.setParent(this)}else{throw new Error("This image already belongs to another ImageSet")}};e.prototype.indexOf=function(t){return t instanceof I?this._images.indexOf(t):-1};return e}(T);e.ImageSet=P;var O=function(t){n(e,t);function e(e,i){if(e===void 0){e=undefined}if(i===void 0){i=undefined}var n=t.call(this)||this;n.url=e;n.mimeType=i;return n}e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.mimeType=s.getStringValue(e["mimeType"]);this.url=s.getStringValue(e["url"])};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"mimeType",this.mimeType);s.setProperty(e,"url",this.url);return e};return e}(g);e.MediaSource=O;var k=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.sources=[];return e}e.prototype.getPosterUrl=function(){return this.poster?this.poster:this.hostConfig.media.defaultPoster};e.prototype.processSources=function(){this._selectedSources=[];this._selectedMediaType=undefined;for(var t=0,i=this.sources;t<i.length;t++){var n=i[t];var r=n.mimeType?n.mimeType.split("/"):[];if(r.length==2){if(!this._selectedMediaType){var o=e.supportedMediaTypes.indexOf(r[0]);if(o>=0){this._selectedMediaType=e.supportedMediaTypes[o]}}if(r[0]==this._selectedMediaType){this._selectedSources.push(n)}}}};e.prototype.renderPoster=function(){var t=this;var i=12;var n=15;var r=document.createElement("div");r.className=this.hostConfig.makeCssClassName("ac-media-poster");r.setAttribute("role","contentinfo");r.setAttribute("aria-label",this.altText?this.altText:"Media content");r.style.position="relative";r.style.display="flex";var o=this.getPosterUrl();if(o){var s=document.createElement("img");s.style.width="100%";s.style.height="100%";s.onerror=function(t){s.parentNode.removeChild(s);r.classList.add("empty");r.style.minHeight="150px"};s.src=o;r.appendChild(s)}else{r.classList.add("empty");r.style.minHeight="150px"}if(this.hostConfig.supportsInteractivity&&this._selectedSources.length>0){var a=document.createElement("div");a.setAttribute("role","button");a.setAttribute("aria-label","Play media");a.className=this.hostConfig.makeCssClassName("ac-media-playButton");a.style.display="flex";a.style.alignItems="center";a.style.justifyContent="center";a.onclick=function(i){if(t.hostConfig.media.allowInlinePlayback){i.preventDefault();i.cancelBubble=true;var n=t.renderMediaPlayer();t.renderedElement.innerHTML="";t.renderedElement.appendChild(n);n.play()}else{if(e.onPlay){i.preventDefault();i.cancelBubble=true;e.onPlay(t)}}};var l=document.createElement("div");l.className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow");l.style.width=i+"px";l.style.height=n+"px";l.style.borderTopWidth=n/2+"px";l.style.borderBottomWidth=n/2+"px";l.style.borderLeftWidth=i+"px";l.style.borderRightWidth="0";l.style.borderStyle="solid";l.style.borderTopColor="transparent";l.style.borderRightColor="transparent";l.style.borderBottomColor="transparent";l.style.transform="translate("+i/10+"px,0px)";a.appendChild(l);var u=document.createElement("div");u.style.position="absolute";u.style.left="0";u.style.top="0";u.style.width="100%";u.style.height="100%";u.style.display="flex";u.style.justifyContent="center";u.style.alignItems="center";u.appendChild(a);r.appendChild(u)}return r};e.prototype.renderMediaPlayer=function(){var t;if(this._selectedMediaType=="video"){var e=document.createElement("video");var i=this.getPosterUrl();if(i){e.poster=i}t=e}else{t=document.createElement("audio")}t.controls=true;t.preload="none";t.style.width="100%";for(var n=0,r=this.sources;n<r.length;n++){var o=r[n];var s=document.createElement("source");s.src=o.url;s.type=o.mimeType;t.appendChild(s)}return t};e.prototype.internalRender=function(){var t=document.createElement("div");t.className=this.hostConfig.makeCssClassName("ac-media");this.processSources();t.appendChild(this.renderPoster());return t};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.poster=s.getStringValue(e["poster"]);this.altText=s.getStringValue(e["altText"]);this.sources=[];if(Array.isArray(e["sources"])){for(var n=0,r=e["sources"];n<r.length;n++){var o=r[n];var a=new O;a.parse(o,i);this.sources.push(a)}}};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"poster",this.poster);s.setProperty(e,"altText",this.altText);s.setArrayProperty(e,"sources",this.sources);return e};e.prototype.getJsonTypeName=function(){return"Media"};e.prototype.getResourceInformation=function(){var t=[];var e=this.getPosterUrl();if(!s.isNullOrEmpty(e)){t.push({url:e,mimeType:"image"})}for(var i=0,n=this.sources;i<n.length;i++){var r=n[i];if(!s.isNullOrEmpty(r.url)){t.push({url:r.url,mimeType:r.mimeType})}}return t};Object.defineProperty(e.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:true,configurable:true});e.supportedMediaTypes=["audio","video"];return e}(b);e.Media=k;var V=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.necessity=r.InputValidationNecessity.Optional;e.errorMessage=undefined;return e}e.prototype.parse=function(e){t.prototype.parse.call(this,e);this.necessity=s.getEnumValue(r.InputValidationNecessity,e["necessity"],this.necessity);this.errorMessage=s.getStringValue(e["errorMessage"])};e.prototype.toJSON=function(){if(this.necessity!=r.InputValidationNecessity.Optional||!s.isNullOrEmpty(this.errorMessage)){var e=t.prototype.toJSON.call(this);s.setEnumProperty(r.InputValidationNecessity,e,"necessity",this.necessity,r.InputValidationNecessity.Optional);s.setProperty(e,"errorMessage",this.errorMessage);return e}else{return null}};return e}(g);e.InputValidationOptions=V;var N=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.validation=new V;return e}Object.defineProperty(e.prototype,"isNullable",{get:function(){return true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:true,configurable:true});e.prototype.overrideInternalRender=function(){var t=this.hostConfig;this._outerContainerElement=document.createElement("div");this._outerContainerElement.style.display="flex";this._outerContainerElement.style.flexDirection="column";this._inputControlContainerElement=document.createElement("div");this._inputControlContainerElement.className=t.makeCssClassName("ac-input-container");this._inputControlContainerElement.style.display="flex";this._renderedInputControlElement=this.internalRender();this._renderedInputControlElement.style.minWidth="0px";if(yt.useBuiltInInputValidation&&this.isNullable&&this.validation.necessity==r.InputValidationNecessity.RequiredWithVisualCue){this._renderedInputControlElement.classList.add(t.makeCssClassName("ac-input-required"))}this._inputControlContainerElement.appendChild(this._renderedInputControlElement);this._outerContainerElement.appendChild(this._inputControlContainerElement);return this._outerContainerElement};e.prototype.valueChanged=function(){this.resetValidationFailureCue();if(this.onValueChanged){this.onValueChanged(this)}at(this)};e.prototype.resetValidationFailureCue=function(){if(yt.useBuiltInInputValidation&&this.renderedElement){this._renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed"));if(this._errorMessageElement){this._outerContainerElement.removeChild(this._errorMessageElement);this._errorMessageElement=null}}};e.prototype.showValidationErrorMessage=function(){if(this.renderedElement&&yt.useBuiltInInputValidation&&yt.displayInputValidationErrors&&!s.isNullOrEmpty(this.validation.errorMessage)){this._errorMessageElement=document.createElement("span");this._errorMessageElement.className=this.hostConfig.makeCssClassName("ac-input-validation-error-message");this._errorMessageElement.textContent=this.validation.errorMessage;this._outerContainerElement.appendChild(this._errorMessageElement)}};e.prototype.parseInputValue=function(t){return t};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"title",this.title);s.setProperty(e,"value",this.renderedElement&&!s.isNullOrEmpty(this.value)?this.value:this.defaultValue);if(yt.useBuiltInInputValidation){s.setProperty(e,"validation",this.validation.toJSON())}return e};e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);if(s.isNullOrEmpty(this.id)){e.addFailure(this,{error:r.ValidationError.PropertyCantBeNull,message:"All inputs must have a unique Id"})}};e.prototype.validateValue=function(){if(yt.useBuiltInInputValidation){this.resetValidationFailureCue();var t=this.validation.necessity!=r.InputValidationNecessity.Optional?!s.isNullOrEmpty(this.value):true;if(!t&&this.renderedElement){this._renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed"));this.showValidationErrorMessage()}return t}else{return true}};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.id=s.getStringValue(e["id"]);this.defaultValue=s.getStringValue(e["value"]);if(yt.useBuiltInInputValidation){var n=e["validation"];if(n){this.validation.parse(n)}}};e.prototype.getAllInputs=function(){return[this]};Object.defineProperty(e.prototype,"defaultValue",{get:function(){return this._defaultValue},set:function(t){this._defaultValue=this.parseInputValue(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isInteractive",{get:function(){return true},enumerable:true,configurable:true});return e}(b);e.Input=N;var z=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.isMultiline=false;e.style=r.InputTextStyle.Text;return e}e.prototype.internalRender=function(){var t=this;if(this.isMultiline){var e=document.createElement("textarea");e.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline");e.style.flex="1 1 auto";e.tabIndex=0;if(!s.isNullOrEmpty(this.placeholder)){e.placeholder=this.placeholder;e.setAttribute("aria-label",this.placeholder)}if(!s.isNullOrEmpty(this.defaultValue)){e.value=this.defaultValue}if(this.maxLength&&this.maxLength>0){e.maxLength=this.maxLength}e.oninput=function(){t.valueChanged()};e.onkeypress=function(e){if(e.keyCode==10&&t.inlineAction){t.inlineAction.execute()}};return e}else{var i=document.createElement("input");i.type=r.InputTextStyle[this.style].toLowerCase();i.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput");i.style.flex="1 1 auto";i.tabIndex=0;if(!s.isNullOrEmpty(this.placeholder)){i.placeholder=this.placeholder;i.setAttribute("aria-label",this.placeholder)}if(!s.isNullOrEmpty(this.defaultValue)){i.value=this.defaultValue}if(this.maxLength&&this.maxLength>0){i.maxLength=this.maxLength}i.oninput=function(){t.valueChanged()};i.onkeypress=function(e){if(e.keyCode==13&&t.inlineAction){t.inlineAction.execute()}};return i}};e.prototype.overrideInternalRender=function(){var e=this;var i=t.prototype.overrideInternalRender.call(this);if(this.inlineAction){var n=document.createElement("button");n.className=this.hostConfig.makeCssClassName("ac-inlineActionButton");n.onclick=function(t){t.preventDefault();t.cancelBubble=true;e.inlineAction.execute()};if(!s.isNullOrEmpty(this.inlineAction.iconUrl)){n.classList.add("iconOnly");var r=document.createElement("img");r.style.height="100%";r.style.display="none";r.onload=function(){r.style.removeProperty("display")};r.onerror=function(){n.removeChild(r);n.classList.remove("iconOnly");n.classList.add("textOnly");n.textContent=!s.isNullOrEmpty(e.inlineAction.title)?e.inlineAction.title:"Title"};r.src=this.inlineAction.iconUrl;n.appendChild(r);if(!s.isNullOrEmpty(this.inlineAction.title)){n.title=this.inlineAction.title}}else{n.classList.add("textOnly");n.textContent=!s.isNullOrEmpty(this.inlineAction.title)?this.inlineAction.title:"Title"}n.style.marginLeft="8px";this.inputControlContainerElement.appendChild(n)}return i};e.prototype.getJsonTypeName=function(){return"Input.Text"};e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);if(!i&&this.inlineAction){i=this.inlineAction.getActionById(e)}return i};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"placeholder",this.placeholder);s.setNumberProperty(e,"maxLength",this.maxLength);s.setProperty(e,"isMultiline",this.isMultiline,false);s.setEnumProperty(r.InputTextStyle,e,"style",this.style,r.InputTextStyle.Text);if(this._inlineAction){s.setProperty(e,"inlineAction",this._inlineAction.toJSON())}return e};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.maxLength=s.getNumberValue(e["maxLength"]);this.isMultiline=s.getBoolValue(e["isMultiline"],this.isMultiline);this.placeholder=s.getStringValue(e["placeholder"]);this.style=s.getEnumValue(r.InputTextStyle,e["style"],this.style);this.inlineAction=f(this,e["inlineAction"],[$.JsonTypeName],!this.isDesignMode(),i)};Object.defineProperty(e.prototype,"inlineAction",{get:function(){return this._inlineAction},set:function(t){this._inlineAction=t;if(this._inlineAction){this._inlineAction.setParent(this)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"value",{get:function(){if(this.renderedInputControlElement){if(this.isMultiline){return this.renderedInputControlElement.value}else{return this.renderedInputControlElement.value}}else{return null}},enumerable:true,configurable:true});return e}(N);e.TextInput=z;var D=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.valueOn="true";e.valueOff="false";e.wrap=false;return e}e.prototype.internalRender=function(){var t=this;var e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput");e.style.width="100%";e.style.display="flex";e.style.alignItems="center";this._checkboxInputElement=document.createElement("input");this._checkboxInputElement.id=s.generateUniqueId();this._checkboxInputElement.type="checkbox";this._checkboxInputElement.style.display="inline-block";this._checkboxInputElement.style.verticalAlign="middle";this._checkboxInputElement.style.margin="0";this._checkboxInputElement.style.flex="0 0 auto";this._checkboxInputElement.setAttribute("aria-label",this.title);this._checkboxInputElement.tabIndex=0;if(this.defaultValue==this.valueOn){this._checkboxInputElement.checked=true}this._checkboxInputElement.onchange=function(){t.valueChanged()};s.appendChild(e,this._checkboxInputElement);if(!s.isNullOrEmpty(this.title)||this.isDesignMode()){var i=new _;i.setParent(this);i.forElementId=this._checkboxInputElement.id;i.hostConfig=this.hostConfig;i.text=s.isNullOrEmpty(this.title)?this.getJsonTypeName():this.title;i.useMarkdown=yt.useMarkdownInRadioButtonAndCheckbox;i.wrap=this.wrap;var n=i.render();n.style.display="inline-block";n.style.flex="1 1 auto";n.style.marginLeft="6px";n.style.verticalAlign="middle";var r=document.createElement("div");r.style.width="6px";s.appendChild(e,r);s.appendChild(e,n)}return e};Object.defineProperty(e.prototype,"isNullable",{get:function(){return false},enumerable:true,configurable:true});e.prototype.getJsonTypeName=function(){return"Input.Toggle"};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"valueOn",this.valueOn,"true");s.setProperty(e,"valueOff",this.valueOff,"false");s.setProperty(e,"wrap",this.wrap);return e};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.title=s.getStringValue(e["title"]);this.valueOn=s.getStringValue(e["valueOn"],this.valueOn);this.valueOff=s.getStringValue(e["valueOff"],this.valueOff);this.wrap=s.getBoolValue(e["wrap"],this.wrap)};Object.defineProperty(e.prototype,"value",{get:function(){if(this._checkboxInputElement){return this._checkboxInputElement.checked?this.valueOn:this.valueOff}else{return null}},enumerable:true,configurable:true});return e}(N);e.ToggleInput=D;var F=function(t){n(e,t);function e(e,i){if(e===void 0){e=undefined}if(i===void 0){i=undefined}var n=t.call(this)||this;n.title=e;n.value=i;return n}e.prototype.parse=function(e){t.prototype.parse.call(this,e);this.title=s.getStringValue(e["title"],"");this.value=s.getStringValue(e["value"],"")};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"title",this.title);s.setProperty(e,"value",this.value);return e};return e}(g);e.Choice=F;var M=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.choices=[];e.isCompact=false;e.isMultiSelect=false;e.wrap=false;return e}e.getUniqueCategoryName=function(){var t="__ac-category"+e.uniqueCategoryCounter;e.uniqueCategoryCounter++;return t};e.prototype.internalRender=function(){var t=this;if(!this.isMultiSelect){if(this.isCompact){this._selectElement=document.createElement("select");this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact");this._selectElement.style.width="100%";var i=document.createElement("option");i.selected=true;i.disabled=true;i.hidden=true;i.value="";if(this.placeholder){i.text=this.placeholder}s.appendChild(this._selectElement,i);for(var n=0;n<this.choices.length;n++){var r=document.createElement("option");r.value=this.choices[n].value;r.text=this.choices[n].title;r.setAttribute("aria-label",this.choices[n].title);if(this.choices[n].value==this.defaultValue){r.selected=true}s.appendChild(this._selectElement,r)}this._selectElement.onchange=function(){t.valueChanged()};return this._selectElement}else{var o=e.getUniqueCategoryName();var a=document.createElement("div");a.className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-expanded");a.style.width="100%";this._toggleInputs=[];for(var l=0;l<this.choices.length;l++){var u=document.createElement("input");u.id=s.generateUniqueId();u.type="radio";u.style.margin="0";u.style.display="inline-block";u.style.verticalAlign="middle";u.name=s.isNullOrEmpty(this.id)?o:this.id;u.value=this.choices[l].value;u.style.flex="0 0 auto";u.setAttribute("aria-label",this.choices[l].title);if(this.choices[l].value==this.defaultValue){u.checked=true}u.onchange=function(){t.valueChanged()};this._toggleInputs.push(u);var p=new _;p.setParent(this);p.forElementId=u.id;p.hostConfig=this.hostConfig;p.text=s.isNullOrEmpty(this.choices[l].title)?"Choice "+l:this.choices[l].title;p.useMarkdown=yt.useMarkdownInRadioButtonAndCheckbox;p.wrap=this.wrap;var c=p.render();c.style.display="inline-block";c.style.flex="1 1 auto";c.style.marginLeft="6px";c.style.verticalAlign="middle";var h=document.createElement("div");h.style.width="6px";var f=document.createElement("div");f.style.display="flex";f.style.alignItems="center";s.appendChild(f,u);s.appendChild(f,h);s.appendChild(f,c);s.appendChild(a,f)}return a}}else{var d=this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):null;var a=document.createElement("div");a.className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-multiSelect");a.style.width="100%";this._toggleInputs=[];for(var g=0;g<this.choices.length;g++){var y=document.createElement("input");y.id=s.generateUniqueId();y.type="checkbox";y.style.margin="0";y.style.display="inline-block";y.style.verticalAlign="middle";y.value=this.choices[g].value;y.style.flex="0 0 auto";y.setAttribute("aria-label",this.choices[g].title);if(d){if(d.indexOf(this.choices[g].value)>=0){y.checked=true}}y.onchange=function(){t.valueChanged()};this._toggleInputs.push(y);var p=new _;p.setParent(this);p.forElementId=y.id;p.hostConfig=this.hostConfig;p.text=s.isNullOrEmpty(this.choices[g].title)?"Choice "+g:this.choices[g].title;p.useMarkdown=yt.useMarkdownInRadioButtonAndCheckbox;p.wrap=this.wrap;var c=p.render();c.style.display="inline-block";c.style.flex="1 1 auto";c.style.marginLeft="6px";c.style.verticalAlign="middle";var h=document.createElement("div");h.style.width="6px";var f=document.createElement("div");f.style.display="flex";f.style.alignItems="center";s.appendChild(f,y);s.appendChild(f,h);s.appendChild(f,c);s.appendChild(a,f)}return a}};e.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"placeholder",this.placeholder);s.setArrayProperty(e,"choices",this.choices);s.setProperty(e,"style",this.isCompact?null:"expanded");s.setProperty(e,"isMultiSelect",this.isMultiSelect,false);s.setProperty(e,"wrap",this.wrap,false);return e};e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);if(this.choices.length==0){e.addFailure(this,{error:r.ValidationError.CollectionCantBeEmpty,message:"An Input.ChoiceSet must have at least one choice defined."})}for(var i=0,n=this.choices;i<n.length;i++){var o=n[i];if(!o.title||!o.value){e.addFailure(this,{error:r.ValidationError.PropertyCantBeNull,message:"All choices in an Input.ChoiceSet must have their title and value properties set."})}}};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.isCompact=!(e["style"]==="expanded");this.isMultiSelect=s.getBoolValue(e["isMultiSelect"],this.isMultiSelect);this.placeholder=s.getStringValue(e["placeholder"]);this.choices=[];if(Array.isArray(e["choices"])){for(var n=0,r=e["choices"];n<r.length;n++){var o=r[n];var a=new F;a.parse(o);this.choices.push(a)}}this.wrap=s.getBoolValue(e["wrap"],this.wrap)};Object.defineProperty(e.prototype,"value",{get:function(){if(!this.isMultiSelect){if(this.isCompact){if(this._selectElement){return this._selectElement.selectedIndex>0?this._selectElement.value:null}return null}else{if(!this._toggleInputs||this._toggleInputs.length==0){return null}for(var t=0;t<this._toggleInputs.length;t++){if(this._toggleInputs[t].checked){return this._toggleInputs[t].value}}return null}}else{if(!this._toggleInputs||this._toggleInputs.length==0){return null}var e="";for(var t=0;t<this._toggleInputs.length;t++){if(this._toggleInputs[t].checked){if(e!=""){e+=this.hostConfig.choiceSetInputValueSeparator}e+=this._toggleInputs[t].value}}return e==""?null:e}},enumerable:true,configurable:true});e.uniqueCategoryCounter=0;return e}(N);e.ChoiceSetInput=M;var B=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.internalRender=function(){var t=this;this._numberInputElement=document.createElement("input");this._numberInputElement.setAttribute("type","number");if(this.min){this._numberInputElement.setAttribute("min",this.min.toString())}if(this.max){this._numberInputElement.setAttribute("max",this.max.toString())}this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput");this._numberInputElement.style.width="100%";this._numberInputElement.tabIndex=0;if(!s.isNullOrEmpty(this.defaultValue)){this._numberInputElement.value=this.defaultValue}if(!s.isNullOrEmpty(this.placeholder)){this._numberInputElement.placeholder=this.placeholder;this._numberInputElement.setAttribute("aria-label",this.placeholder)}this._numberInputElement.oninput=function(){t.valueChanged()};return this._numberInputElement};e.prototype.getJsonTypeName=function(){return"Input.Number"};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"placeholder",this.placeholder);s.setNumberProperty(e,"min",this.min);s.setNumberProperty(e,"max",this.max);return e};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.placeholder=s.getStringValue(e["placeholder"]);this.min=s.getNumberValue(e["min"]);this.max=s.getNumberValue(e["max"])};Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){this._min=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){this._max=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.value:undefined},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"valueAsNumber",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:undefined},enumerable:true,configurable:true});return e}(N);e.NumberInput=B;var L=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.internalRender=function(){var t=this;this._dateInputElement=document.createElement("input");this._dateInputElement.setAttribute("type","date");this._dateInputElement.setAttribute("min",this.min);this._dateInputElement.setAttribute("max",this.max);this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput");this._dateInputElement.style.width="100%";this._dateInputElement.oninput=function(){t.valueChanged()};if(!s.isNullOrEmpty(this.defaultValue)){this._dateInputElement.value=this.defaultValue}return this._dateInputElement};e.prototype.getJsonTypeName=function(){return"Input.Date"};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"min",this.min);s.setProperty(e,"max",this.max);return e};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.min=s.getStringValue(e["min"]);this.max=s.getStringValue(e["max"])};Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){this._min=this.parseInputValue(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){this._max=this.parseInputValue(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:null},enumerable:true,configurable:true});return e}(N);e.DateInput=L;var R=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.internalRender=function(){var t=this;this._timeInputElement=document.createElement("input");this._timeInputElement.setAttribute("type","time");this._timeInputElement.setAttribute("min",this.min);this._timeInputElement.setAttribute("max",this.max);this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput");this._timeInputElement.style.width="100%";this._timeInputElement.oninput=function(){t.valueChanged()};if(!s.isNullOrEmpty(this.defaultValue)){this._timeInputElement.value=this.defaultValue}return this._timeInputElement};e.prototype.parseInputValue=function(t){if(/^[0-9]{2}:[0-9]{2}$/.test(t)){return t}else{return null}};e.prototype.getJsonTypeName=function(){return"Input.Time"};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"min",this.min);s.setProperty(e,"max",this.max);return e};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.min=s.getStringValue(e["min"]);this.max=s.getStringValue(e["max"])};Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){this._min=this.parseInputValue(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){this._max=this.parseInputValue(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:null},enumerable:true,configurable:true});return e}(N);e.TimeInput=R;var H;(function(t){t[t["Normal"]=0]="Normal";t[t["Expanded"]=1]="Expanded";t[t["Subdued"]=2]="Subdued"})(H||(H={}));var j=function(){function t(t,e){this._state=H.Normal;this.onClick=null;this.action=t;this._parentContainerStyle=e}t.prototype.updateCssStyle=function(){var t,e;var i=this.action.parent.hostConfig;this.action.renderedElement.className=i.makeCssClassName("ac-pushButton");if(!s.isNullOrEmpty(this._parentContainerStyle)){this.action.renderedElement.classList.add("style-"+this._parentContainerStyle)}if(this.action instanceof $){this.action.renderedElement.classList.add(i.makeCssClassName("expandable"))}this.action.renderedElement.classList.remove(i.makeCssClassName("expanded"));this.action.renderedElement.classList.remove(i.makeCssClassName("subdued"));switch(this._state){case H.Expanded:this.action.renderedElement.classList.add(i.makeCssClassName("expanded"));break;case H.Subdued:this.action.renderedElement.classList.add(i.makeCssClassName("subdued"));break}if(!s.isNullOrEmpty(this.action.style)){if(this.action.style===r.ActionStyle.Positive){(t=this.action.renderedElement.classList).add.apply(t,i.makeCssClassNames("primary","style-positive"))}else{(e=this.action.renderedElement.classList).add.apply(e,i.makeCssClassNames("style-"+this.action.style.toLowerCase()))}}};t.prototype.render=function(){var t=this;this.action.render();this.action.renderedElement.onclick=function(e){e.preventDefault();e.cancelBubble=true;t.click()};this.updateCssStyle()};t.prototype.click=function(){if(this.onClick!=null){this.onClick(this)}};Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(t){this._state=t;this.updateCssStyle()},enumerable:true,configurable:true});return t}();var J=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._shouldFallback=false;e._parent=null;e._actionCollection=null;e._renderedElement=null;e.requires=new a.HostCapabilities;e.style=r.ActionStyle.Default;return e}e.prototype.setCollection=function(t){this._actionCollection=t};e.prototype.addCssClasses=function(t){};e.prototype.internalGetReferencedInputs=function(t){return{}};e.prototype.internalPrepareForExecution=function(t){};e.prototype.internalValidateInputs=function(t){var e=[];if(yt.useBuiltInInputValidation&&!this.ignoreInputValidation){for(var i=0,n=Object.keys(t);i<n.length;i++){var r=n[i];var o=t[r];if(!o.validateValue()){e.push(o)}}}return e};e.prototype.getHref=function(){return""};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"type",this.getJsonTypeName());s.setProperty(e,"title",this.title);s.setProperty(e,"iconUrl",this.iconUrl);s.setProperty(e,"style",this.style,r.ActionStyle.Default);return e};e.prototype.render=function(t){if(t===void 0){t="ac-pushButton"}var e=this.parent.hostConfig;var i=document.createElement("button");this.addCssClasses(i);i.setAttribute("aria-label",this.title);i.type="button";i.style.display="flex";i.style.alignItems="center";i.style.justifyContent="center";var n=!s.isNullOrEmpty(this.title);var o=document.createElement("div");o.style.overflow="hidden";o.style.textOverflow="ellipsis";if(!(e.actions.iconPlacement==r.ActionIconPlacement.AboveTitle||e.actions.allowTitleToWrap)){o.style.whiteSpace="nowrap"}if(n){o.innerText=this.title}if(s.isNullOrEmpty(this.iconUrl)){i.classList.add("noIcon");i.appendChild(o)}else{var a=document.createElement("img");a.src=this.iconUrl;a.style.width=e.actions.iconSize+"px";a.style.height=e.actions.iconSize+"px";a.style.flex="0 0 auto";if(e.actions.iconPlacement==r.ActionIconPlacement.AboveTitle){i.classList.add("iconAbove");i.style.flexDirection="column";if(n){a.style.marginBottom="4px"}}else{i.classList.add("iconLeft");if(n){a.style.marginRight="4px"}}i.appendChild(a);i.appendChild(o)}this._renderedElement=i};e.prototype.setParent=function(t){this._parent=t};e.prototype.execute=function(){if(this.onExecute){this.onExecute(this)}ot(this)};e.prototype.prepareForExecution=function(){var t=this.getReferencedInputs();if(this.internalValidateInputs(t).length>0){return false}this.internalPrepareForExecution(t);return true};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);pt(this,e,i);this.requires.parse(e["requires"],i);if(!e["title"]&&e["title"]!==""){ct({error:r.ValidationError.PropertyCantBeNull,message:"Actions should always have a title."},i)}this.title=s.getStringValue(e["title"]);this.iconUrl=s.getStringValue(e["iconUrl"]);this.style=s.getStringValue(e["style"],this.style)};e.prototype.remove=function(){if(this._actionCollection){return this._actionCollection.removeAction(this)}return false};e.prototype.getAllInputs=function(){return[]};e.prototype.getResourceInformation=function(){if(!s.isNullOrEmpty(this.iconUrl)){return[{url:this.iconUrl,mimeType:"image"}]}else{return[]}};e.prototype.getActionById=function(t){if(this.id==t){return this}};e.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs(this.parent.getRootElement().getAllInputs())};e.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())};e.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.parent.hostConfig.hostCapabilities)};Object.defineProperty(e.prototype,"isPrimary",{get:function(){return this.style==r.ActionStyle.Positive},set:function(t){if(t){this.style=r.ActionStyle.Positive}else{if(this.style==r.ActionStyle.Positive){this.style=r.ActionStyle.Default}}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ignoreInputValidation",{get:function(){return true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:true,configurable:true});return e}(v);e.Action=J;var W=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._isPrepared=false;e._ignoreInputValidation=false;return e}e.prototype.internalGetReferencedInputs=function(t){var e={};for(var i=0,n=t;i<n.length;i++){var r=n[i];e[r.id]=r}return e};e.prototype.internalPrepareForExecution=function(t){if(this._originalData){this._processedData=JSON.parse(JSON.stringify(this._originalData))}else{this._processedData={}}for(var e=0,i=Object.keys(t);e<i.length;e++){var n=i[e];var r=t[n];if(r.value!=null){this._processedData[r.id]=r.value}}this._isPrepared=true};e.prototype.getJsonTypeName=function(){return e.JsonTypeName};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"ignoreInputValidation",this.ignoreInputValidation,false);s.setProperty(e,"data",this._originalData);return e};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this._ignoreInputValidation=s.getBoolValue(e["ignoreInputValidation"],this._ignoreInputValidation);this.data=e["data"]};Object.defineProperty(e.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(t){this._ignoreInputValidation=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(t){this._originalData=t;this._isPrepared=false},enumerable:true,configurable:true});e.JsonTypeName="Action.Submit";return e}(J);e.SubmitAction=W;var U=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.getJsonTypeName=function(){return e.JsonTypeName};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"url",this.url);return e};e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);if(s.isNullOrEmpty(this.url)){e.addFailure(this,{error:r.ValidationError.PropertyCantBeNull,message:"An Action.OpenUrl must have its url property set."})}};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.url=s.getStringValue(e["url"])};e.prototype.getHref=function(){return this.url};e.JsonTypeName="Action.OpenUrl";return e}(J);e.OpenUrlAction=U;var q=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.targetElements={};return e}e.prototype.getJsonTypeName=function(){return e.JsonTypeName};e.prototype.execute=function(){for(var t=0,e=Object.keys(this.targetElements);t<e.length;t++){var i=e[t];var n=this.parent.getRootElement().getElementById(i);if(n){if(typeof this.targetElements[i]==="boolean"){n.isVisible=this.targetElements[i]}else{n.isVisible=!n.isVisible}}}};e.prototype.parse=function(e){t.prototype.parse.call(this,e);this.targetElements={};var i=e["targetElements"];if(i&&Array.isArray(i)){for(var n=0,r=i;n<r.length;n++){var o=r[n];if(typeof o==="string"){this.targetElements[o]=undefined}else if(typeof o==="object"){var a=o["elementId"];if(a&&typeof a==="string"){this.targetElements[a]=s.getBoolValue(o["isVisible"],undefined)}}}}};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);var i=[];for(var n=0,r=Object.keys(this.targetElements);n<r.length;n++){var o=r[n];if(typeof this.targetElements[o]==="boolean"){i.push({elementId:o,isVisible:this.targetElements[o]})}else{i.push(o)}}e["targetElements"]=i;return e};e.prototype.addTargetElement=function(t,e){if(e===void 0){e=undefined}this.targetElements[t]=e};e.prototype.removeTargetElement=function(t){delete this.targetElements[t]};e.JsonTypeName="Action.ToggleVisibility";return e}(J);e.ToggleVisibilityAction=q;var G=function(t){n(e,t);function e(e,i){if(e===void 0){e=""}if(i===void 0){i=""}var n=t.call(this)||this;n._value=new o.StringWithSubstitutions;n.name=e;n.value=i;return n}e.prototype.parse=function(e){t.prototype.parse.call(this,e);this.name=s.getStringValue(e["name"]);this.value=s.getStringValue(e["value"])};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"name",this.name);s.setProperty(e,"value",this._value.getOriginal());return e};e.prototype.getReferencedInputs=function(t,e){this._value.getReferencedInputs(t,e)};e.prototype.prepareForExecution=function(t){this._value.substituteInputValues(t,o.ContentTypes.applicationXWwwFormUrlencoded)};Object.defineProperty(e.prototype,"value",{get:function(){return this._value.get()},set:function(t){this._value.set(t)},enumerable:true,configurable:true});return e}(g);e.HttpHeader=G;var X=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._url=new o.StringWithSubstitutions;e._body=new o.StringWithSubstitutions;e._headers=[];e._ignoreInputValidation=false;return e}e.prototype.internalGetReferencedInputs=function(t){var e={};this._url.getReferencedInputs(t,e);for(var i=0,n=this._headers;i<n.length;i++){var r=n[i];r.getReferencedInputs(t,e)}this._body.getReferencedInputs(t,e);return e};e.prototype.internalPrepareForExecution=function(t){this._url.substituteInputValues(t,o.ContentTypes.applicationXWwwFormUrlencoded);var e=o.ContentTypes.applicationJson;for(var i=0,n=this._headers;i<n.length;i++){var r=n[i];r.prepareForExecution(t);if(r.name&&r.name.toLowerCase()=="content-type"){e=r.value}}this._body.substituteInputValues(t,e)};e.prototype.getJsonTypeName=function(){return e.JsonTypeName};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"method",this.method);s.setProperty(e,"url",this._url.getOriginal());s.setProperty(e,"body",this._body.getOriginal());s.setProperty(e,"ignoreInputValidation",this.ignoreInputValidation,false);s.setArrayProperty(e,"headers",this.headers);return e};e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);if(s.isNullOrEmpty(this.url)){e.addFailure(this,{error:r.ValidationError.PropertyCantBeNull,message:"An Action.Http must have its url property set."})}if(this.headers.length>0){for(var i=0,n=this.headers;i<n.length;i++){var o=n[i];if(!o.name){e.addFailure(this,{error:r.ValidationError.PropertyCantBeNull,message:"All headers of an Action.Http must have their name and value properties set."})}}}};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.url=s.getStringValue(e["url"]);this.method=s.getStringValue(e["method"]);this.body=s.getStringValue(e["body"]);this._ignoreInputValidation=s.getBoolValue(e["ignoreInputValidation"],this._ignoreInputValidation);this._headers=[];if(Array.isArray(e["headers"])){for(var n=0,r=e["headers"];n<r.length;n++){var o=r[n];var a=new G;a.parse(o);this.headers.push(a)}}};Object.defineProperty(e.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(t){this._ignoreInputValidation=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"url",{get:function(){return this._url.get()},set:function(t){this._url.set(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"body",{get:function(){return this._body.get()},set:function(t){this._body.set(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"headers",{get:function(){return this._headers?this._headers:[]},set:function(t){this._headers=t},enumerable:true,configurable:true});e.JsonTypeName="Action.Http";return e}(J);e.HttpAction=X;var $=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.card=new mt;return e}e.prototype.addCssClasses=function(e){t.prototype.addCssClasses.call(this,e);e.classList.add(this.parent.hostConfig.makeCssClassName("expandable"))};e.prototype.getJsonTypeName=function(){return e.JsonTypeName};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(this.card){s.setProperty(e,"card",this.card.toJSON())}return e};e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);this.card.internalValidateProperties(e)};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);var n=e["card"];if(n){this.card.parse(n,i)}else{ct({error:r.ValidationError.PropertyCantBeNull,message:'An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},i)}};e.prototype.setParent=function(e){t.prototype.setParent.call(this,e);this.card.setParent(e)};e.prototype.getAllInputs=function(){return this.card.getAllInputs()};e.prototype.getResourceInformation=function(){return t.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation())};e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);if(!i){i=this.card.getActionById(e)}return i};e.JsonTypeName="Action.ShowCard";return e}(J);e.ShowCardAction=$;var Y=function(){function t(t){this._expandedAction=null;this._renderedActionCount=0;this._actionCard=null;this.items=[];this.buttons=[];this._owner=t}t.prototype.refreshContainer=function(){this._actionCardContainer.innerHTML="";if(this._actionCard===null){this._actionCardContainer.style.marginTop="0px";return}this._actionCardContainer.style.marginTop=this._renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var t=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(t);var e=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(t);if(this._actionCard!==null){this._actionCard.style.paddingLeft=e.left+"px";this._actionCard.style.paddingRight=e.right+"px";this._actionCard.style.marginLeft="-"+e.left+"px";this._actionCard.style.marginRight="-"+e.right+"px";if(e.bottom!=0&&!this._owner.isDesignMode()){this._actionCard.style.paddingBottom=e.bottom+"px";this._actionCard.style.marginBottom="-"+e.bottom+"px"}s.appendChild(this._actionCardContainer,this._actionCard)}};t.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()};t.prototype.hideActionCard=function(){var t=this._expandedAction;this._expandedAction=null;this._actionCard=null;this.refreshContainer();if(t){this.layoutChanged();st(t,false)}};t.prototype.showActionCard=function(t,e,i){if(e===void 0){e=false}if(i===void 0){i=true}if(t.card==null){return}t.card.suppressStyle=e;var n=t.card.render();this._actionCard=n;this._expandedAction=t;this.refreshContainer();if(i){this.layoutChanged();st(t,true)}};t.prototype.collapseExpandedAction=function(){for(var t=0;t<this.buttons.length;t++){this.buttons[t].state=H.Normal}this.hideActionCard()};t.prototype.expandShowCardAction=function(t,e){for(var i=0;i<this.buttons.length;i++){if(this.buttons[i].action!==t){this.buttons[i].state=H.Subdued}else{this.buttons[i].state=H.Expanded}}this.showActionCard(t,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),e)};t.prototype.actionClicked=function(t){if(!(t.action instanceof $)){for(var e=0;e<this.buttons.length;e++){this.buttons[e].state=H.Normal}this.hideActionCard();t.action.execute()}else{if(this._owner.hostConfig.actions.showCard.actionMode===r.ShowCardActionMode.Popup){t.action.execute()}else if(t.action===this._expandedAction){this.collapseExpandedAction()}else{this.expandShowCardAction(t.action,true)}}};t.prototype.getParentContainer=function(){if(this._owner instanceof tt){return this._owner}else{return this._owner.getParentContainer()}};t.prototype.findActionButton=function(t){for(var e=0,i=this.buttons;e<i.length;e++){var n=i[e];if(n.action==t){return n}}return null};t.prototype.parse=function(t,e){this.clear();if(t&&t instanceof Array){for(var i=0,n=t;i<n.length;i++){var r=n[i];var o=f(this._owner,r,[],!this._owner.isDesignMode(),e);if(o){this.addAction(o)}}}};t.prototype.toJSON=function(){if(this.items.length>0){var t=[];for(var e=0,i=this.items;e<i.length;e++){var n=i[e];t.push(n.toJSON())}return t}else{return null}};t.prototype.getActionById=function(t){var e=null;for(var i=0;i<this.items.length;i++){e=this.items[i].getActionById(t);if(e){break}}return e};t.prototype.validateProperties=function(t){if(this._owner.hostConfig.actions.maxActions&&this.items.length>this._owner.hostConfig.actions.maxActions){t.addFailure(this._owner,{error:r.ValidationError.TooManyActions,message:"A maximum of "+this._owner.hostConfig.actions.maxActions+" actions are allowed."})}if(this.items.length>0&&!this._owner.hostConfig.supportsInteractivity){t.addFailure(this._owner,{error:r.ValidationError.InteractivityNotAllowed,message:"Interactivity is not allowed."})}for(var e=0,i=this.items;e<i.length;e++){var n=i[e];if(!p(n,this._owner.getForbiddenActionTypes())){t.addFailure(this._owner,{error:r.ValidationError.ActionTypeNotAllowed,message:"Actions of type "+n.getJsonTypeName()+" are not allowe."})}n.internalValidateProperties(t)}};t.prototype.render=function(t,e){var i=this;var n=this._owner.hostConfig;if(!n.supportsInteractivity){return null}var o=document.createElement("div");var a=n.actions.maxActions?Math.min(n.actions.maxActions,this.items.length):this.items.length;var l=this._owner.getForbiddenActionTypes();this._actionCardContainer=document.createElement("div");this._renderedActionCount=0;if(n.actions.preExpandSingleShowCardAction&&a==1&&this.items[0]instanceof $&&p(this.items[0],l)){this.showActionCard(this.items[0],true);this._renderedActionCount=1}else{var u=document.createElement("div");u.className=n.makeCssClassName("ac-actionSet");u.style.display="flex";if(t==r.Orientation.Horizontal){u.style.flexDirection="row";if(this._owner.horizontalAlignment&&n.actions.actionAlignment!=r.ActionAlignment.Stretch){switch(this._owner.horizontalAlignment){case r.HorizontalAlignment.Center:u.style.justifyContent="center";break;case r.HorizontalAlignment.Right:u.style.justifyContent="flex-end";break;default:u.style.justifyContent="flex-start";break}}else{switch(n.actions.actionAlignment){case r.ActionAlignment.Center:u.style.justifyContent="center";break;case r.ActionAlignment.Right:u.style.justifyContent="flex-end";break;default:u.style.justifyContent="flex-start";break}}}else{u.style.flexDirection="column";if(this._owner.horizontalAlignment&&n.actions.actionAlignment!=r.ActionAlignment.Stretch){switch(this._owner.horizontalAlignment){case r.HorizontalAlignment.Center:u.style.alignItems="center";break;case r.HorizontalAlignment.Right:u.style.alignItems="flex-end";break;default:u.style.alignItems="flex-start";break}}else{switch(n.actions.actionAlignment){case r.ActionAlignment.Center:u.style.alignItems="center";break;case r.ActionAlignment.Right:u.style.alignItems="flex-end";break;case r.ActionAlignment.Stretch:u.style.alignItems="stretch";break;default:u.style.alignItems="flex-start";break}}}var c=this.getParentContainer().getEffectiveStyle();for(var h=0;h<this.items.length;h++){if(p(this.items[h],l)){var f=this.findActionButton(this.items[h]);if(!f){f=new j(this.items[h],c);f.onClick=function(t){i.actionClicked(t)};this.buttons.push(f)}f.render();if(n.actions.actionsOrientation==r.Orientation.Horizontal&&n.actions.actionAlignment==r.ActionAlignment.Stretch){f.action.renderedElement.style.flex="0 1 100%"}else{f.action.renderedElement.style.flex="0 1 auto"}u.appendChild(f.action.renderedElement);this._renderedActionCount++;if(this._renderedActionCount>=n.actions.maxActions||h==this.items.length-1){break}else if(n.actions.buttonSpacing>0){var d=document.createElement("div");if(t===r.Orientation.Horizontal){d.style.flex="0 0 auto";d.style.width=n.actions.buttonSpacing+"px"}else{d.style.height=n.actions.buttonSpacing+"px"}s.appendChild(u,d)}}}var g=document.createElement("div");g.style.overflow="hidden";g.appendChild(u);s.appendChild(o,g)}s.appendChild(o,this._actionCardContainer);for(var h=0;h<this.buttons.length;h++){if(this.buttons[h].state==H.Expanded){this.expandShowCardAction(this.buttons[h].action,false);break}}return this._renderedActionCount>0?o:null};t.prototype.addAction=function(t){if(!t){throw new Error("The action parameter cannot be null.")}if((!t.parent||t.parent===this._owner)&&this.items.indexOf(t)<0){this.items.push(t);if(!t.parent){t.setParent(this._owner)}u(t,this)}else{throw new Error("The action already belongs to another element.")}};t.prototype.removeAction=function(t){if(this.expandedAction&&this._expandedAction==t){this.collapseExpandedAction()}var e=this.items.indexOf(t);if(e>=0){this.items.splice(e,1);t.setParent(null);u(t,null);for(var i=0;i<this.buttons.length;i++){if(this.buttons[i].action==t){this.buttons.splice(i,1);break}}return true}return false};t.prototype.clear=function(){this.items=[];this.buttons=[];this._expandedAction=null;this._renderedActionCount=0};t.prototype.getAllInputs=function(){var t=[];for(var e=0;e<this.items.length;e++){var i=this.items[e];t=t.concat(i.getAllInputs())}return t};t.prototype.getResourceInformation=function(){var t=[];for(var e=0;e<this.items.length;e++){t=t.concat(this.items[e].getResourceInformation())}return t};Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._renderedActionCount},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:true,configurable:true});return t}();var Z=function(t){n(e,t);function e(){var e=t.call(this)||this;e.orientation=null;e._actionCollection=new Y(e);return e}e.prototype.internalRender=function(){return this._actionCollection.render(this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation,this.isDesignMode())};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setEnumProperty(r.Orientation,e,"orientation",this.orientation);s.setProperty(e,"actions",this._actionCollection.toJSON());return e};e.prototype.isBleedingAtBottom=function(){if(this._actionCollection.renderedActionCount==0){return t.prototype.isBleedingAtBottom.call(this)}else{if(this._actionCollection.items.length==1){return this._actionCollection.expandedAction!=null&&!this.hostConfig.actions.preExpandSingleShowCardAction}else{return this._actionCollection.expandedAction!=null}}};e.prototype.getJsonTypeName=function(){return"ActionSet"};e.prototype.getActionCount=function(){return this._actionCollection.items.length};e.prototype.getActionAt=function(e){if(e>=0&&e<this.getActionCount()){return this._actionCollection.items[e]}else{t.prototype.getActionAt.call(this,e)}};e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);this._actionCollection.validateProperties(e)};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);var n=e["orientation"];if(n){this.orientation=s.getEnumValue(r.Orientation,n,r.Orientation.Horizontal)}this._actionCollection.parse(e["actions"],i)};e.prototype.addAction=function(t){this._actionCollection.addAction(t)};e.prototype.getAllInputs=function(){return this._actionCollection.getAllInputs()};e.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()};Object.defineProperty(e.prototype,"isInteractive",{get:function(){return true},enumerable:true,configurable:true});return e}(b);e.ActionSet=Z;var K=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._style=null;e._bleed=false;return e}e.prototype.applyBackground=function(){var t=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(!s.isNullOrEmpty(t.backgroundColor)){this.renderedElement.style.backgroundColor=s.stringToCssColor(t.backgroundColor)}};e.prototype.applyPadding=function(){t.prototype.applyPadding.call(this);if(!this.renderedElement){return}var e=new o.SpacingDefinition;if(this.getEffectivePadding()){e=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())}this.renderedElement.style.paddingTop=e.top+"px";this.renderedElement.style.paddingRight=e.right+"px";this.renderedElement.style.paddingBottom=e.bottom+"px";this.renderedElement.style.paddingLeft=e.left+"px";if(this.isBleeding()){var i=new o.PaddingDefinition;this.getImmediateSurroundingPadding(i);var n=this.hostConfig.paddingDefinitionToSpacingDefinition(i);this.renderedElement.style.marginRight="-"+n.right+"px";this.renderedElement.style.marginLeft="-"+n.left+"px";if(!this.isDesignMode()){this.renderedElement.style.marginTop="-"+n.top+"px";this.renderedElement.style.marginBottom="-"+n.bottom+"px"}if(this.separatorElement&&this.separatorOrientation==r.Orientation.Horizontal){this.separatorElement.style.marginLeft="-"+n.left+"px";this.separatorElement.style.marginRight="-"+n.right+"px"}}else{this.renderedElement.style.marginRight="0";this.renderedElement.style.marginLeft="0";this.renderedElement.style.marginTop="0";this.renderedElement.style.marginBottom="0";if(this.separatorElement){this.separatorElement.style.marginRight="0";this.separatorElement.style.marginLeft="0"}}};e.prototype.getHasBackground=function(){var t=this.parent;while(t){var i=t instanceof tt?t.backgroundImage.isValid():false;if(t instanceof e){if(this.hasExplicitStyle&&(t.getEffectiveStyle()!=this.getEffectiveStyle()||i)){return true}}t=t.parent}return false};e.prototype.getDefaultPadding=function(){return this.getHasBackground()?new o.PaddingDefinition(r.Spacing.Padding,r.Spacing.Padding,r.Spacing.Padding,r.Spacing.Padding):t.prototype.getDefaultPadding.call(this)};e.prototype.getHasExpandedAction=function(){return false};e.prototype.getBleed=function(){return this._bleed};e.prototype.setBleed=function(t){this._bleed=t};Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return 0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"hasExplicitStyle",{get:function(){return this._style!=null},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"allowCustomStyle",{get:function(){return true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"supportsMinHeight",{get:function(){return true},enumerable:true,configurable:true});e.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"style",this.style);return e};e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);if(this._style){var i=this.hostConfig.containerStyles.getStyleByName(this._style);if(!i){e.addFailure(this,{error:r.ValidationError.InvalidPropertyValue,message:"Unknown container style: "+this._style})}}};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this._style=s.getStringValue(e["style"])};e.prototype.render=function(){var e=t.prototype.render.call(this);if(e&&this.getHasBackground()){this.applyBackground()}return e};e.prototype.getEffectiveStyle=function(){var e=this.style;return e?e:t.prototype.getEffectiveStyle.call(this)};Object.defineProperty(e.prototype,"style",{get:function(){if(this.allowCustomStyle){if(this._style&&this.hostConfig.containerStyles.getStyleByName(this._style)){return this._style}}return null},set:function(t){this._style=t},enumerable:true,configurable:true});return e}(T);e.StylableCardElementContainer=K;var Q=function(t){n(e,t);function e(){var i=t!==null&&t.apply(this,arguments)||this;i.fillMode=e.defaultFillMode;i.horizontalAlignment=e.defaultHorizontalAlignment;i.verticalAlignment=e.defaultVerticalAlignment;return i}e.prototype.reset=function(){this.url=undefined;this.fillMode=e.defaultFillMode;this.horizontalAlignment=e.defaultHorizontalAlignment;this.verticalAlignment=e.defaultVerticalAlignment};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.url=s.getStringValue(e["url"]);this.fillMode=s.getEnumValue(r.FillMode,e["fillMode"],this.fillMode);this.horizontalAlignment=s.getEnumValue(r.HorizontalAlignment,e["horizontalAlignment"],this.horizontalAlignment);this.verticalAlignment=s.getEnumValue(r.VerticalAlignment,e["verticalAlignment"],this.verticalAlignment)};e.prototype.toJSON=function(){if(!this.isValid()){return null}if(this.fillMode==e.defaultFillMode&&this.horizontalAlignment==e.defaultHorizontalAlignment&&this.verticalAlignment==e.defaultVerticalAlignment){return this.url}else{var i=t.prototype.toJSON.call(this);s.setProperty(i,"url",this.url);s.setEnumProperty(r.FillMode,i,"fillMode",this.fillMode,e.defaultFillMode);s.setEnumProperty(r.HorizontalAlignment,i,"horizontalAlignment",this.horizontalAlignment,e.defaultHorizontalAlignment);s.setEnumProperty(r.VerticalAlignment,i,"verticalAlignment",this.verticalAlignment,e.defaultVerticalAlignment);return i}};e.prototype.apply=function(t){if(this.url){t.style.backgroundImage="url('"+this.url+"')";switch(this.fillMode){case r.FillMode.Repeat:t.style.backgroundRepeat="repeat";break;case r.FillMode.RepeatHorizontally:t.style.backgroundRepeat="repeat-x";break;case r.FillMode.RepeatVertically:t.style.backgroundRepeat="repeat-y";break;case r.FillMode.Cover:default:t.style.backgroundRepeat="no-repeat";t.style.backgroundSize="cover";break}switch(this.horizontalAlignment){case r.HorizontalAlignment.Center:t.style.backgroundPositionX="center";break;case r.HorizontalAlignment.Right:t.style.backgroundPositionX="right";break}switch(this.verticalAlignment){case r.VerticalAlignment.Center:t.style.backgroundPositionY="center";break;case r.VerticalAlignment.Bottom:t.style.backgroundPositionY="bottom";break}}};e.prototype.isValid=function(){return!s.isNullOrEmpty(this.url)};e.defaultFillMode=r.FillMode.Cover;e.defaultHorizontalAlignment=r.HorizontalAlignment.Left;e.defaultVerticalAlignment=r.VerticalAlignment.Top;return e}(g);e.BackgroundImage=Q;var tt=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._items=[];e._renderedItems=[];e.backgroundImage=new Q;e.verticalContentAlignment=r.VerticalAlignment.Top;e.rtl=null;return e}e.prototype.insertItemAt=function(t,e,i){if(!t.parent||i){if(t.isStandalone){if(e<0||e>=this._items.length){this._items.push(t)}else{this._items.splice(e,0,t)}t.setParent(this)}else{throw new Error("Elements of type "+t.getJsonTypeName()+" cannot be used as standalone elements.")}}else{throw new Error("The element already belongs to another container.")}};e.prototype.supportsExcplitiHeight=function(){return true};e.prototype.getItemsCollectionPropertyName=function(){return"items"};e.prototype.applyBackground=function(){if(this.backgroundImage.isValid()){this.backgroundImage.apply(this.renderedElement)}t.prototype.applyBackground.call(this)};e.prototype.internalRender=function(){this._renderedItems=[];var t=this.hostConfig;var e=document.createElement("div");if(this.rtl!=null&&this.rtl){e.dir="rtl"}e.classList.add(t.makeCssClassName("ac-container"));e.style.display="flex";e.style.flexDirection="column";if(yt.useAdvancedCardBottomTruncation){e.style.minHeight="-webkit-min-content"}switch(this.verticalContentAlignment){case r.VerticalAlignment.Center:e.style.justifyContent="center";break;case r.VerticalAlignment.Bottom:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start";break}if(this._items.length>0){for(var i=0;i<this._items.length;i++){var n=this.isElementAllowed(this._items[i],this.getForbiddenElementTypes())?this._items[i].render():null;if(n){if(this._renderedItems.length>0&&this._items[i].separatorElement){this._items[i].separatorElement.style.flex="0 0 auto";s.appendChild(e,this._items[i].separatorElement)}s.appendChild(e,n);this._renderedItems.push(this._items[i])}}}else{if(this.isDesignMode()){var o=this.createPlaceholderElement();o.style.width="100%";o.style.height="100%";e.appendChild(o)}}return e};e.prototype.truncateOverflow=function(t){var e=this.renderedElement.offsetTop+t+1;var i=function(t){var n=t.renderedElement;if(n){switch(s.getFitStatus(n,e)){case r.ContainerFitStatus.FullyInContainer:var o=t["resetOverflow"]();if(o){i(t)}break;case r.ContainerFitStatus.Overflowing:var a=e-n.offsetTop;t["handleOverflow"](a);break;case r.ContainerFitStatus.FullyOutOfContainer:t["handleOverflow"](0);break}}};for(var n=0,o=this._items;n<o.length;n++){var a=o[n];i(a)}return true};e.prototype.undoOverflowTruncation=function(){for(var t=0,e=this._items;t<e.length;t++){var i=e[t];i["resetOverflow"]()}};e.prototype.getHasBackground=function(){return this.backgroundImage.isValid()||t.prototype.getHasBackground.call(this)};Object.defineProperty(e.prototype,"isSelectable",{get:function(){return true},enumerable:true,configurable:true});e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"backgroundImage",this.backgroundImage.toJSON());s.setEnumProperty(r.VerticalAlignment,e,"verticalContentAlignment",this.verticalContentAlignment,r.VerticalAlignment.Top);if(this._items.length>0){var i=[];for(var n=0,o=this._items;n<o.length;n++){var a=o[n];i.push(a.toJSON())}s.setProperty(e,this.getItemsCollectionPropertyName(),i)}s.setProperty(e,"bleed",this.bleed,false);return e};e.prototype.getItemCount=function(){return this._items.length};e.prototype.getItemAt=function(t){return this._items[t]};e.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0){for(var t=0,e=this._renderedItems;t<e.length;t++){var i=e[t];if(i.isVisible){return i}}}return null};e.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0){for(var t=this._renderedItems.length-1;t>=0;t--){if(this._renderedItems[t].isVisible){return this._renderedItems[t]}}}return null};e.prototype.getJsonTypeName=function(){return"Container"};e.prototype.isFirstElement=function(t){var e=this.isDesignMode();for(var i=0;i<this._items.length;i++){if(this._items[i].isVisible||e){return this._items[i]==t}}return false};e.prototype.isLastElement=function(t){var e=this.isDesignMode();for(var i=this._items.length-1;i>=0;i--){if(this._items[i].isVisible||e){return this._items[i]==t}}return false};e.prototype.isRtl=function(){if(this.rtl!=null){return this.rtl}else{var t=this.getParentContainer();return t?t.isRtl():false}};e.prototype.isBleedingAtTop=function(){var t=this.getFirstVisibleRenderedItem();return this.isBleeding()||(t?t.isBleedingAtTop():false)};e.prototype.isBleedingAtBottom=function(){var t=this.getLastVisibleRenderedItem();return this.isBleeding()||(t?t.isBleedingAtBottom()&&t.getEffectiveStyle()==this.getEffectiveStyle():false)};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this.setShouldFallback(false);this._items=[];this._renderedItems=[];this.backgroundImage.reset();var n=e["backgroundImage"];if(n){if(typeof n==="string"){this.backgroundImage.url=n;this.backgroundImage.fillMode=r.FillMode.Cover}else if(typeof n==="object"){this.backgroundImage.parse(n,i)}}this.verticalContentAlignment=s.getEnumValue(r.VerticalAlignment,e["verticalContentAlignment"],this.verticalContentAlignment);if(e[this.getItemsCollectionPropertyName()]!=null){var o=e[this.getItemsCollectionPropertyName()];this.clear();for(var a=0;a<o.length;a++){var l=d(this,o[a],!this.isDesignMode(),i);if(l){this.insertItemAt(l,-1,true)}}}this.bleed=s.getBoolValue(e["bleed"],this.bleed)};e.prototype.indexOf=function(t){return this._items.indexOf(t)};e.prototype.addItem=function(t){this.insertItemAt(t,-1,false)};e.prototype.insertItemBefore=function(t,e){this.insertItemAt(t,this._items.indexOf(e),false)};e.prototype.insertItemAfter=function(t,e){this.insertItemAt(t,this._items.indexOf(e)+1,false)};e.prototype.removeItem=function(t){var e=this._items.indexOf(t);if(e>=0){this._items.splice(e,1);t.setParent(null);this.updateLayout();return true}return false};e.prototype.clear=function(){this._items=[]};e.prototype.getResourceInformation=function(){var e=t.prototype.getResourceInformation.call(this);if(this.backgroundImage.isValid()){e.push({url:this.backgroundImage.url,mimeType:"image"})}return e};e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);if(!i){if(this.selectAction){i=this.selectAction.getActionById(e)}if(!i){for(var n=0;n<this._items.length;n++){i=this._items[n].getActionById(e);if(i){break}}}}return i};Object.defineProperty(e.prototype,"padding",{get:function(){return this.getPadding()},set:function(t){this.setPadding(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectAction",{get:function(){return this.getSelectAction()},set:function(t){this.setSelectAction(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bleed",{get:function(){return this.getBleed()},set:function(t){this.setBleed(t)},enumerable:true,configurable:true});return e}(K);e.Container=tt;var et=function(t){n(e,t);function e(e){if(e===void 0){e="auto"}var i=t.call(this)||this;i._computedWeight=0;i.width="auto";i.width=e;return i}e.prototype.adjustRenderedElementSize=function(t){var e=20;if(this.isDesignMode()){t.style.minWidth="20px";t.style.minHeight=(!this.minPixelHeight?e:Math.max(this.minPixelHeight,e))+"px"}else{t.style.minWidth="0";if(this.minPixelHeight){t.style.minHeight=this.minPixelHeight+"px"}}if(this.width==="auto"){t.style.flex="0 1 auto"}else if(this.width==="stretch"){t.style.flex="1 1 50px"}else{var i=this.width;if(i.unit==r.SizeUnit.Pixel){t.style.flex="0 0 auto";t.style.width=i.physicalSize+"px"}else{t.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:i.physicalSize)+"%"}}};Object.defineProperty(e.prototype,"separatorOrientation",{get:function(){return r.Orientation.Vertical},enumerable:true,configurable:true});e.prototype.getJsonTypeName=function(){return"Column"};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(this.width instanceof o.SizeAndUnit){if(this.width.unit==r.SizeUnit.Pixel){s.setProperty(e,"width",this.width.physicalSize+"px")}else{s.setProperty(e,"width",this.width.physicalSize)}}else{s.setProperty(e,"width",this.width)}return e};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);var n=e["width"];if(n===undefined){n=e["size"];if(n!==undefined){ct({error:r.ValidationError.Deprecated,message:'The "Column.size" property is deprecated and will be removed. Use the "Column.width" property instead.'},i)}}if(n){var s=false;try{this.width=o.SizeAndUnit.parse(n)}catch(t){if(typeof n==="string"&&(n==="auto"||n==="stretch")){this.width=n}else{s=true}}if(s){ct({error:r.ValidationError.InvalidPropertyValue,message:"Invalid column width:"+n+' - defaulting to "auto"'},i)}}};Object.defineProperty(e.prototype,"hasVisibleSeparator",{get:function(){if(this.parent&&this.parent instanceof it){return this.separatorElement&&!this.parent.isLeftMostElement(this)}else{return false}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isStandalone",{get:function(){return false},enumerable:true,configurable:true});return e}(tt);e.Column=et;var it=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._columns=[];return e}e.prototype.createColumnInstance=function(t,e){return h(this,t,[],!this.isDesignMode(),function(t){return!t||t==="Column"?new et:null},function(t,e){if(e==c.UnknownType){return{error:r.ValidationError.UnknownElementType,message:"Unknown element type: "+t+". Fallback will be used if present."}}else{return{error:r.ValidationError.ElementTypeNotAllowed,message:"Element type "+t+" isn't allowed in a ColumnSet."}}},e)};e.prototype.internalRender=function(){this._renderedColumns=[];if(this._columns.length>0){var t=this.hostConfig;var e=document.createElement("div");e.className=t.makeCssClassName("ac-columnSet");e.style.display="flex";if(yt.useAdvancedCardBottomTruncation){e.style.minHeight="-webkit-min-content"}switch(this.horizontalAlignment){case r.HorizontalAlignment.Center:e.style.justifyContent="center";break;case r.HorizontalAlignment.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start";break}var i=0;for(var n=0,a=this._columns;n<a.length;n++){var l=a[n];if(l.width instanceof o.SizeAndUnit&&l.width.unit==r.SizeUnit.Weight){i+=l.width.physicalSize}}for(var u=0,p=this._columns;u<p.length;u++){var l=p[u];if(l.width instanceof o.SizeAndUnit&&l.width.unit==r.SizeUnit.Weight&&i>0){var c=100/i*l.width.physicalSize;l["_computedWeight"]=c}var h=l.render();if(h){if(this._renderedColumns.length>0&&l.separatorElement){l.separatorElement.style.flex="0 0 auto";s.appendChild(e,l.separatorElement)}s.appendChild(e,h);this._renderedColumns.push(l)}}return this._renderedColumns.length>0?e:null}else{return null}};e.prototype.truncateOverflow=function(t){for(var e=0,i=this._columns;e<i.length;e++){var n=i[e];n["handleOverflow"](t)}return true};e.prototype.undoOverflowTruncation=function(){for(var t=0,e=this._columns;t<e.length;t++){var i=e[t];i["resetOverflow"]()}};Object.defineProperty(e.prototype,"isSelectable",{get:function(){return true},enumerable:true,configurable:true});e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(this._columns.length>0){var i=[];for(var n=0,r=this._columns;n<r.length;n++){var o=r[n];i.push(o.toJSON())}s.setProperty(e,"columns",i)}s.setProperty(e,"bleed",this.bleed,false);return e};e.prototype.isFirstElement=function(t){for(var e=0;e<this._columns.length;e++){if(this._columns[e].isVisible){return this._columns[e]==t}}return false};e.prototype.isBleedingAtTop=function(){if(this.isBleeding()){return true}if(this._renderedColumns&&this._renderedColumns.length>0){for(var t=0,e=this._columns;t<e.length;t++){var i=e[t];if(i.isBleedingAtTop()){return true}}}return false};e.prototype.isBleedingAtBottom=function(){if(this.isBleeding()){return true}if(this._renderedColumns&&this._renderedColumns.length>0){for(var t=0,e=this._columns;t<e.length;t++){var i=e[t];if(i.isBleedingAtBottom()){return true}}}return false};e.prototype.getCount=function(){return this._columns.length};e.prototype.getItemCount=function(){return this.getCount()};e.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0){return this._renderedColumns[0]}else{return null}};e.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0){return this._renderedColumns[this._renderedColumns.length-1]}else{return null}};e.prototype.getColumnAt=function(t){return this._columns[t]};e.prototype.getItemAt=function(t){return this.getColumnAt(t)};e.prototype.getJsonTypeName=function(){return"ColumnSet"};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);if(e["columns"]!=null){var n=e["columns"];this._columns=[];for(var r=0;r<n.length;r++){var o=this.createColumnInstance(n[r],i);this._columns.push(o)}}this.bleed=s.getBoolValue(e["bleed"],this.bleed)};e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);var i=0;var n=0;for(var o=0,s=this._columns;o<s.length;o++){var a=s[o];if(typeof a.width==="number"){i++}else if(a.width==="stretch"){n++}}if(i>0&&n>0){e.addFailure(this,{error:r.ValidationError.Hint,message:"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."})}};e.prototype.addColumn=function(t){if(!t.parent){this._columns.push(t);t.setParent(this)}else{throw new Error("This column already belongs to another ColumnSet.")}};e.prototype.removeItem=function(t){if(t instanceof et){var e=this._columns.indexOf(t);if(e>=0){this._columns.splice(e,1);t.setParent(null);this.updateLayout();return true}}return false};e.prototype.indexOf=function(t){return t instanceof et?this._columns.indexOf(t):-1};e.prototype.isLeftMostElement=function(t){return this._columns.indexOf(t)==0};e.prototype.isRightMostElement=function(t){return this._columns.indexOf(t)==this._columns.length-1};e.prototype.isTopElement=function(t){return this._columns.indexOf(t)>=0};e.prototype.isBottomElement=function(t){return this._columns.indexOf(t)>=0};e.prototype.getActionById=function(t){var e=null;for(var i=0;i<this._columns.length;i++){e=this._columns[i].getActionById(t);if(e){break}}return e};Object.defineProperty(e.prototype,"bleed",{get:function(){return this.getBleed()},set:function(t){this.setBleed(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"padding",{get:function(){return this.getPadding()},set:function(t){this.setPadding(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectAction",{get:function(){return this.getSelectAction()},set:function(t){this.setSelectAction(t)},enumerable:true,configurable:true});return e}(K);e.ColumnSet=it;function nt(t){var e=t.getRootElement();var i=e&&e.onImageLoaded?e.onImageLoaded:yt.onImageLoaded;if(i){i(t)}}function rt(t,e){var i=t.getRootElement();var n=i&&i.onAnchorClicked?i.onAnchorClicked:yt.onAnchorClicked;return n!=null?n(t,e):false}function ot(t){var e=t.parent.getRootElement();var i=e&&e.onExecuteAction?e.onExecuteAction:yt.onExecuteAction;if(i){if(t.prepareForExecution()){i(t)}}}function st(t,e){var i=t.parent.getRootElement();var n=i&&i.onInlineCardExpanded?i.onInlineCardExpanded:yt.onInlineCardExpanded;if(n){n(t,e)}}function at(t){var e=t.getRootElement();var i=e&&e.onInputValueChanged?e.onInputValueChanged:yt.onInputValueChanged;if(i){i(t)}}function lt(t,e){if(e===void 0){e=true}var i=t.getRootElement();if(e){i.updateLayout()}var n=i;var r=n&&n.onElementVisibilityChanged?n.onElementVisibilityChanged:yt.onElementVisibilityChanged;if(r!=null){r(t)}}function ut(t,e,i){var n=t.getRootElement();var r=n&&n.onParseElement?n.onParseElement:yt.onParseElement;if(r!=null){r(t,e,i)}}function pt(t,e,i){var n=t.parent?t.parent.getRootElement():null;var r=n&&n.onParseAction?n.onParseAction:yt.onParseAction;if(r!=null){r(t,e,i)}}function ct(t,e){if(e){e.push(t)}if(yt.onParseError!=null){yt.onParseError(t)}}var ht=function(t){n(e,t);function e(){var e=t.call(this)||this;e._actionCollection=new Y(e);return e}e.prototype.internalRender=function(){var e=t.prototype.internalRender.call(this);var i=this._actionCollection.render(this.hostConfig.actions.actionsOrientation,false);if(i){s.appendChild(e,s.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing),lineThickness:null,lineColor:null},r.Orientation.Horizontal));s.appendChild(e,i)}if(this.renderIfEmpty){return e}else{return e.children.length>0?e:null}};e.prototype.getHasExpandedAction=function(){if(this.renderedActionCount==0){return false}else if(this.renderedActionCount==1){return this._actionCollection.expandedAction!=null&&!this.hostConfig.actions.preExpandSingleShowCardAction}else{return this._actionCollection.expandedAction!=null}};Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"renderIfEmpty",{get:function(){return false},enumerable:true,configurable:true});e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"actions",this._actionCollection.toJSON());return e};e.prototype.getActionCount=function(){return this._actionCollection.items.length};e.prototype.getActionAt=function(e){if(e>=0&&e<this.getActionCount()){return this._actionCollection.items[e]}else{t.prototype.getActionAt.call(this,e)}};e.prototype.getActionById=function(e){var i=this._actionCollection.getActionById(e);return i?i:t.prototype.getActionById.call(this,e)};e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);this._actionCollection.parse(e["actions"],i)};e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);if(this._actionCollection){this._actionCollection.validateProperties(e)}};e.prototype.isLastElement=function(e){return t.prototype.isLastElement.call(this,e)&&this._actionCollection.items.length==0};e.prototype.addAction=function(t){this._actionCollection.addAction(t)};e.prototype.clear=function(){t.prototype.clear.call(this);this._actionCollection.clear()};e.prototype.getAllInputs=function(){return t.prototype.getAllInputs.call(this).concat(this._actionCollection.getAllInputs())};e.prototype.getResourceInformation=function(){return t.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation())};e.prototype.isBleedingAtBottom=function(){if(this._actionCollection.renderedActionCount==0){return t.prototype.isBleedingAtBottom.call(this)}else{if(this._actionCollection.items.length==1){return this._actionCollection.expandedAction!=null&&!this.hostConfig.actions.preExpandSingleShowCardAction}else{return this._actionCollection.expandedAction!=null}}};Object.defineProperty(e.prototype,"isStandalone",{get:function(){return false},enumerable:true,configurable:true});return e}(tt);e.ContainerWithActions=ht;var ft=function(){function t(){this._items=[];this.reset()}t.prototype.findTypeRegistration=function(t){for(var e=0;e<this._items.length;e++){if(this._items[e].typeName===t){return this._items[e]}}return null};t.prototype.clear=function(){this._items=[]};t.prototype.registerType=function(t,e){var i=this.findTypeRegistration(t);if(i!=null){i.createInstance=e}else{i={typeName:t,createInstance:e};this._items.push(i)}};t.prototype.unregisterType=function(t){for(var e=0;e<this._items.length;e++){if(this._items[e].typeName===t){this._items.splice(e,1);return}}};t.prototype.createInstance=function(t){var e=this.findTypeRegistration(t);return e?e.createInstance():null};t.prototype.getItemCount=function(){return this._items.length};t.prototype.getItemAt=function(t){return this._items[t]};return t}();e.TypeRegistry=ft;var dt=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.reset=function(){this.clear();this.registerType("Container",function(){return new tt});this.registerType("TextBlock",function(){return new S});this.registerType("RichTextBlock",function(){return new x});this.registerType("TextRun",function(){return new E});this.registerType("Image",function(){return new I});this.registerType("ImageSet",function(){return new P});this.registerType("Media",function(){return new k});this.registerType("FactSet",function(){return new w});this.registerType("ColumnSet",function(){return new it});this.registerType("ActionSet",function(){return new Z});this.registerType("Input.Text",function(){return new z});this.registerType("Input.Date",function(){return new L});this.registerType("Input.Time",function(){return new R});this.registerType("Input.Number",function(){return new B});this.registerType("Input.ChoiceSet",function(){return new M});this.registerType("Input.Toggle",function(){return new D})};return e}(ft);e.ElementTypeRegistry=dt;var gt=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.reset=function(){this.clear();this.registerType(U.JsonTypeName,function(){return new U});this.registerType(W.JsonTypeName,function(){return new W});this.registerType($.JsonTypeName,function(){return new $});this.registerType(q.JsonTypeName,function(){return new q})};return e}(ft);e.ActionTypeRegistry=gt;var yt=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e._cardTypeName="AdaptiveCard";e._fallbackCard=null;e.onAnchorClicked=null;e.onExecuteAction=null;e.onElementVisibilityChanged=null;e.onImageLoaded=null;e.onInlineCardExpanded=null;e.onInputValueChanged=null;e.onParseElement=null;e.onParseAction=null;e.version=new a.Version(1,0);e.designMode=false;return e}Object.defineProperty(e,"processMarkdown",{get:function(){throw new Error("The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.")},set:function(t){throw new Error("The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.")},enumerable:true,configurable:true});e.applyMarkdown=function(t){var i={didProcess:false};if(e.onProcessMarkdown){e.onProcessMarkdown(t,i)}else if(window["markdownit"]){i.outputHtml=window["markdownit"]().render(t);i.didProcess=true}else{console.warn("Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown")}return i};e.prototype.isVersionSupported=function(){if(this.bypassVersionCheck){return true}else{var t=!this.version||!this.version.isValid||e.currentVersion.major<this.version.major||e.currentVersion.major==this.version.major&&e.currentVersion.minor<this.version.minor;return!t}};e.prototype.getItemsCollectionPropertyName=function(){return"body"};e.prototype.internalRender=function(){var i=t.prototype.internalRender.call(this);if(e.useAdvancedCardBottomTruncation){i.style.minHeight=null}return i};e.prototype.getHasBackground=function(){return true};e.prototype.getDefaultPadding=function(){return new o.PaddingDefinition(r.Spacing.Padding,r.Spacing.Padding,r.Spacing.Padding,r.Spacing.Padding)};Object.defineProperty(e.prototype,"renderIfEmpty",{get:function(){return true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bypassVersionCheck",{get:function(){return false},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"hasBackground",{get:function(){return true},enumerable:true,configurable:true});e.prototype.getJsonTypeName=function(){return"AdaptiveCard"};e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);s.setProperty(e,"$schema","http://adaptivecards.io/schemas/adaptive-card.json");if(!this.bypassVersionCheck&&this.version){s.setProperty(e,"version",this.version.toString())}s.setProperty(e,"fallbackText",this.fallbackText);s.setProperty(e,"lang",this.lang);s.setProperty(e,"speak",this.speak);return e};e.prototype.internalValidateProperties=function(i){t.prototype.internalValidateProperties.call(this,i);if(this._cardTypeName!="AdaptiveCard"){i.addFailure(this,{error:r.ValidationError.MissingCardType,message:'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'})}if(!this.bypassVersionCheck&&!this.version){i.addFailure(this,{error:r.ValidationError.PropertyCantBeNull,message:"The version property must be specified."})}else if(!this.isVersionSupported()){i.addFailure(this,{error:r.ValidationError.UnsupportedCardVersion,message:"The specified card version ("+this.version+") is not supported. The maximum supported card version is "+e.currentVersion})}};e.prototype.parse=function(i,n){this._fallbackCard=null;this._cardTypeName=s.getStringValue(i["type"]);this.speak=s.getStringValue(i["speak"]);var o=s.getStringValue(i["lang"]);if(o&&typeof o==="string"){try{this.lang=o}catch(t){ct({error:r.ValidationError.InvalidPropertyValue,message:t.message},n)}}this.version=a.Version.parse(i["version"],n);this.fallbackText=s.getStringValue(i["fallbackText"]);var l=d(null,i["fallback"],!this.isDesignMode(),n);if(l){this._fallbackCard=new e;this._fallbackCard.addItem(l)}t.prototype.parse.call(this,i,n)};e.prototype.render=function(e){var i;if(this.shouldFallback()&&this._fallbackCard){this._fallbackCard.hostConfig=this.hostConfig;i=this._fallbackCard.render()}else{i=t.prototype.render.call(this);if(i){i.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard"));i.tabIndex=0;if(!s.isNullOrEmpty(this.speak)){i.setAttribute("aria-label",this.speak)}}}if(e){e.appendChild(i);this.updateLayout()}return i};e.prototype.updateLayout=function(i){if(i===void 0){i=true}t.prototype.updateLayout.call(this,i);if(e.useAdvancedCardBottomTruncation&&this.isRendered()){var n=this.renderedElement;var o=this.hostConfig.getEffectiveSpacing(r.Spacing.Default);this["handleOverflow"](n.offsetHeight-o)}};e.prototype.shouldFallback=function(){return t.prototype.shouldFallback.call(this)||!this.isVersionSupported()};Object.defineProperty(e.prototype,"hasVisibleSeparator",{get:function(){return false},enumerable:true,configurable:true});e.currentVersion=new a.Version(1,2);e.useAdvancedTextBlockTruncation=true;e.useAdvancedCardBottomTruncation=false;e.useMarkdownInRadioButtonAndCheckbox=true;e.allowMarkForTextHighlighting=false;e.alwaysBleedSeparators=false;e.enableFullJsonRoundTrip=false;e.useBuiltInInputValidation=true;e.displayInputValidationErrors=true;e.elementTypeRegistry=new dt;e.actionTypeRegistry=new gt;e.onAnchorClicked=null;e.onExecuteAction=null;e.onElementVisibilityChanged=null;e.onImageLoaded=null;e.onInlineCardExpanded=null;e.onInputValueChanged=null;e.onParseElement=null;e.onParseAction=null;e.onParseError=null;e.onProcessMarkdown=null;return e}(ht);e.AdaptiveCard=yt;var mt=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.suppressStyle=false;return e}e.prototype.getDefaultPadding=function(){return new o.PaddingDefinition(this.suppressStyle?r.Spacing.None:r.Spacing.Padding,r.Spacing.Padding,this.suppressStyle?r.Spacing.None:r.Spacing.Padding,r.Spacing.Padding)};Object.defineProperty(e.prototype,"bypassVersionCheck",{get:function(){return true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"defaultStyle",{get:function(){if(this.suppressStyle){return r.ContainerStyle.Default}else{return this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:r.ContainerStyle.Emphasis}},enumerable:true,configurable:true});e.prototype.render=function(e){var i=t.prototype.render.call(this,e);i.setAttribute("aria-live","polite");i.removeAttribute("tabindex");return i};e.prototype.getForbiddenActionTypes=function(){return[$]};return e}(yt);var vt=new a.HostConfig({supportsInteractivity:true,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},actions:{maxActions:5,spacing:r.Spacing.Default,buttonSpacing:10,showCard:{actionMode:r.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:r.Orientation.Horizontal,actionAlignment:r.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:false},imageSet:{imageSize:r.Size.Medium,maxImageHeight:100},factSet:{title:{color:r.TextColor.Default,size:r.TextSize.Default,isSubtle:false,weight:r.TextWeight.Bolder,wrap:true,maxWidth:150},value:{color:r.TextColor.Default,size:r.TextSize.Default,isSubtle:false,weight:r.TextWeight.Default,wrap:true},spacing:10}})},"./src/enums.ts":function(t,e,i){"use strict";
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
Object.defineProperty(e,"__esModule",{value:true});var n=function(){function t(){}t.Default="default";t.Positive="positive";t.Destructive="destructive";return t}();e.ActionStyle=n;var r;(function(t){t[t["Auto"]=0]="Auto";t[t["Stretch"]=1]="Stretch";t[t["Small"]=2]="Small";t[t["Medium"]=3]="Medium";t[t["Large"]=4]="Large"})(r=e.Size||(e.Size={}));var o;(function(t){t[t["Weight"]=0]="Weight";t[t["Pixel"]=1]="Pixel"})(o=e.SizeUnit||(e.SizeUnit={}));var s;(function(t){t[t["Small"]=0]="Small";t[t["Default"]=1]="Default";t[t["Medium"]=2]="Medium";t[t["Large"]=3]="Large";t[t["ExtraLarge"]=4]="ExtraLarge"})(s=e.TextSize||(e.TextSize={}));var a;(function(t){t[t["Lighter"]=0]="Lighter";t[t["Default"]=1]="Default";t[t["Bolder"]=2]="Bolder"})(a=e.TextWeight||(e.TextWeight={}));var l;(function(t){t[t["Default"]=0]="Default";t[t["Monospace"]=1]="Monospace"})(l=e.FontType||(e.FontType={}));var u;(function(t){t[t["None"]=0]="None";t[t["Small"]=1]="Small";t[t["Default"]=2]="Default";t[t["Medium"]=3]="Medium";t[t["Large"]=4]="Large";t[t["ExtraLarge"]=5]="ExtraLarge";t[t["Padding"]=6]="Padding"})(u=e.Spacing||(e.Spacing={}));var p;(function(t){t[t["Default"]=0]="Default";t[t["Dark"]=1]="Dark";t[t["Light"]=2]="Light";t[t["Accent"]=3]="Accent";t[t["Good"]=4]="Good";t[t["Warning"]=5]="Warning";t[t["Attention"]=6]="Attention"})(p=e.TextColor||(e.TextColor={}));var c;(function(t){t[t["Left"]=0]="Left";t[t["Center"]=1]="Center";t[t["Right"]=2]="Right"})(c=e.HorizontalAlignment||(e.HorizontalAlignment={}));var h;(function(t){t[t["Top"]=0]="Top";t[t["Center"]=1]="Center";t[t["Bottom"]=2]="Bottom"})(h=e.VerticalAlignment||(e.VerticalAlignment={}));var f;(function(t){t[t["Left"]=0]="Left";t[t["Center"]=1]="Center";t[t["Right"]=2]="Right";t[t["Stretch"]=3]="Stretch"})(f=e.ActionAlignment||(e.ActionAlignment={}));var d;(function(t){t[t["Default"]=0]="Default";t[t["Person"]=1]="Person"})(d=e.ImageStyle||(e.ImageStyle={}));var g;(function(t){t[t["Inline"]=0]="Inline";t[t["Popup"]=1]="Popup"})(g=e.ShowCardActionMode||(e.ShowCardActionMode={}));var y;(function(t){t[t["Horizontal"]=0]="Horizontal";t[t["Vertical"]=1]="Vertical"})(y=e.Orientation||(e.Orientation={}));var m;(function(t){t[t["Cover"]=0]="Cover";t[t["RepeatHorizontally"]=1]="RepeatHorizontally";t[t["RepeatVertically"]=2]="RepeatVertically";t[t["Repeat"]=3]="Repeat"})(m=e.FillMode||(e.FillMode={}));var v;(function(t){t[t["LeftOfTitle"]=0]="LeftOfTitle";t[t["AboveTitle"]=1]="AboveTitle"})(v=e.ActionIconPlacement||(e.ActionIconPlacement={}));var b;(function(t){t[t["Text"]=0]="Text";t[t["Tel"]=1]="Tel";t[t["Url"]=2]="Url";t[t["Email"]=3]="Email"})(b=e.InputTextStyle||(e.InputTextStyle={}));var C;(function(t){t[t["Optional"]=0]="Optional";t[t["Required"]=1]="Required";t[t["RequiredWithVisualCue"]=2]="RequiredWithVisualCue"})(C=e.InputValidationNecessity||(e.InputValidationNecessity={}));var S=function(){function t(){}t.Default="default";t.Emphasis="emphasis";t.Accent="accent";t.Good="good";t.Attention="attention";t.Warning="warning";return t}();e.ContainerStyle=S;var _;(function(t){t[t["Hint"]=0]="Hint";t[t["ActionTypeNotAllowed"]=1]="ActionTypeNotAllowed";t[t["CollectionCantBeEmpty"]=2]="CollectionCantBeEmpty";t[t["Deprecated"]=3]="Deprecated";t[t["ElementTypeNotAllowed"]=4]="ElementTypeNotAllowed";t[t["InteractivityNotAllowed"]=5]="InteractivityNotAllowed";t[t["InvalidPropertyValue"]=6]="InvalidPropertyValue";t[t["MissingCardType"]=7]="MissingCardType";t[t["PropertyCantBeNull"]=8]="PropertyCantBeNull";t[t["TooManyActions"]=9]="TooManyActions";t[t["UnknownActionType"]=10]="UnknownActionType";t[t["UnknownElementType"]=11]="UnknownElementType";t[t["UnsupportedCardVersion"]=12]="UnsupportedCardVersion";t[t["DuplicateId"]=13]="DuplicateId"})(_=e.ValidationError||(e.ValidationError={}));var E;(function(t){t[t["FullyInContainer"]=0]="FullyInContainer";t[t["Overflowing"]=1]="Overflowing";t[t["FullyOutOfContainer"]=2]="FullyOutOfContainer"})(E=e.ContainerFitStatus||(e.ContainerFitStatus={}))},"./src/host-config.ts":function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:true});
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var r=i("./src/enums.ts");var o=i("./src/utils.ts");var s=i("./src/shared.ts");var a=function(){function t(t,e){this.default="#000000";this.subtle="#666666";if(t){this.default=t}if(e){this.subtle=e}}t.prototype.parse=function(t){if(t){this.default=t["default"]||this.default;this.subtle=t["subtle"]||this.subtle}};return t}();e.ColorDefinition=a;var l=function(t){n(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.highlightColors=new a("#22000000","#11000000");return e}e.prototype.parse=function(e){t.prototype.parse.call(this,e);if(e){this.highlightColors.parse(e["highlightColors"])}};return e}(a);e.TextColorDefinition=l;var u=function(){function t(t){this.allowCustomStyle=false;if(t){this.allowCustomStyle=t["allowCustomStyle"]||this.allowCustomStyle}}return t}();e.AdaptiveCardConfig=u;var p=function(){function t(t){this.imageSize=r.Size.Medium;this.maxImageHeight=100;if(t){this.imageSize=t["imageSize"]!=null?t["imageSize"]:this.imageSize;this.maxImageHeight=o.getNumberValue(t["maxImageHeight"],100)}}t.prototype.toJSON=function(){return{imageSize:r.Size[this.imageSize],maxImageHeight:this.maxImageHeight}};return t}();e.ImageSetConfig=p;var c=function(){function t(t){this.allowInlinePlayback=true;if(t){this.defaultPoster=t["defaultPoster"];this.allowInlinePlayback=t["allowInlinePlayback"]||this.allowInlinePlayback}}t.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}};return t}();e.MediaConfig=c;var h=function(){function t(t){this.size=r.TextSize.Default;this.color=r.TextColor.Default;this.isSubtle=false;this.weight=r.TextWeight.Default;this.wrap=true;if(t){this.size=o.parseHostConfigEnum(r.TextSize,t["size"],r.TextSize.Default);this.color=o.parseHostConfigEnum(r.TextColor,t["color"],r.TextColor.Default);this.isSubtle=t["isSubtle"]||this.isSubtle;this.weight=o.parseHostConfigEnum(r.TextWeight,t["weight"],this.getDefaultWeight());this.wrap=t["wrap"]!=null?t["wrap"]:this.wrap}}t.prototype.getDefaultWeight=function(){return r.TextWeight.Default};t.prototype.toJSON=function(){return{size:r.TextSize[this.size],color:r.TextColor[this.color],isSubtle:this.isSubtle,weight:r.TextWeight[this.weight],wrap:this.wrap}};return t}();e.FactTextDefinition=h;var f=function(t){n(e,t);function e(e){var i=t.call(this,e)||this;i.maxWidth=150;i.weight=r.TextWeight.Bolder;if(e){i.maxWidth=e["maxWidth"]!=null?e["maxWidth"]:i.maxWidth;i.weight=o.parseHostConfigEnum(r.TextWeight,e["weight"],r.TextWeight.Bolder)}return i}e.prototype.getDefaultWeight=function(){return r.TextWeight.Bolder};return e}(h);e.FactTitleDefinition=f;var d=function(){function t(t){this.title=new f;this.value=new h;this.spacing=10;if(t){this.title=new f(t["title"]);this.value=new h(t["value"]);this.spacing=t.spacing&&t.spacing!=null?t.spacing&&t.spacing:this.spacing}}return t}();e.FactSetConfig=d;var g=function(){function t(t){this.actionMode=r.ShowCardActionMode.Inline;this.inlineTopMargin=16;this.style=r.ContainerStyle.Emphasis;if(t){this.actionMode=o.parseHostConfigEnum(r.ShowCardActionMode,t["actionMode"],r.ShowCardActionMode.Inline);this.inlineTopMargin=t["inlineTopMargin"]!=null?t["inlineTopMargin"]:this.inlineTopMargin;this.style=t["style"]&&typeof t["style"]==="string"?t["style"]:r.ContainerStyle.Emphasis}}t.prototype.toJSON=function(){return{actionMode:r.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}};return t}();e.ShowCardActionConfig=g;var y=function(){function t(t){this.maxActions=5;this.spacing=r.Spacing.Default;this.buttonSpacing=20;this.showCard=new g;this.preExpandSingleShowCardAction=false;this.actionsOrientation=r.Orientation.Horizontal;this.actionAlignment=r.ActionAlignment.Left;this.iconPlacement=r.ActionIconPlacement.LeftOfTitle;this.allowTitleToWrap=false;this.iconSize=24;if(t){this.maxActions=t["maxActions"]!=null?t["maxActions"]:this.maxActions;this.spacing=o.parseHostConfigEnum(r.Spacing,t.spacing&&t.spacing,r.Spacing.Default);this.buttonSpacing=t["buttonSpacing"]!=null?t["buttonSpacing"]:this.buttonSpacing;this.showCard=new g(t["showCard"]);this.preExpandSingleShowCardAction=o.getBoolValue(t["preExpandSingleShowCardAction"],false);this.actionsOrientation=o.parseHostConfigEnum(r.Orientation,t["actionsOrientation"],r.Orientation.Horizontal);this.actionAlignment=o.parseHostConfigEnum(r.ActionAlignment,t["actionAlignment"],r.ActionAlignment.Left);this.iconPlacement=o.parseHostConfigEnum(r.ActionIconPlacement,t["iconPlacement"],r.ActionIconPlacement.LeftOfTitle);this.allowTitleToWrap=t["allowTitleToWrap"]!=null?t["allowTitleToWrap"]:this.allowTitleToWrap;try{var e=s.SizeAndUnit.parse(t["iconSize"]);if(e.unit==r.SizeUnit.Pixel){this.iconSize=e.physicalSize}}catch(t){}}}t.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:r.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:r.Orientation[this.actionsOrientation],actionAlignment:r.ActionAlignment[this.actionAlignment]}};return t}();e.ActionsConfig=y;var m=function(){function t(t){this.default=new l;this.dark=new l;this.light=new l;this.accent=new l;this.good=new l;this.warning=new l;this.attention=new l;this.parse(t)}t.prototype.parseSingleColor=function(t,e){if(t){this[e].parse(t[e])}};t.prototype.parse=function(t){if(t){this.parseSingleColor(t,"default");this.parseSingleColor(t,"dark");this.parseSingleColor(t,"light");this.parseSingleColor(t,"accent");this.parseSingleColor(t,"good");this.parseSingleColor(t,"warning");this.parseSingleColor(t,"attention")}};return t}();e.ColorSetDefinition=m;var v=function(){function t(t){this.foregroundColors=new m({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#54A254",subtle:"#DD54A254"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}});this.parse(t)}t.prototype.parse=function(t){if(t){this.backgroundColor=t["backgroundColor"];this.foregroundColors.parse(t["foregroundColors"]);this.highlightBackgroundColor=t["highlightBackgroundColor"];this.highlightForegroundColor=t["highlightForegroundColor"]}};Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return false},enumerable:true,configurable:true});return t}();e.ContainerStyleDefinition=v;var b=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return true},enumerable:true,configurable:true});return e}(v);var C=function(){function t(t){this._allStyles={};this._allStyles[r.ContainerStyle.Default]=new b;this._allStyles[r.ContainerStyle.Emphasis]=new b;this._allStyles[r.ContainerStyle.Accent]=new b;this._allStyles[r.ContainerStyle.Good]=new b;this._allStyles[r.ContainerStyle.Attention]=new b;this._allStyles[r.ContainerStyle.Warning]=new b;if(t){this._allStyles[r.ContainerStyle.Default].parse(t[r.ContainerStyle.Default]);this._allStyles[r.ContainerStyle.Emphasis].parse(t[r.ContainerStyle.Emphasis]);this._allStyles[r.ContainerStyle.Accent].parse(t[r.ContainerStyle.Accent]);this._allStyles[r.ContainerStyle.Good].parse(t[r.ContainerStyle.Good]);this._allStyles[r.ContainerStyle.Attention].parse(t[r.ContainerStyle.Attention]);this._allStyles[r.ContainerStyle.Warning].parse(t[r.ContainerStyle.Warning]);var e=t["customStyles"];if(e&&Array.isArray(e)){for(var i=0,n=e;i<n.length;i++){var o=n[i];if(o){var s=o["name"];if(s&&typeof s==="string"){if(this._allStyles.hasOwnProperty(s)){this._allStyles[s].parse(o["style"])}else{this._allStyles[s]=new v(o["style"])}}}}}}}t.prototype.toJSON=function(){var t=this;var e=[];Object.keys(this._allStyles).forEach(function(i){if(!t._allStyles[i].isBuiltIn){e.push({name:i,style:t._allStyles[i]})}});var i={default:this.default,emphasis:this.emphasis};if(e.length>0){i.customStyles=e}return i};t.prototype.getStyleByName=function(t,e){if(e===void 0){e=null}return this._allStyles.hasOwnProperty(t)?this._allStyles[t]:e};Object.defineProperty(t.prototype,"default",{get:function(){return this._allStyles[r.ContainerStyle.Default]},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"emphasis",{get:function(){return this._allStyles[r.ContainerStyle.Emphasis]},enumerable:true,configurable:true});return t}();e.ContainerStyleSet=C;var S=function(){function t(t,e,i){if(t===void 0){t=1}if(e===void 0){e=1}this._isValid=true;this._major=t;this._minor=e;this._label=i}t.parse=function(e,i){if(!e){return null}var n=new t;n._versionString=e;var o=/(\d+).(\d+)/gi;var s=o.exec(e);if(s!=null&&s.length==3){n._major=parseInt(s[1]);n._minor=parseInt(s[2])}else{n._isValid=false}if(!n._isValid&&i){i.push({error:r.ValidationError.InvalidPropertyValue,message:"Invalid version string: "+n._versionString})}return n};t.prototype.toString=function(){return!this._isValid?this._versionString:this._major+"."+this._minor};t.prototype.compareTo=function(t){if(!this.isValid||!t.isValid){throw new Error("Cannot compare invalid version.")}if(this.major>t.major){return 1}else if(this.major<t.major){return-1}else if(this.minor>t.minor){return 1}else if(this.minor<t.minor){return-1}return 0};Object.defineProperty(t.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"major",{get:function(){return this._major},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"minor",{get:function(){return this._minor},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"isValid",{get:function(){return this._isValid},enumerable:true,configurable:true});return t}();e.Version=S;var _=function(){function t(){this.capabilities=null}t.prototype.setCapability=function(t,e){if(!this.capabilities){this.capabilities={}}this.capabilities[t]=e};t.prototype.parse=function(t,e){if(t){for(var i in t){var n=t[i];if(typeof n==="string"){if(n=="*"){this.setCapability(i,"*")}else{var r=S.parse(n,e);if(r.isValid){this.setCapability(i,r)}}}}}};t.prototype.hasCapability=function(t,e){if(this.capabilities&&this.capabilities.hasOwnProperty(t)){if(e=="*"||this.capabilities[t]=="*"){return true}return e.compareTo(this.capabilities[t])<=0}return false};t.prototype.areAllMet=function(t){if(this.capabilities){for(var e in this.capabilities){if(!t.hasCapability(e,this.capabilities[e])){return false}}}return true};return t}();e.HostCapabilities=_;var E=function(){function t(t){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif";this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26};this.fontWeights={lighter:200,default:400,bolder:600};if(t){this.fontFamily=t}}t.prototype.parse=function(t){this.fontFamily=t["fontFamily"]||this.fontFamily;this.fontSizes={small:t.fontSizes&&t.fontSizes["small"]||this.fontSizes.small,default:t.fontSizes&&t.fontSizes["default"]||this.fontSizes.default,medium:t.fontSizes&&t.fontSizes["medium"]||this.fontSizes.medium,large:t.fontSizes&&t.fontSizes["large"]||this.fontSizes.large,extraLarge:t.fontSizes&&t.fontSizes["extraLarge"]||this.fontSizes.extraLarge};this.fontWeights={lighter:t.fontWeights&&t.fontWeights["lighter"]||this.fontWeights.lighter,default:t.fontWeights&&t.fontWeights["default"]||this.fontWeights.default,bolder:t.fontWeights&&t.fontWeights["bolder"]||this.fontWeights.bolder}};t.monospace=new t("'Courier New', Courier, monospace");return t}();e.FontTypeDefinition=E;var x=function(){function t(t){this.default=new E;this.monospace=new E("'Courier New', Courier, monospace");if(t){this.default.parse(t["default"]);this.monospace.parse(t["monospace"])}}t.prototype.getStyleDefinition=function(t){switch(t){case r.FontType.Monospace:return this.monospace;case r.FontType.Default:default:return this.default}};return t}();e.FontTypeSet=x;var A=function(){function t(t){this.hostCapabilities=new _;this.choiceSetInputValueSeparator=",";this.supportsInteractivity=true;this.fontTypes=null;this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15};this.separator={lineThickness:1,lineColor:"#EEEEEE"};this.imageSizes={small:40,medium:80,large:160};this.containerStyles=new C;this.actions=new y;this.adaptiveCard=new u;this.imageSet=new p;this.media=new c;this.factSet=new d;this.cssClassNamePrefix=null;this.alwaysAllowBleed=false;if(t){if(typeof t==="string"||t instanceof String){t=JSON.parse(t)}this.choiceSetInputValueSeparator=t&&typeof t["choiceSetInputValueSeparator"]==="string"?t["choiceSetInputValueSeparator"]:this.choiceSetInputValueSeparator;this.supportsInteractivity=t&&typeof t["supportsInteractivity"]==="boolean"?t["supportsInteractivity"]:this.supportsInteractivity;this._legacyFontType=new E;this._legacyFontType.parse(t);if(t.fontTypes){this.fontTypes=new x(t.fontTypes)}if(t.lineHeights){this.lineHeights={small:t.lineHeights["small"],default:t.lineHeights["default"],medium:t.lineHeights["medium"],large:t.lineHeights["large"],extraLarge:t.lineHeights["extraLarge"]}}this.imageSizes={small:t.imageSizes&&t.imageSizes["small"]||this.imageSizes.small,medium:t.imageSizes&&t.imageSizes["medium"]||this.imageSizes.medium,large:t.imageSizes&&t.imageSizes["large"]||this.imageSizes.large};this.containerStyles=new C(t["containerStyles"]);this.spacing={small:t.spacing&&t.spacing["small"]||this.spacing.small,default:t.spacing&&t.spacing["default"]||this.spacing.default,medium:t.spacing&&t.spacing["medium"]||this.spacing.medium,large:t.spacing&&t.spacing["large"]||this.spacing.large,extraLarge:t.spacing&&t.spacing["extraLarge"]||this.spacing.extraLarge,padding:t.spacing&&t.spacing["padding"]||this.spacing.padding};this.separator={lineThickness:t.separator&&t.separator["lineThickness"]||this.separator.lineThickness,lineColor:t.separator&&t.separator["lineColor"]||this.separator.lineColor};this.actions=new y(t.actions||this.actions);this.adaptiveCard=new u(t.adaptiveCard||this.adaptiveCard);this.imageSet=new p(t["imageSet"]);this.factSet=new d(t["factSet"])}}t.prototype.getFontTypeDefinition=function(t){if(this.fontTypes){return this.fontTypes.getStyleDefinition(t)}else{return t==r.FontType.Monospace?E.monospace:this._legacyFontType}};t.prototype.getEffectiveSpacing=function(t){switch(t){case r.Spacing.Small:return this.spacing.small;case r.Spacing.Default:return this.spacing.default;case r.Spacing.Medium:return this.spacing.medium;case r.Spacing.Large:return this.spacing.large;case r.Spacing.ExtraLarge:return this.spacing.extraLarge;case r.Spacing.Padding:return this.spacing.padding;default:return 0}};t.prototype.paddingDefinitionToSpacingDefinition=function(t){return new s.SpacingDefinition(this.getEffectiveSpacing(t.top),this.getEffectiveSpacing(t.right),this.getEffectiveSpacing(t.bottom),this.getEffectiveSpacing(t.left))};t.prototype.makeCssClassNames=function(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}var i=[];for(var n=0,r=t;n<r.length;n++){var o=r[n];i.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+o)}return i};t.prototype.makeCssClassName=function(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}var i=this.makeCssClassNames.apply(this,t).join(" ");return i?i:""};Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(t){this._legacyFontType.fontFamily=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:true,configurable:true});return t}();e.HostConfig=A},"./src/shared.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:true});
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var n=i("./src/enums.ts");e.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var r=function(){function t(){this._isProcessed=false;this._original=null;this._processed=null}t.prototype.getReferencedInputs=function(t,e){if(!e){throw new Error("The referencedInputs parameter cannot be null.")}for(var i=0,n=t;i<n.length;i++){var r=n[i];var o=new RegExp("\\{{2}("+r.id+").value\\}{2}","gi").exec(this._original);if(o!=null){e[r.id]=r}}};t.prototype.substituteInputValues=function(t,i){this._processed=this._original;var n=/\{{2}([a-z0-9_$@]+).value\}{2}/gi;var r;while((r=n.exec(this._original))!=null){var o=null;for(var s=0,a=Object.keys(t);s<a.length;s++){var l=a[s];if(l.toLowerCase()==r[1].toLowerCase()){o=t[l];break}}if(o){var u="";if(o.value){u=o.value}if(i===e.ContentTypes.applicationJson){u=JSON.stringify(u);u=u.slice(1,-1)}else if(i===e.ContentTypes.applicationXWwwFormUrlencoded){u=encodeURIComponent(u)}this._processed=this._processed.replace(r[0],u)}}this._isProcessed=true};t.prototype.getOriginal=function(){return this._original};t.prototype.get=function(){if(!this._isProcessed){return this._original}else{return this._processed}};t.prototype.set=function(t){this._original=t;this._isProcessed=false};return t}();e.StringWithSubstitutions=r;var o=function(){function t(t,e,i,n){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(n===void 0){n=0}this.left=0;this.top=0;this.right=0;this.bottom=0;this.top=t;this.right=e;this.bottom=i;this.left=n}return t}();e.SpacingDefinition=o;var s=function(){function t(t,e,i,r){if(t===void 0){t=n.Spacing.None}if(e===void 0){e=n.Spacing.None}if(i===void 0){i=n.Spacing.None}if(r===void 0){r=n.Spacing.None}this.top=n.Spacing.None;this.right=n.Spacing.None;this.bottom=n.Spacing.None;this.left=n.Spacing.None;this.top=t;this.right=e;this.bottom=i;this.left=r}return t}();e.PaddingDefinition=s;var a=function(){function t(t,e){this.physicalSize=t;this.unit=e}t.parse=function(e,i){if(i===void 0){i=false}var r=new t(0,n.SizeUnit.Weight);var o=/^([0-9]+)(px|\*)?$/g;var s=o.exec(e);var a=i?3:2;if(s&&s.length>=a){r.physicalSize=parseInt(s[1]);if(s.length==3){if(s[2]=="px"){r.unit=n.SizeUnit.Pixel}}return r}throw new Error("Invalid size: "+e)};return t}();e.SizeAndUnit=a;
/**
				 * Fast UUID generator, RFC4122 version 4 compliant.
				 * @author Jeff Ward (jcward.com).
				 * @license MIT license
				 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
				 **/var l=function(){function t(){}t.generate=function(){var e=Math.random()*4294967295|0;var i=Math.random()*4294967295|0;var n=Math.random()*4294967295|0;var r=Math.random()*4294967295|0;return t.lut[e&255]+t.lut[e>>8&255]+t.lut[e>>16&255]+t.lut[e>>24&255]+"-"+t.lut[i&255]+t.lut[i>>8&255]+"-"+t.lut[i>>16&15|64]+t.lut[i>>24&255]+"-"+t.lut[n&63|128]+t.lut[n>>8&255]+"-"+t.lut[n>>16&255]+t.lut[n>>24&255]+t.lut[r&255]+t.lut[r>>8&255]+t.lut[r>>16&255]+t.lut[r>>24&255]};t.initialize=function(){for(var e=0;e<256;e++){t.lut[e]=(e<16?"0":"")+e.toString(16)}};t.lut=[];return t}();e.UUID=l;l.initialize()},"./src/text-formatters.ts":function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function n(){this.constructor=e}e.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:true});
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var r=function(){function t(t){this._regularExpression=t}t.prototype.format=function(t,e){var i;var n=e;while((i=this._regularExpression.exec(e))!=null){n=n.replace(i[0],this.internalFormat(t,i))}return n};return t}();var o=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.internalFormat=function(t,e){var i=new Date(Date.parse(e[1]));var n=e[2]!=undefined?e[2].toLowerCase():"compact";if(n!="compact"){return i.toLocaleDateString(t,{day:"numeric",weekday:n,month:n,year:"numeric"})}else{return i.toLocaleDateString()}};return e}(r);var s=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.internalFormat=function(t,e){var i=new Date(Date.parse(e[1]));return i.toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"})};return e}(r);function a(t,e){var i=[new o(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new s(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];var n=e;for(var r=0;r<i.length;r++){n=i[r].format(t,n)}return n}e.formatText=a},"./src/utils.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:true});
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var n=i("./src/enums.ts");var r=i("./src/shared.ts");function o(){return"__ac-"+r.UUID.generate()}e.generateUniqueId=o;function s(t){return t===undefined||t===null||t===""}e.isNullOrEmpty=s;function a(t,e){if(e!=null&&e!=undefined){t.appendChild(e)}}e.appendChild=a;function l(t,e){if(e===void 0){e=undefined}return typeof t==="string"?t.toString():e}e.getStringValue=l;function u(t,e){if(e===void 0){e=undefined}return typeof t==="number"?t:e}e.getNumberValue=u;function p(t,e){if(typeof t==="boolean"){return t}else if(typeof t==="string"){switch(t.toLowerCase()){case"true":return true;case"false":return false;default:return e}}return e}e.getBoolValue=p;function c(t,e,i){if(s(e)){return i}for(var n in t){var r=parseInt(n,10)>=0;if(r){var o=t[n];if(o&&typeof o==="string"){if(o.toLowerCase()===e.toLowerCase()){return parseInt(n,10)}}}}return i}e.getEnumValue=c;function h(t,e,i,n){if(n===void 0){n=undefined}if(i===null||i===undefined||i===n){delete t[e]}else{t[e]=i}}e.setProperty=h;function f(t,e,i,n){if(n===void 0){n=undefined}if(i===null||i===undefined||i===n||isNaN(i)){delete t[e]}else{t[e]=i}}e.setNumberProperty=f;function d(t,e,i,n,r){if(r===void 0){r=undefined}var o=e[i];var s=o==undefined?true:t[o]!==undefined;if(n==r){if(s){delete e[i]}}else{if(n==undefined){if(s){delete e[i]}}else{e[i]=t[n]}}}e.setEnumProperty=d;function g(t,e,i){var n=[];if(i){for(var r=0,o=i;r<o.length;r++){var s=o[r];n.push(s.toJSON())}}if(n.length==0){if(t.hasOwnProperty(e)&&Array.isArray(t[e])){delete t[e]}}else{h(t,e,n)}}e.setArrayProperty=g;function y(t,e,i){if(typeof e==="string"){return c(t,e,i)}else if(typeof e==="number"){return e}else{return i}}e.parseHostConfigEnum=y;function m(t,e,i){if(e.spacing>0||e.lineThickness>0){var r=document.createElement("div");r.className=t.makeCssClassName("ac-"+(i==n.Orientation.Horizontal?"horizontal":"vertical")+"-separator");if(i==n.Orientation.Horizontal){if(e.lineThickness){r.style.paddingTop=e.spacing/2+"px";r.style.marginBottom=e.spacing/2+"px";r.style.borderBottom=e.lineThickness+"px solid "+v(e.lineColor)}else{r.style.height=e.spacing+"px"}}else{if(e.lineThickness){r.style.paddingLeft=e.spacing/2+"px";r.style.marginRight=e.spacing/2+"px";r.style.borderRight=e.lineThickness+"px solid "+v(e.lineColor)}else{r.style.width=e.spacing+"px"}}r.style.overflow="hidden";return r}else{return null}}e.renderSeparation=m;function v(t){var e=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi;var i=e.exec(t);if(i&&i[4]){var n=parseInt(i[1],16)/255;var r=parseInt(i[2],16);var o=parseInt(i[3],16);var s=parseInt(i[4],16);return"rgba("+r+","+o+","+s+","+n+")"}else{return t}}e.stringToCssColor=v;function b(t,e,i){var n=function(){return e-t.scrollHeight>=-1};if(n())return;var r=t.innerHTML;var o=function(e){t.innerHTML=r.substring(0,e)+"..."};var s=C(r);var a=0;var l=s.length;var u=0;while(a<l){var p=Math.floor((a+l)/2);o(s[p]);if(n()){u=s[p];a=p+1}else{l=p}}o(u);if(i&&e-t.scrollHeight>=i-1){var c=S(r,u);while(c<r.length){o(c);if(n()){u=c;c=S(r,c)}else{break}}o(u)}}e.truncate=b;function C(t){var e=[];var i=S(t,-1);while(i<t.length){if(t[i]==" "){e.push(i)}i=S(t,i)}return e}function S(t,e){e+=1;while(e<t.length&&t[e]=="<"){while(e<t.length&&t[e++]!=">");}return e}function _(t,e){var i=t.offsetTop;var r=i+t.clientHeight;if(r<=e){return n.ContainerFitStatus.FullyInContainer}else if(i<e){return n.ContainerFitStatus.Overflowing}else{return n.ContainerFitStatus.FullyOutOfContainer}}e.getFitStatus=_}})});