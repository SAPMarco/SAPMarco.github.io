/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/BindingParser","sap/base/util/extend","sap/ui/integration/formatters/DateTimeFormatter","sap/ui/integration/formatters/NumberFormatter","sap/ui/integration/bindingFeatures/DateRange"],function(e,t,r,a,n){"use strict";var i=/\{\{([^}]+)\}\}/g,o=/\{\{(parameters\.[^}]+)\}\}/g,f=/\{\{(dataSources\.[^}]+)\}\}/g;var u={};var s={date:r.date,dateTime:r.dateTime,currency:a.currency,float:a.float,integer:a.integer,percent:a.percent,unit:a.unit};u.DEFAULT_CARD_MODELS=["i18n","parameters","filters","context"];u.mLocals={format:s,dateRange:n};u.extractBindingInfo=function(r,a){r=u.escapeCardPlaceholders(r);return e.complexParser(r,undefined,true,undefined,undefined,undefined,t({},u.mLocals,a))};u.createBindingInfos=function(e,t){if(!e){return e}if(Array.isArray(e)){return e.map(function(e){return u.createBindingInfos(e,t)})}if(typeof e==="object"){var r={};for(var a in e){r[a]=u.createBindingInfos(e[a],t)}return r}var n=u.extractBindingInfo(e,t);return u.escapeParametersAndDataSources(n||e)};u.formattedProperty=function(e,r){var a={};if(Array.isArray(e)){a.parts=e.map(function(e){return typeof e==="object"?t({},e):{value:e}});a.formatter=r}else if(typeof e==="object"){a=t({},e);if(e.formatter){var n=a.formatter;a.formatter=function(){var e=n.apply(this,arguments);return r(e)}}else{a.formatter=r}}else{a=r(e)}return a};u.escapeCardPlaceholders=function(e){if(typeof e!=="string"){return e}return e.replace(i,"\\{\\{$1\\}\\}")};u.escapeParametersAndDataSources=function(e){if(typeof e!=="string"){return e}return e.replace(o,"\\{\\{$1\\}\\}").replace(f,"\\{\\{$1\\}\\}")};u.isAbsolutePath=function(e){return e.startsWith("/")};u.prependRelativePaths=function(e,r){if(typeof e!=="object"){return e}var a=t({},e);if(a.path&&!this.isAbsolutePath(a.path)){a.path=r+"/"+a.path}if(a.parts){a.parts=a.parts.map(function(e){return u.prependRelativePaths(e,r)})}return a};u.copyModels=function(e,t,r){var a=r||u.DEFAULT_CARD_MODELS,n=e.getModel();if(n){t.setModel(n)}a.forEach(function(r){var a=e.getModel(r);if(a){t.setModel(a,r)}})};u.reuse=function(e){if(typeof e==="object"){return t({},e)}return e};return u});