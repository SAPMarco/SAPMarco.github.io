/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/BindingParser","sap/base/util/extend","sap/ui/integration/formatters/DateTimeFormatter","sap/ui/integration/formatters/NumberFormatter","sap/ui/integration/formatters/TextFormatter","sap/ui/integration/bindingFeatures/DateRange"],function(e,t,r,a,n,i){"use strict";var o=/\{\{([^}]+)\}\}/g,s=/\{\{(parameters\.[^}]+)\}\}/g,u=/\{\{(dataSources\.[^}]+)\}\}/g;var f={};var c={date:r.date,dateTime:r.dateTime,currency:a.currency,float:a.float,integer:a.integer,percent:a.percent,text:n.text,unit:a.unit};f.mLocals={format:c,dateRange:i};f.extractBindingInfo=function(r,a){r=f.escapeCardPlaceholders(r);return e.complexParser(r,undefined,true,undefined,undefined,undefined,t({},f.mLocals,a))};f.createBindingInfos=function(e,t){if(!e){return e}if(Array.isArray(e)){return e.map(function(e){return f.createBindingInfos(e,t)})}if(typeof e==="object"){var r={};for(var a in e){r[a]=f.createBindingInfos(e[a],t)}return r}var n=f.extractBindingInfo(e,t);return f.escapeParametersAndDataSources(n||e)};f.formattedProperty=function(e,r){var a={};if(Array.isArray(e)){a.parts=e.map(function(e){return typeof e==="object"?t({},e):{value:e}});a.formatter=r}else if(typeof e==="object"){a=t({},e);if(e.formatter){var n=a.formatter;a.formatter=function(){var e=n.apply(this,arguments);return r(e)}}else{a.formatter=r}}else{a=r(e)}return a};f.escapeCardPlaceholders=function(e){if(typeof e!=="string"){return e}return e.replace(o,"\\{\\{$1\\}\\}")};f.escapeParametersAndDataSources=function(e){if(typeof e!=="string"){return e}return e.replace(s,"\\{\\{$1\\}\\}").replace(u,"\\{\\{$1\\}\\}")};f.isAbsolutePath=function(e){return e.startsWith("/")};f.prependRelativePaths=function(e,r){if(typeof e!=="object"){return e}var a=t({},e);if(a.path&&!this.isAbsolutePath(a.path)){a.path=r+"/"+a.path}if(a.parts){a.parts=a.parts.map(function(e){return f.prependRelativePaths(e,r)})}return a};f.propagateModels=function(e,r){var a=t({},e.oPropagatedProperties.oModels,e.oModels),n=Object.keys(a),i=e.getModel();if(i){r.setModel(i)}n.forEach(function(t){if(t==="undefined"){return}var a=e.getModel(t);if(a){r.setModel(a,t)}})};f.reuse=function(e){if(typeof e==="object"){return t({},e)}return e};return f});